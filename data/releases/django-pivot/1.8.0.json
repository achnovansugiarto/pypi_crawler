{
  "info": {
    "author": "Brad Martsberger",
    "author_email": "bmarts@lumere.com",
    "bugtrack_url": null,
    "classifiers": [
      "Programming Language :: Python :: 2",
      "Programming Language :: Python :: 2.7",
      "Programming Language :: Python :: 3",
      "Programming Language :: Python :: 3.5",
      "Programming Language :: Python :: 3.6",
      "Programming Language :: Python :: 3.7"
    ],
    "description": ".. image:: https://travis-ci.org/martsberger/django-pivot.svg?branch=master\n    :target: https://travis-ci.org/martsberger/django-pivot\n\nDjango Pivot-Tables\n===================\n\nThis package provides utilities for turning Django Querysets into\n`Pivot-Tables <https://en.wikipedia.org/wiki/Pivot_table>`_ and Histograms\nby letting your database do all the heavy lifting.\n\nExamples\n--------\n\nI am going to shamelessly lift examples from the wikipedia page referenced in the header.\nHere is part of the table of shirt sales:\n\n======  ======  ====== ========== ====== ====== ======\nRegion  Gender  Style  Ship Date   Units  Price  Cost\n======  ======  ====== ========== ====== ====== ======\nEast    Boy     Tee     1/31/2005     12  11.04  10.42\nEast    Boy     Golf    1/31/2005     12     13   12.6\nEast    Boy     Fancy   1/31/2005     12  11.96  11.74\nEast    Girl    Tee     1/31/2005     10  11.27  10.56\nEast    Girl    Golf    1/31/2005     10  12.12  11.95\nEast    Girl    Fancy   1/31/2005     10  13.74  13.33\nWest    Boy     Tee     1/31/2005     11  11.44  10.94\nWest    Boy     Golf    1/31/2005     11  12.63  11.73\nWest    Boy     Fancy   1/31/2005     11  12.06  11.51\nWest    Girl    Tee     1/31/2005     15  13.42  13.29\nWest    Girl    Golf    1/31/2005     15  11.48  10.67\nEtc.\n======  ======  ====== ========== ====== ====== ======\n\nWe might want to know how many *Units* did we sell in each *Region* for every *Ship Date*?\nAnd get a result like:\n\n======== ========= ========= ========= ========= =========\nRegion   1/31/2005 2/1/2005  2/2/2005  2/3/2005  2/4/2005\n======== ========= ========= ========= ========= =========\nEast            66        80       102        93       114\nNorth           86        91        95        88       107\nSouth           73        78        84        76        91\nWest            92       103       111       104       123\n======== ========= ========= ========= ========= =========\n\nIt takes 3 quantities to pivot the original table into the summary result, two columns and\nan aggregate of a third column. In this case the two columns are Region and Ship Date, the\nthird column is Units and the aggregate is Sum\n\n\nBasic usage\n-----------\n\n*The pivot function*\n\nPivot tables are generated by the pivot function, which takes a Model and 3 attribute names,\nto make a pivot table like the example above:\n\n>>> pivot_table = pivot(ShirtSales, 'shipped', 'region', 'units')\n\nThe result is a ValuesQuerySet, which means the objects returned are dictionaries. Each\ndictionary has a key for the row ('shipped' dates in this case) and a key for every value\nof the column ('region' in this case).\n\n>>> for record in pivot_table:\n...     print(record)\n... {u'West': 59, 'shipped': datetime.date(2004, 12, 24), u'East': 71, u'North': 115, u'South': 56}\n... {u'West': 55, 'shipped': datetime.date(2005, 1, 31), u'East': 65, u'North': 121, u'South': 66}\n... {u'West': 56, 'shipped': datetime.date(2005, 2, 1), u'East': 62, u'North': 124, u'South': 68}\n... {u'West': 56, 'shipped': datetime.date(2005, 2, 2), u'East': 59, u'North': 127, u'South': 71}\n... {u'West': 66, 'shipped': datetime.date(2005, 3, 1), u'East': 55, u'North': 131, u'South': 65}\n... {u'West': 68, 'shipped': datetime.date(2005, 3, 2), u'East': 56, u'North': 130, u'South': 62}\n... {u'West': 71, 'shipped': datetime.date(2005, 4, 3), u'East': 56, u'North': 130, u'South': 59}\n... {u'West': 65, 'shipped': datetime.date(2005, 5, 6), u'East': 66, u'North': 120, u'South': 55}\n\nThe first argument can be a Model, QuerySet, or Manager. This allows you to generate a pivot\ntable filtered by another column. For example, you may want to know how many units were sold\nin each region for every shipped date, but only for Golf shirts:\n\n>>> pivot_table = pivot(ShirtSales.objects.filter(style='Golf'), 'region', 'shipped', 'units')\n\nThe pivot function takes an optional parameter for how to aggregate the data. For example,\ninstead of the total units sold in each region for every ship date, we might be interested in\nthe average number of units per order. Then we can pass the Avg aggregation function\n\n>>> from django.db.models import Avg\n>>> pivot_table = pivot(ShirtSales, 'region', 'shipped', 'units', aggregation=Avg)\n\nIf your data is stored across multiple tables, use Django's double underscore notation\nto traverse foreign key relationships. For example, instead of the ShirtSales model having\na *region* attribute, it might have a foreign key to a Store model, which in turn has a\nforeign key to a Region model, which has an attribute called name. Then our pivot call looks\nlike\n\n>>> pivot_table = pivot(ShirtSales, 'store__region__name', 'shipped', 'units')\n\nIt's also possible that the data column we are aggregating over should be a computed column.\nIn our example ShirtSales model we are storing the number of units and the price per\nunit, but not the total cost of the order. If we want to know the average order size in\ndollars in each region for every ship date, we can pivot the ShirtSales table:\n\n>>> from django.db.models import F, Avg\n>>> pivot_table = pivot(ShirtSales, 'region', 'shipped', F('units') * F('price'), Avg)\n\nIf the rows should be grouped on a compound column, for example, you want to know how many\n*Units* were sold on each ship date not just split by region, but the combination of region\nand gender, you can pass a list to the first argument:\n\n>>> pivot_table = pivot(ShirtSales, ['region', 'gender'], 'shipped', 'units')\n\nTo change the way the row keys are displayed, a display_transform function can be passed to\nthe pivot function. display_transform is a function that takes a string and returns a string.\nFor example, instead of getting the results with North, East, South, and West for the regions\nyou want them all lower cased, you can do the following\n\n>>> def lowercase(s):\n>>>     return s.lower()\n>>> pivot_table = pivot(ShirtSales, 'region', 'shipped', 'units', display_transform=lowercase)\n\nIf there are no records in the original data table for a particular cell in the pivot result,\nSQL will return NULL and this gets translated to None in python. If you want to get zero, or\nsome other default, you can pass that as a parameter to pivot:\n\n>>> pivot_table = pivot(ShirtSales, 'region', 'shipped', 'units', default=0)\n\nThe above call ensures that when there are no units sold in a particular region on a particular\ndate, we get zero as the result instead of None. However, the results will only contain\nshipped dates if at least one region had sales on that date. If it's necessary to get results\nfor all dates in a range including dates where there are no ShirtSales records, we can pass\na target row_range:\n\n>>> from datetime import date, timedelta\n>>> row_range = [date(2005, 1, 1) + timedelta(days) for days in range(59)]\n>>> pivot_table = pivot(ShirtSales, 'region', 'shipped', 'units', default=0, row_range=row_range)\n\nWill output a result with every shipped date from Jan 1st to February 28th whether there are\nsales on those days or not.\n\n*The histogram function*\n\nThis library also supports creating histograms from a single column of data with the\nhistogram function, which takes a Model, a single attribute name and an iterable of left edges\nof bins.\n\n>>> hist = histogram(ShirtSales, 'units', bins=[0, 10, 15])\n\nLike *pivot*, the first argument can be a Model, QuerySet, or Manager. The result is a\nlist of dictionaries:\n\n>>> hist\n[{'bin': '0', 'units': 0},\n{'bin': '10', 'units': 0},\n{'bin': '15', 'units': 0}]\n\nIt's also possible to get several histograms from a single query by slicing the data on one\nof the columns. For example, instead of the histogram above, we might want two histograms,\none for boys and one for girls. The ``gender`` column of ``ShirtSales`` has two values,\n``'Boy'`` and ``'Girl'``. Passing the gender column as a 4th optional parameter to histogram\nwill slice the data on that column.\n\n>>> hist = histogram(ShirtSales, 'units', bins=[0, 10, 15], slice_on='gender')\n\nThe result is a ValuesQuerySet where each row corresponds to one bin\n\n>>> for row in hist:\n        print(row)\n{'bin': u'0', u'Boy': 53, u'Girl': 53}\n{'bin': u'10', u'Boy': 40, u'Girl': 41}\n{'bin': u'15', u'Boy': 27, u'Girl': 26}\n\n\nInstallation\n------------\n\nJust::\n\n    pip install django-pivot\n\nput django_pivot in installed apps in your settings file, and then you::\n\n    from django_pivot.pivot import pivot\n    from django_pivot.histogram import histogram\n\nAnd off you go.\n\n\nTests\n-----\n\nThe test suite is run by `Travis <https://travis-ci.org/martsberger/django-pivot>`_\nwith Django versions 1.10 and 1.11 and backends sqlite, MySQL, and Postgres. If you\nwant to run the test suite locally, from the root directory::\n\n    python runtests.py --settings=django_pivot.tests.test_sqlite_settings\n\nThat will use sqlite as the backend and whatever version of Django you have\nin your current environment.\n\nLicense\n-------\n\nMIT\n\nCopyright 2017 Brad Martsberger\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nContributors\n------------\n\n`rafal-jaworski <https://github.com/rafal-jaworski>`_\n\n\n",
    "description_content_type": "",
    "docs_url": null,
    "download_url": "https://github.com/martsberger/django-pivot/archive/1.8.0.tar.gz",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/martsberger/django-pivot",
    "keywords": "",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "django-pivot",
    "package_url": "https://pypi.org/project/django-pivot/",
    "platform": "",
    "project_url": "https://pypi.org/project/django-pivot/",
    "project_urls": {
      "Download": "https://github.com/martsberger/django-pivot/archive/1.8.0.tar.gz",
      "Homepage": "https://github.com/martsberger/django-pivot"
    },
    "release_url": "https://pypi.org/project/django-pivot/1.8.0/",
    "requires_dist": [
      "django (>=1.10)",
      "six"
    ],
    "requires_python": "",
    "summary": "Create pivot tables and histograms from ORM querysets",
    "version": "1.8.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 12861819,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "892f9d8b03a506b5af1d83c91c5e97870078ed92eea96a7369dc3a7621d8ee31",
        "md5": "ae99efa36a1162a3f2528e766ea65639",
        "sha256": "cec08e7d7436b08cdcc9ff54248c324b95a3b2bbaea4dea66293278a7db36eaa"
      },
      "downloads": -1,
      "filename": "django_pivot-1.8.0-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "ae99efa36a1162a3f2528e766ea65639",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": null,
      "size": 14128,
      "upload_time": "2019-03-23T17:41:21",
      "upload_time_iso_8601": "2019-03-23T17:41:21.584224Z",
      "url": "https://files.pythonhosted.org/packages/89/2f/9d8b03a506b5af1d83c91c5e97870078ed92eea96a7369dc3a7621d8ee31/django_pivot-1.8.0-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "51a9cbb9ba44d2a18a151cde53bed984091aa7b61f676f959ac3bb6c9a97f1fa",
        "md5": "d6e0a25325aaf28b49dfdecd3877c153",
        "sha256": "3c0da232d01d6f9b91690832ee5259cdd7f47f464ae54d84c80adef17d623df3"
      },
      "downloads": -1,
      "filename": "django-pivot-1.8.0.tar.gz",
      "has_sig": false,
      "md5_digest": "d6e0a25325aaf28b49dfdecd3877c153",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 13894,
      "upload_time": "2019-03-23T17:41:22",
      "upload_time_iso_8601": "2019-03-23T17:41:22.985052Z",
      "url": "https://files.pythonhosted.org/packages/51/a9/cbb9ba44d2a18a151cde53bed984091aa7b61f676f959ac3bb6c9a97f1fa/django-pivot-1.8.0.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}