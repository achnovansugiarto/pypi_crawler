{
  "info": {
    "author": "Dieter Maurer",
    "author_email": "dieter@handshake.de",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 4 - Beta",
      "Framework :: Zope2",
      "Intended Audience :: Developers",
      "License :: OSI Approved :: GNU General Public License (GPL)",
      "Operating System :: OS Independent",
      "Programming Language :: Python",
      "Topic :: Utilities"
    ],
    "description": "This package supports SAML2 based SSO (Single Sign-On) for Zope2/Plone\ninstallations.\n\nWhile it currently supports only a small subset of the\nSAML2 standard (simple identity provider, simple service provider\nintegration and attribute support),\nits current functionality is comparable to Plone's OpenId support.\n\n\n\n============\nArchitecture\n============\n\n\nIn the SAML2 architecture, a set of distributed authorities (aka entities)\ncooperate to provide an overall service. Each authority can take over\none or more roles. Roles are for example \"identity provider\" (can\nidentify users), \"service provider\" (provides some service) and\n\"attribute provider\" (can provide information about users).\nAuthorities and their roles are described by metadata. The metadata\nis exchanged between authorities to allow them to cooperate. SAML2\nmessages are exchanged to implement the SSO (and other) functionality.\n\nThe package currently provides an SAML2 authority,\na simple identity provider, a simple\nservice provider integration and a simple attribute provider.\nAll functions are implemented via objects created via the Zope management\ninterface (ZMI).\n\n\nAuthority\n=========\n\nThe SAML authority object represents the local SAML authority and\nmanages the metadata about the foreign authorities cooperating with it.\nIts ``metadata`` method (callable via url) returns the metadata\ndescribing the local authority. Foreign authorities are\nmanaged as so called `Entity` objects; their metadata are automatically\nupdated (based on validity attributes in the metadata), manual update\nis supported for special cases.\n\nThe objects implementing SAML2 roles\naccess \"their\" authority as a (Zope toolkit)\n\"utility\". To make this possible, an SAML authority can only be\ncreated below a (Zope toolkit) site (see the package\n``five.localsitemanager`` to learn about sites and how to create one).\n(CMF or Plone) portals are sites (in this sense) automatically.\nThus, in a simple setup, you can create an authority object in\na portal (without special actions concerning sites).\n\nThere can be at most one SAML authority in a given site.\nNested sites, however, may have their own authority or use that\nof a parent site.\n\n\nIdentity Provider\n=================\n\nIn general, an identity provider has the task to identify users and\nto provide assertions about user identities to service providers.\n\nThe provided simple identity provider delegates\nthe first task (identifying users) to a host CMF or Plone portal.\nThereby, it uses the standard portal functionality for login and\nauthentication; it does not make any assumption about the way\nthe portal manages its users (and their attributes) and the\ndetails of the authentication process.\nThus, almost any portal can be made into an SAML2 identity provider\nby just creating an \"Saml simple identity provider\" in the portal.\n\nOn creation, the identity provider\nregisters automatically as \"identity provider\" role\nwith an SAML authority utility. Creation fails, if this utility either\ncannot be located or already knows about an identity provider.\n\nThere is a variant identity provider which integrates elemantary\nattribute provider functionality (see section \"Attribute Support\").\n\n\nService Provider\n================\n\nIn general, an SAML2 service provider\nprovides some kind of (web) service to users and uses SAML2 to get information\nabout the identities, attributes or access rights for some of its users.\nThe service provided itself has nothing to do with SAML2; it can be\nalmost anything (using web technologies).\nOnly a small part has to do with SAML2: getting information about\nusers identified and managed externally by other SAML2 authorities.\n\nThe simple service provider functionality in this\npackage  allows either a single portal\nor a family of portals sharing a common service provider description\nto get authentication information from\nan SAML2 identity provider.\nIt interfaces with the portal[s] via the miniframework \n\"pluggable authentication service\", used by (e.g.) Plone portals.\n\nIn the simple case, the (real) service is implemented by a single portal which\nshould get authentication information from one or more SAML2\nidentity providers. This use case is\nsupported by the creation of an \"Saml integrated simple spsso plugin\"\nin the portal's ``acl_users`` and the activation of its interfaces.\n\nIf the SAML2 based authentication replaces the local one, plugins\nresponsible for local authentication may need to be removed or their\ninterfaces deactivated. Some integration work is necessary, when local\nauthentication should coexist with SAML2 based authentication (essentially,\nthe login form (for local authentication) must be combined with the\nidentity provider selection (for external authentication)).\n\nIn the more complex case, the (real) service is not provided by a single\nportal but by a whole family of portals (usually providing the same service\nor slightly customized variants of the same service to different user groups)\nsharing a common service description with respect to SAML2.\nIn this case, there is a shared Saml service provider\nand each portal has an ``Saml simple spsso plugin (external spsso)``\nwhich work with the shared service provider. In this case, service provider\nand plugin communicate via cookies. Therefore, they must get the same cookies.\n\nIn fact, the simple case is a variant of the complex one where\nservice provider and plugin are implemented by the same object.\n\nWhen a service provider object is created (either standalone or\nintegrated with the plugin), it registers as \"service provider\" role\nwith an SAML authority utility. Creation fails, if this utility\neither cannot be located or already knows about a service provider.\n\nThe servide provider integration can exhibit user attributes from the\nSAML2 assertions as user properties in the portal (user properties\nare a standard feature of Plone portals -- to provide addtional\ninformation such as name, email address, ... for a user).\n\n\nAttribute Support\n=================\n\nGeneral SAML2 Attribute Support\n-------------------------------\n\nThis section sketches the general principles of SAML2 attribute\nsupport. The next section outlines the support provided by this\npackage.\n\nThe SAML2 assertions about a user can include almost arbitrary attributes\nto provide additional information (beyond the identity).\nAttributes can for example be used to inform a cooperating\nSAML authority about the name, the email address, group\nmembership or special priviledges of a user.\n\nSAML2 attributes are identified by a name format and a (formal, often\nunwieldy) name. Optionally, they can have a so called \"FriendlyName\"\nwhich should be human readable.\n\nSAML2 allows a service provider to define zero or\nmore \"AttributeConsumingService\"s. Each \"AttributeConsumingService\"\nis identified by an index (an integer) and contains a sequence\nof descriptions for \"RequestedAttribute\"s.\nWhen the service provider requests authentication for a user, it\ncan specify for which of its \"AttributeConsumingService\"s it wants\nattribute information.\n\nAn SAML2 attribute provider is able to provide attributes for users.\nMetadata tells which attributes can be provided.\n\n\nAttribute Support in this Package\n---------------------------------\n\nThis package describes attributes by objects, managed in\n\"Folder\"s and identified by (locally unique)\nids. The ids are used as \"FriendlyName\" in the\nSAML metadata and as user property name.\nThe attribute's SAML2 name format and (formal) name are specified by\nattributes of the attribute (describing) object.\n\nAttribute values can be instances of an XML-Schema elementary type\nor lists/sequences\nthereof (however, Plone may not understand some of those types).\n\nThe service provider object is implemented as a \"Folder\" of\n\"AttributeConsumingService\"s, each \"AttributConsumingService\"\nas a \"Folder\" of \"RequestedAttribute\"s. Thus, a service provider\ncan define various sets of interesting attributes. However, the\nstandard authentication request requests only the default set.\nWhile there is an authentication method which supports the\nspecification of the wanted \"AttributeConsumingService\", it is\nlikely that this in not yet handled correctly in this version.\n\nThe service provider plugin exposes the SAML2 attributes for\na user as standard (for Plone) user properties; the id of\nthe attribute description is used as user property name.\n\nThe current package version\ndoes not have a standalone attribute provider. However, there is\nan identity provider variant which has some integrated attribute provider\nfunctionality. It provides attribute information only as part\nof authentication requests.\nIt is implemented as a \"Folder\" of \"Attribute\"s which describe\nthe supported attributes and how their value can be computed.\nBy default, the id of the attribute description is interpreted\nas user property name and its value (for the current user)\nused as value for the attribute. Alternatively, the attribute definition\ncan specify an \"Evaluator\" -- the name of a method or view called\nwith parameters *member*, *attr* and *eid* to determine the attribute\nvalue. *member* is the current portal member, *attr* the attribute description\nand *eid* the entity identifier who should get the information.\n\n\n============\nDependencies\n============\n\nThe package depends on ``Zope2``. It was tested\nboth with Zope 2.10 and Zope 2.13 (therefore, it is expected to\nwork with the intermediate versions as well). For Zope versions from\n2.12 onward, you must ensure that ``five.formlib`` is installed (as\nZope 2.12 dropped ``zope.formlib`` support from the core; it was\nmoved into a the separate package ``five.formlib``).\n\nNote that one of the dependencies (``pyxb`` in version 1.1.4) has \nproblems to get installed via package managers with Python versions before\n2.6. This makes some problems with Zope 2.10 and 2.11. Consult\nthe dependecies section of ``dm.saml2`` to learn how you can work\naround this problem.\n\n\n============\nInstallation\n============\n\nYou must install the code for the package and\nensure that the package's ZCML definitions are interpreted on\nZope startup. In addition, you must ensure that on Zope startup,\nthe ``xmlsec`` library is initialized\n(by calling ``dm.xmlsec.binding.initialize()``).\n\nIn order to learn details about ``xmlsec`` signing/verification\nfailures, you might want to use ``dm.xmlsec.binding.set_error_callback``\nto let those details be logged (for details, consult\nthe ``dm.xmlsec.binding`` documentation).\n\nIn the case that you are using ``zc.buildout`` for your Zope2 installation,\nthen the installation steps can be summarized as follows:\n\n  *  extend the ``eggs`` definition in your ``buildout.cfg``\n     by ``dm.zope.saml2`` and (in case you are using Zope2 >= 2.12)\n     by ``five.formlib``.\n\n  *  extend the ``zcml`` definition in your ``buildout.cfg``\n     by ``dm.zope.saml2``.\n\n  *  ensure ``dm.xmlsec.binding.initialize()`` gets called\n     on Zope startup.\n\nThe default ``zope.formlib`` support for ``Password`` fields\nis very bad (it carefully hides the password on edits\nbut displays it in clear text on views; it forces\nyou to reenter the password anew whenever you save the form).\nTo get decent handling of ``Password`` fields, you may\nwant to activate the ZCML overrides of package ``dm.zope.schema``.\nIf you are using ``zc.buildout``. you can achieve this\nby extending the ``zcml`` definition in your ``buildout.cfg``\nby ``dm.zope.schema-overrides``.\n\nSAML2 stives hard for security. Therefore, it is virtually\nimpossible to use SAML2 in an identify provider\nwithout digital signatures. The\ndigital signatures are used to prevent tempering with SAML2 messages\nand to authenticate the cooperationg SAML2 authorities.\nTo effectively use SAML2 for an identity provider, you will need a certificate\nand an associated private key such that the authentication assertions\ncan be properly signed. A certificate can be obtained from a\nstandard CA (certificate authority); certificates used for HTTPS servers\nare usable. Alternatively, it may be possible (this depends\non the SAML2 partners, you want to cooperate with) to generate\nyour own certificate. \"http://www.imacat.idv.tw/tech/sslcerts.html\"\ndescribes how you can do this on a Unix-like platform.\nPrivate key and certificate are specified when you create an\nSAML authority. For service providers (in contrast to identity providers)\na certificate may not be necessary (this depends on the identity providers\nyou want to cooperate with; if they (all) accept unsigned authentication\nrequests, a private key/certificate pair is not necessary).\n\nIn case, the interaction between SAML entities poses problems,\nthe logging facility of ``dm.zope.saml2`` can be helpful.\nLogging is enabled by setting the envvar ``SAML2_ENABLE_LOGGING``\nto a non empty value. It causes all incoming and outgoing SAML\nmessages to be logged on level ``INFO``.\n\n\n=============\nCustomization\n=============\n\nThe package supports several levels of customizations:\nbasic customizations via the ZMI through configuration menues,\ncustomization by registration of adapters\nand integrating your own class implementations, possibly derived\nfrom base classes defined in this package.\n\nWhen you create objects described in the architecture section,\nyou are sent to a configuration menue to enter the\nrelevant configuration parameters. Those menues should be self\nexplanatory.\n\nVia the registration of appropriate adapters, you can\ncurrently control the supported nameid formats,\nthe storage used by the ``RelayStateManager``\nand the generation of urls for role objects.\nThe relevant adapter interfaces are defined in\n``dm.zope.saml2.interfaces``.\n\nThe built in nameid format support supports only the ``unspecified``\nformat. Via the registration of an ``INameidFormatSupport`` role\nadapter, you can control which nameid formats the adapted role\nshould support.\n\nBy default, the ``RelayManagerState`` (used to remember state\nduring the login process) is stored inside the ZODB in\na role attribute. By defining an ``IRelayStateStore``\nrole adapter you can provide a different store. Note that\nthis adaptation takes effect only during the creation of the role.\nShould you plan to switch storage at a later time, you must\ncall ``Sso.__init__`` on the role again.\nNote that aborted login processes leave state records behind.\nTo get rid of them, consider to call the role's ``clear`` method\nfrom time to time (maybe once in a month).\n\nThe generation of the role urls used in the metadata is a bit\ncomplex. The first reason is of a technical nature: the generation\nmay be activated in a context where the request object cannot be\naccessed in the normal Zope way (i.e. via acquisition);\ntherefore, the normal methods to determine an url do not work\n(reliably). The second reason comes from the fact that a Zope\ninstallation can often be accessed via different urls (e.g.\nan internal one and one via a virtual host and that the metadata is\ncached; the cached urls in the metadata must ensure they are valid\nfor all cases and therefore must not depend on the specific request\nurl that accidentally lead to their creation. To work around\nthis complexity, the default behavior is to generate the role\nurls from a base url (specified as authority configuration attribute)\nand the path to the respective role. This usually generates\nvalid urls but they are often longer than necessary and may reveal details\nof the internal structure of your Zope installation (the full path\nto the role objects) which you might want to hide.\nFor those cases, you can register an authority ``IUrlCustomizer`` adapter\nand there determine the role urls you would like.\n\nFor all cases for which the provided customization possibilities\nare not sufficient, you can define your own classes and\ninstantiate them in place of the standard ones.\n\n\n================\nInteroperability\n================\n\nI have developed this package as part of a (paid) project -\nby factoring out into this open source package\nthe parts which might be useful to others. However, I did\nnot invest much effort towards things not relevant to my project.\nEspecially, I have not performed extensive interoperability tests.\n\nThe package works for my project and it should work with\n``SimpleSAMLphp`` (http://simplesamlphp.org/) which I used\nas functional blueprint. Should I detect interoperability problems\nin future projects of mine, I will investigate and fix them.\n\nWhen you use this package in your own projects, you might\nhit interoperability problems. In those cases, you will need\nto investigate (and potentially fix them) or use another\nSAML integration. You may send me your fixes and I will consider\nwhether to incorporate them in future versions.\n\n\n\n==============\nKnown Problems\n==============\n\n\nExport/Import Problems\n======================\n\nThe package uses several Zope objects for its configuration.\nThose are not standalone but have quite a complex relationship\namong them. For example,\nidentity provider objects and service provider objects depend on\nan authority (accessed as a (local) utility) and register with it.\nThe authority must generate metadata for its roles (e.g. identity\nprovider and/or service provider) and therefore requires references\nto the corresponding configuration objects.\n\nZope's standard (ZODB based) export/import functionality operates on\na single object base. It has problems to handle object sets with\ninterdependencies (such as the SAML configuration object set).\n\nIt is known that SAML authority objects raise an exception when\nyou try to import them. There are hints that imported identity and\nservice provider objects fail to properly register themselves with\nthe autority.\n\nI do not know whether you can correctly import the whole\nconfiguration structure as part of a common container object.\nThere are hints that you must at least include in the import\nthe local component registry where the SAML authority has registered with.\n\n\nText handling\n=============\n\nA modern system should represent text internally as unicode\nand convert from/to encoded strings only at system boundaries.\nFor historical (and likely backward compatibility) reasons, Plone\ndoes not (yet) work this way: typically, while it stores unicode it\nconverts to/from encoded strings at the storage boundary; most parts\nof Plone, and especially member properties, handle encoded strings, not\nunicode. SAML2, in contrast, is a unicode based technology. This,\nunfortunately, requires a bridge between the SAML2 and the Plone world.\nTo implement the bridge, knowledge is required about the charset used by\nPlone to convert between Unicode and encoded bytes.\n\nPlone before version 5 used to make this charset configurable via a\nproperty; `Products.PlonePAS.utils` defined a function `getCharset` to\nreturn this configuration option and `dm.zope.saml2` before\nversion 4 used it to implement the bridge mentioned above.\nPlone 5, at least the dexterity part, has fixed the charset to \"utf-8\",\nthe `getCharset` function is gone.\n\nTo obtain a `dm.zope.saml2` version capable to work both with Plone 5 and\nformer Plone versions, it implements (from version 4 on)\nits own `getCharset` function\n(in its `util` module). By default, it returns \"utf-8\" as charset --\na value appropriate for most Plone setups and especially\nlikely all modern Plone setups. Should your setup use a different charset,\nyour must register a `dm.zope.saml2.util.ICharset` adapter for the\nportal root returning the charset used for the portal.\n\n\n=======\nHistory\n=======\n\n4.0\n\n  Plone 5 compatibility. ATT: may introduce a backward incompatibility\n  in the case that your portal does not use \"utf-8\" as charset.\n  See the section \"Text handling\" above.\n\n  The explicit login request now allows a \"caller\" to determine\n  where to redirect to after a successful login by defining\n  the request variable `came_from`.\n\n3.1b1\n\n  Allow to specify a type for a requested attribute. This can be\n  necessary as some identity providers (e.g. some from Microsoft)\n  do not provide type information in ``AttributeValue`` elements\n  (but rely on type information exchange in a different way).\n\n3.0b1\n\n  Switch to non-naive ``datetime`` values in the UTC time zone\n  (rather than naive UTC ``datetime`` values) - in the hope\n  that this improves interoperability.\n  \n  As a consequence, generated SAML time values use a ``Z`` suffix,\n  which appears to contradict section 1.3.3 of the SAML2 specification\n  but which is compatible with many SAML2 implementations (e.g. Amazon AWS).\n  Apparently, ``ADFS`` insists on this format.\n\n2.0b3 - 2.0b8\n\n  Various fixes and improvements based on experience\n  by Dylan Jay\n\n2.0b2\n\n  Improves control over name identifier formats\n  and the creation of name identifiers.\n\n  Adds titles to entities in order to provide a more friendly\n  identity provider list.\n\n  Ignores signatures in metadata to avoid a chicken-and-egg problem\n  (but this, of course, reduces security).\n\n  Supports authentication request signing (if the identity provider\n  requires this).\n\n2.0\n\n  Version 2.0 uses ``dm.xmlsec.binding`` as Python binding to the XML\n  security library, rather then the no longer maintained ``pyxmlsec``.\n  This drastically facilitates installation.\n\n1.0\n\n  Initial release based on ``pyxmlsec``.",
    "description_content_type": "",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "http://pypi.python.org/pypi/dm.zope.saml2",
    "keywords": "application development zope saml2 sso plone",
    "license": "ZPL",
    "maintainer": "",
    "maintainer_email": "",
    "name": "dm.zope.saml2",
    "package_url": "https://pypi.org/project/dm.zope.saml2/",
    "platform": "",
    "project_url": "https://pypi.org/project/dm.zope.saml2/",
    "project_urls": {
      "Homepage": "http://pypi.python.org/pypi/dm.zope.saml2"
    },
    "release_url": "https://pypi.org/project/dm.zope.saml2/4.0.2/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "Zope 2/Plone extension for SAML2 based Single Sign On: identity, attribute and service providers",
    "version": "4.0.2",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 6738530,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "f64530749c2d552d7c8128bf43dae92f395cf313e9d7f345eb932f8cab2a8df7",
        "md5": "999f41b74222d9832d2ee72f7188ce98",
        "sha256": "b0ff78af7ad138e6d5218f6105ec64447d0df6497f74974f64faaf3038d8a774"
      },
      "downloads": -1,
      "filename": "dm.zope.saml2-4.0.2.tar.gz",
      "has_sig": false,
      "md5_digest": "999f41b74222d9832d2ee72f7188ce98",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 56826,
      "upload_time": "2018-05-09T06:48:06",
      "upload_time_iso_8601": "2018-05-09T06:48:06.492797Z",
      "url": "https://files.pythonhosted.org/packages/f6/45/30749c2d552d7c8128bf43dae92f395cf313e9d7f345eb932f8cab2a8df7/dm.zope.saml2-4.0.2.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}