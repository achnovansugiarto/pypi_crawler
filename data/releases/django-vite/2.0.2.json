{
  "info": {
    "author": "MrBin99",
    "author_email": "",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "# Django Vite\n\nIntegration of [ViteJS](https://vitejs.dev/) in a Django project.\n\n## Installation\n\n### Django\n\n```\npip install django-vite\n```\n\nAdd `django_vite` to your `INSTALLED_APPS` in your `settings.py`\n(before your apps that are using it).\n\n```python\nINSTALLED_APPS = [\n    ...\n    'django_vite',\n    ...\n]\n```\n\n### ViteJS\n\nFollow instructions on [https://vitejs.dev/guide/](https://vitejs.dev/guide/).\nAnd mostly the SSR part.\n\nThen in your ViteJS config file :\n\n- Set the `base` options the same as your `STATIC_URL` Django setting.\n- Set the `build.outDir` path to where you want the assets to compiled.\n- Set the `build.manifest` options to `true`.\n- As you are in SSR and not in SPA, you don't have an `index.html` that\n  ViteJS can use to determine which files to compile. You need to tell it\n  directly. In your ViteJS config file add the following :\n\n```javascript\nexport default defineConfig({\n  build {\n    ...\n    rollupOptions: {\n      input: {\n        <unique key>: '<path to your asset>'\n      }\n    }\n  }\n}\n```\n\n### Assets\n\nAs recommended on Vite's [backend integration guide](https://vitejs.dev/guide/backend-integration.html), your assets should include the modulepreload polyfill.\n\n```javascript\n// Add this at the beginning of your app entry.\nimport 'vite/modulepreload-polyfill';\n```\n\n## Usage\n\n### Configuration\n\n- Define a setting variable in your `settings.py` named `DJANGO_VITE_ASSETS_PATH`\n  containing the absolute path to where your assets are built.\n\n  - This must correspond to your `build.outDir` in your ViteJS configuration.\n  - The `DJANGO_VITE_ASSETS_PATH` must be included in your `STATICFILES_DIRS`\n    Django setting.\n\n- Define a setting variable in your `settings.py` named `DJANGO_VITE_DEV_MODE`\n  containing a boolean defining if you want to include assets in development\n  mode or production mode.\n\n  - In development mode, assets are included as modules using the ViteJS\n    webserver. This will enable HMR for your assets.\n  - In production mode, assets are included as standard assets\n    (no ViteJS webserver and HMR) like default Django static files.\n    This means that your assets must be compiled with ViteJS before.\n  - This setting may be set as the same value as your `DEBUG` setting in\n    Django. But you can do what is good for your needs.\n\nNote : `DJANGO_VITE_ASSETS_PATH` supports `pathlib.Path` syntax or pure `str`.\n\n### Template tags\n\nInclude this in your base HTML template file.\n\n```\n{% load django_vite %}\n```\n\nThen in your `<head>` element add this :\n\n```\n{% vite_hmr_client %}\n```\n\n- This will add a `<script>` tag to include the ViteJS HMR client.\n- This tag will include this script only if `DJANGO_VITE_DEV_MODE` is true,\n  otherwise this will do nothing.\n\nThen add this tag to load your scripts :\n\n```\n{% vite_asset '<path to your asset>' %}\n```\n\nThis will add a `<script>` tag including your JS/TS script :\n\n- In development mode, all scripts are included as modules.\n- In development mode, all scripts are marked as `async` and `defer`.\n- You can pass a second argument to this tag to overrides attributes\n  passed to the script tag.\n- This tag only accept JS/TS, for other type of assets, they must be\n  included in the script itself using `import` statements.\n- In production mode, the library will read the `manifest.json` file\n  generated by ViteJS and import all CSS files dependent of this script\n  (before importing the script).\n- You can add as many of this tag as you want, for each input you specify\n  in your ViteJS configuration file.\n- The path must be relative to your `root` key inside your ViteJS config file.\n- The path must be a key inside your manifest file `manifest.json` file\n  generated by ViteJS.\n- In general, this path does not require a `/` at the beginning\n  (follow your `manifest.json` file).\n\n```\n{% vite_asset_url '<path to your asset>' %}\n```\n\nThis will generate only the URL to an asset with no tag surrounding it.\n**Warning, this does not generate URLs for dependant assets of this one\nlike the previous tag.**\n\n### Custom attributes\n\nBy default, all scripts tags are generated with a `type=\"module\"` and `crossorigin=\"\"` attributes just like ViteJS do by default if you are building a single-page app.\nYou can override this behavior by adding or overriding this attributes like so :\n\n```\n{% vite_asset '<path to your asset>' foo=\"bar\" hello=\"world\" %}\n```\n\nThis line will add `foo=\"bar\"` and `hello=\"world\"` attributes.\n\nYou can also use context variables to fill attributes values :\n\n```\n{% vite_asset '<path to your asset>' foo=request.GET.bar %}\n```\n\nIf you want to overrides default attributes just add them like new attributes :\n\n```\n{% vite_asset '<path to your asset>' crossorigin=\"anonymous\" %}\n```\n\nAlthough it's recommended to keep the default `type=\"module\"` attribute as ViteJS build scripts as ES6 modules.\n\n## Vite Legacy Plugin\n\nIf you want to consider legacy browsers that don't support ES6 modules loading\nyou may use [@vitejs/plugin-legacy](https://github.com/vitejs/vite/tree/main/packages/plugin-legacy).\nDjango Vite supports this plugin. You must add stuff in complement of other script imports in the `<head>` tag.\n\nJust before your `<body>` closing tag add this :\n\n```\n{% vite_legacy_polyfills %}\n```\n\nThis tag will do nothing in development, but in production it will loads the polyfills\ngenerated by ViteJS.\n\nAnd so next to this tag you need to add another import to all the scripts you have\nin the head but the 'legacy' version generated by ViteJS like so :\n\n```\n{% vite_legacy_asset '<path to your asset>' %}\n```\n\nLike the previous tag, this will do nothing in development but in production,\nDjango Vite will add a script tag with a `nomodule` attribute for legacy browsers.\nThe path to your asset must contain de pattern `-legacy` in the file name (ex : `main-legacy.js`).\n\nThis tag accepts overriding and adding custom attributes like the default `vite_asset` tag.\n\n## Miscellaneous configuration\n\nYou can redefine those variables in your `settings.py` :\n\n- `DJANGO_VITE_DEV_SERVER_PROTOCOL` : ViteJS webserver protocol\n  (default : `http`).\n- `DJANGO_VITE_DEV_SERVER_HOST` : ViteJS webserver hostname\n  (default : `localhost`).\n- `DJANGO_VITE_DEV_SERVER_PORT` : ViteJS webserver port\n  (default : `3000`)\n- `DJANGO_VITE_WS_CLIENT_URL` : ViteJS webserver path to the HMR client used\n  in the `vite_hmr_client` tag (default : `@vite/client`).\n- `DJANGO_VITE_MANIFEST_PATH` : Absolute path (including filename)\n  to your ViteJS manifest file. This file is generated in your\n  `DJANGO_VITE_ASSETS_PATH`. But if you are in production (`DEBUG` is false)\n  then it is in your `STATIC_ROOT` after you collected your\n  [static files](https://docs.djangoproject.com/en/3.1/howto/static-files/) (supports `pathlib.Path` or `str`).\n- `DJANGO_VITE_LEGACY_POLYFILLS_MOTIF` : The motif used to find the assets for polyfills inside the `manifest.json` (only if you use [@vitejs/plugin-legacy](https://github.com/vitejs/vite/tree/main/packages/plugin-legacy)).\n- `DJANGO_VITE_STATIC_URL_PREFIX` : prefix directory of your static files built by Vite.\n  (default : `\"\"`)\n\n  - Use it if you want to avoid conflicts with other static files in your project.\n  - It may be used with `STATICFILES_DIRS`.\n  - You also need to add this prefix inside vite config's `base`.\n    e.g.:\n\n  ```python\n  # settings.py\n  DJANGO_VITE_STATIC_URL_PREFIX = 'bundler'\n  STATICFILES_DIRS = (('bundler', '/srv/app/bundler/dist'),)\n  ```\n\n  ```javascript\n  // vite.config.js\n  export default defineConfig({\n    base: '/static/bundler/',\n    ...\n  })\n  ```\n\n## Notes\n\n- In production mode, all generated path are prefixed with the `STATIC_URL`\n  setting of Django.\n\n- If you are serving your static files with whitenoise, by default your files compiled by vite will not be considered immutable and a bad cache-control will be set. To fix this you will need to set a custom test like so:\n\n```python\nimport re\n\n# Vite generates files with 8 hash digits\n# http://whitenoise.evans.io/en/stable/django.html#WHITENOISE_IMMUTABLE_FILE_TEST\n\ndef immutable_file_test(path, url):\n    # Match filename with 12 hex digits before the extension\n    # e.g. app.db8f2edc0c8a.js\n    return re.match(r\"^.+\\.[0-9a-f]{8,12}\\..+$\", url)\n\n\nWHITENOISE_IMMUTABLE_FILE_TEST = immutable_file_test\n```\n\n## Example\n\nIf you are struggling on how to setup a project using Django / ViteJS and Django Vite,\nI've made an [example project here](https://github.com/MrBin99/django-vite-example).\n\n## Thanks\n\nThanks to [Evan You](https://github.com/yyx990803) for the ViteJS library.\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/MrBin99/django-vite",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "django-vite",
    "package_url": "https://pypi.org/project/django-vite/",
    "platform": null,
    "project_url": "https://pypi.org/project/django-vite/",
    "project_urls": {
      "Homepage": "https://github.com/MrBin99/django-vite"
    },
    "release_url": "https://pypi.org/project/django-vite/2.0.2/",
    "requires_dist": [
      "Django (>=1.11)",
      "black ; extra == 'dev'",
      "flake8 ; extra == 'dev'"
    ],
    "requires_python": "",
    "summary": "Integration of ViteJS in a Django project.",
    "version": "2.0.2",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 13186149,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "9fa8b869a8a42fdc38419c55395bf2a5e23f8fc22bcb4f5a6f3b648db988872d",
        "md5": "0545cf8f88565b3f9e26e077e70c522f",
        "sha256": "f11f4747183b884ee4e6c2ea12f0aa96a846574ee7344c05ac96b4fa89309535"
      },
      "downloads": -1,
      "filename": "django_vite-2.0.2-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "0545cf8f88565b3f9e26e077e70c522f",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": null,
      "size": 12135,
      "upload_time": "2022-03-15T20:07:08",
      "upload_time_iso_8601": "2022-03-15T20:07:08.922067Z",
      "url": "https://files.pythonhosted.org/packages/9f/a8/b869a8a42fdc38419c55395bf2a5e23f8fc22bcb4f5a6f3b648db988872d/django_vite-2.0.2-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "63d561d2601ce9a63b0ec54cf9f3d68d69b35c5a0da6fa383bffafb8476885e6",
        "md5": "086a4040282d9ad674b7417084c94934",
        "sha256": "5a2e11a9f08a2a0a69c9a7c637a3254ad0c8dd01e07cb40de09a3a180ed99791"
      },
      "downloads": -1,
      "filename": "django-vite-2.0.2.tar.gz",
      "has_sig": false,
      "md5_digest": "086a4040282d9ad674b7417084c94934",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 14421,
      "upload_time": "2022-03-15T20:07:11",
      "upload_time_iso_8601": "2022-03-15T20:07:11.077766Z",
      "url": "https://files.pythonhosted.org/packages/63/d5/61d2601ce9a63b0ec54cf9f3d68d69b35c5a0da6fa383bffafb8476885e6/django-vite-2.0.2.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}