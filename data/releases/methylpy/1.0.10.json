{
  "info": {
    "author": "Yupeng He",
    "author_email": "yupeng.he.bioinfo@gmail.com",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "methylpy\n========\n\nWelcome to the home page of methylpy, a pyhton-based analysis pipeline\nfor\n\n-  (single-cell) (whole-genome) bisulfite sequencing data\n-  (single-cell) NOMe-seq data\n-  differential methylation analysis\n\nmethylpy is available at\n`github <https://github.com/yupenghe/methylpy>`__ and\n`PyPI <https://pypi.python.org/pypi/methylpy/>`__.\n\nNote\n====\n\n-  methylpy was initiated by and built on the work of `Mattew D.\n   Schultz <https://github.com/schultzmattd>`__\n-  `tutorial <https://github.com/yupenghe/methylpy/blob/methylpy/tutorial.md>`__\n   is being written\n-  In new version, allc files for one sample are no longer split and the\n   current allc format does not support header. Command\n   ``cat allc_SAMPLENAME_*.tsv |grep chr -v > allc_SAMPLENAME.tsv`` can\n   be used to change the older version of allc to the new version.\n-  Current version methylpy has major difference compared to previous\n   version. Please checkout this document and\n   `tutorial <https://github.com/yupenghe/methylpy/blob/methylpy/tutorial.md>`__\n   for details.\n\nWhat can methylpy do?\n=====================\n\nProcessing bisulfite sequencing data and NOMe-seq data\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n-  fast and flexible pipeline for both single-end and paired-end data\n-  all the way from raw reads (fastq) to methylation state and/or open\n   chromatin readouts\n-  also support getting readouts from alignment (BAM file)\n-  including options for read trimming, quality filter and PCR duplicate\n   removal\n-  accept compressed input and generate compressed output\n-  support post-bisulfite adaptor tagging (PBAT) data\n\nCalling differentially methylated regions (DMRs)\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n-  DMR calling at single cytosine level\n-  support comparison across 2 or more samples/groups\n-  conservative and accurate\n-  useful feature for dealing with low-coverage data by combining data\n   of adjacent cytosines\n\nWhat you want to do\n===================\n\n-  `Install methylpy <#install-methylpy>`__\n-  `Test methylpy <#test-methylpy>`__\n-  `Process data <#process-data>`__\n-  `Call DMRs <#call-dmrs>`__\n-  `Additional functions for data\n   processing <#additional-functions-for-data-processing>`__\n-  `Cite methylpy <#cite-methylpy>`__\n\nrun ``methylpy -h`` to get a list of functions.\n\nInstall methylpy\n================\n\nStep 1 - Download methylpy\n^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nEasiest way of installing methylpy will be through PyPI by running\n``pip install methylpy``. The command ``pip install --upgrade methylpy``\nupdates methylpy to latest version. Alternatively, methylpy can be\ninstalled through github: enter the directory where you would like to\ninstall methylpy and run\n\n::\n\n    git clone https://github.com/yupenghe/methylpy.git\n    cd methylpy/\n    python setup.py install\n\nIf you would like to install methylpy in path of your choice, run\n``python setup.py install --prefix=/USER/PATH/``. Then, try ``methylpy``\nand if it gives no error, the setup is likely successful. See `Test\nmethylpy <#test-methylpy>`__ for more rigorious test. Last, processing\nlarge dataset will require space for storing temporary files. However,\nthe default directory is unlikely to fit the need. You may want to set\nthe ``TMPDIR`` environmental variable to the absolute path of a\ndirectory on hard drive with sufficient space (e.g. ``/YOUR/TMP/DIR/``).\nThis can be done by adding the below command to ~/.bashrc file:\n``export TMPDIR=/YOUR/TMP/DIR/``.\n\nStep 2 - Install dependencies\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nmethylpy is written in python so obviously python2/3 needs to be\ninstalled. methylpy also depends on two python modules,\n`numpy <http://www.numpy.org/>`__ and\n`scipy <https://www.scipy.org/>`__. The easiest way to resolve these\ndependencies is to install\n`anaconda <https://www.anaconda.com/download/>`__\n\nIn addition, some features of methylpy depend on several publicly\navailable tools (not all of them are required if you only use a subset\nof methylpy functions). \\*\n`cutadapt <http://cutadapt.readthedocs.io/en/stable/installation.html>`__\n(>=1.9) for raw read trimming \\*\n`bowtie <http://bowtie-bio.sourceforge.net/index.shtml>`__ and/or\n`bowtie2 <http://bowtie-bio.sourceforge.net/bowtie2/index.shtml>`__ for\nalignment \\* `samtools <https://github.com/samtools/samtools>`__ (>=1.3)\nfor alignment results manipulation \\*\n`Picard <https://broadinstitute.github.io/picard/index.html>`__\n(>=2.10.8) for removal of PCR duplicates \\* java (its path included in\n``PATH`` environment variable) for running Picard \\*\n`wigToBigWig <http://hgdownload.soe.ucsc.edu/admin/exe/linux.x86_64/wigToBigWig>`__\nfor converting methylpy output to bigwig format\n\nLastly, if paths to cutadapt, bowtie/bowtie2, samtools and wigToBigWig\nare included in ``PATH`` variable, methylpy can run these tools\ndirectly. Otherwise, the paths have to be passed to methylpy as\naugments. Path to Picard needs to be passed to methylpy as a parameter\nto run PCR duplicate removal.\n\nOptional step - Compile rms.cpp\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nDMR finding requires an executable\n``methylpy/methylpy/run_rms_tests.out``, which was compiled from C++\ncode ``methylpy/methylpy/rms.cpp``. In most cases, the precompiled file\ncan be used directly. To test this, simply run execute\n``methylpy/methylpy/run_rms_tests.out``. If help page shows, recompiling\nis not required. If error turns up, the executable needs to be\nregenerated by compiling ``rms.cpp`` and this step requires\n`GSL <https://www.gnu.org/software/gsl/>`__ installed correctly. In most\nlinux operating system, the below commands will do the job\n\n::\n\n    cd methylpy/methylpy/\n    g++ -O3 -l gsl -l gslcblas -o run_rms_tests.out rms.cpp\n\nIn Ubuntu (>=16.04), please try the below commands first.\n\n::\n\n    cd methylpy/methylpy/\n    g++ -o run_rms_tests.out rms.cpp `gsl-config --cflags â€”libs`\n\nTest methylpy\n=============\n\nTo test whether methylpy and the dependencies are installed and set up\ncorrectly, run\n\n::\n\n    cd methylpy/test\n    python run_test.py\n\nProcess data\n============\n\nPlease see `methylpy\ntutorial <https://github.com/yupenghe/methylpy/blob/methylpy/tutorial.md>`__\nfor more details.\n\nStep 1 - Build converted genome reference\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nBuild bowtie/bowtie2 index for converted genome. Run\n``methylpy build-reference -h`` to get more information. An example of\nbuilding mm10 mouse reference index:\n\n::\n\n    methylpy build-reference \\\n        --input-files mm10_bt2/mm10.fa \\\n        --output-prefix mm10_bt2/mm10 \\\n        --bowtie2 True\n\nStep 2 - Process bisulfite sequencing and NOMe-seq data\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nFunction ``single-end-pipeline`` is For processing single-end data. Run\n``methylpy single-end-pipeline -h`` to get help information. Below code\nis an example of using methylpy to process single-end bisulfite\nsequencing data. For processing NOMe-seq data, please use\n``num_upstr_bases=1`` to include one base upstream cytosine as part of\ncytosine sequence context, which can be used to tease out GC sites.\n\n::\n\n    methylpy single-end-pipeline \\\n        --read-files raw/mESC_R1.fastq.gz \\\n        --sample mESC \\\n        --forward-ref mm10_bt2/mm10_f \\\n        --reverse-ref mm10_bt2/mm10_r \\\n        --ref-fasta mm10_bt2/mm10.fa \\\n        --num-procs 8 \\\n        --remove-clonal True \\\n        --path-to-picard=\"picard/\"\n\nAn command example for processing paired-end data. Run\n``methylpy paired-end-pipeline -h`` to get more information.\n\n::\n\n    methylpy paired-end-pipeline \\\n        --read1-files raw/mESC_R1.fastq.gz \\\n        --read2-files raw/mESC_R2.fastq.gz \\\n        --sample mESC \\\n        --forward-ref mm10_bt2/mm10_f \\\n        --reverse-ref mm10_bt2/mm10_r \\\n        --ref-fasta mm10_bt2/mm10.fa \\\n        --num-procs 8 \\\n        --remove-clonal True \\\n        --path-to-picard=\"picard/\"\n\nOutput format\n^^^^^^^^^^^^^\n\nOutput file(s) are (compressed) tab-separated text file(s) in allc\nformat. \"allc\" stands for all cytosine (C). Each row in an allc file\ncorresponds to one cytosine in the genome. An allc file contain 7\ncolumns and no header:\n\n+---------+--------------------+------------+-----------------------------------------+\n| index   | column name        | example    | note                                    |\n+=========+====================+============+=========================================+\n| 1       | chromosome         | 12         | with no \"chr\"                           |\n+---------+--------------------+------------+-----------------------------------------+\n| 2       | position           | 18283342   | 1-based                                 |\n+---------+--------------------+------------+-----------------------------------------+\n| 3       | strand             | +          | either + or -                           |\n+---------+--------------------+------------+-----------------------------------------+\n| 4       | sequence context   | CGT        | can be more than 3 bases                |\n+---------+--------------------+------------+-----------------------------------------+\n| 5       | mc                 | 18         | count of reads supporting methylation   |\n+---------+--------------------+------------+-----------------------------------------+\n| 6       | cov                | 21         | read coverage                           |\n+---------+--------------------+------------+-----------------------------------------+\n| 7       | methylated         | 1          | indicator of significant methylation    |\n+---------+--------------------+------------+-----------------------------------------+\n\nCall DMRs\n=========\n\nThis function will take a list of compressed/uncompressed allc files\n(output files from methylpy pipeline) as input and look for DMRs. Help\ninformation of this function is available via running\n``methylpy DMRfind -h``.\n\nBelow is the code of an example of calling DMRs for CG methylation\nbetween two samples, ``AD_HT`` and ``AD_IT`` on chromosome 1 through 5\nusing 8 processors.\n\n::\n\n    methylpy DMRfind \\\n        --allc-files allc/allc_AD_HT.tsv.gz allc/allc_AD_IT.tsv.gz \\\n        --samples AD_HT AD_IT \\\n        --mc-type \"CGN\" \\\n        --chroms 1 2 3 4 5 \\\n        --num-procs 8 \\\n        --output-prefix DMR_HT_IT\n\nPlease see `methylpy\ntutorial <https://github.com/yupenghe/methylpy/blob/methylpy/tutorial.md>`__\nfor details.\n\nAdditional functions for data processing\n========================================\n\nExtract cytosine methylation state from BAM file\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nThe ``call-methylation-state`` function allows users to get cytosine\nmethylation state (allc file) from alignment file (BAM file). It is part\nof the data processing pipeline which is especially useful for getting\nthe allc file from alignment file from other methylation data pipelines\nlike bismark. Run ``methylpy call-methylation-state -h`` to get help\ninformation. Below is an example of running this function. Please make\nsure to remove ``--paired-end True`` or use ``--paired-end False`` for\nBAM file from single-end data.\n\n::\n\n    methylpy call-methylation-state \\\n        --input-file mESC_processed_reads_no_clonal.bam \\\n        --paired-end True \\\n        --sample mESC \\\n        --ref-fasta mm10_bt2/mm10.fa \\\n        --num-procs 8\n\nGet methylation level for genomic regions\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nCalculating methylation level of certain genomic regions can give an\nestimate of the methylation abundance of these loci. This can be\nachieved using the ``add-methylation-level`` function. See\n``methylpy add-methylation-level -h`` for more details about the input\nformat and available options.\n\n::\n\n    methylpy add-methylation-level \\\n        --input-tsv-file DMR_AD_IT.tsv \\\n        --output-file DMR_AD_IT_with_level.tsv \\\n        --allc-files allc/allc_AD_HT_1.tsv.gz allc/allc_AD_HT_2.tsv.gz \\\n            allc/allc_AD_IT_1.tsv.gz allc/allc_AD_IT_2.tsv.gz \\\n        --samples AD_HT_1 AD_HT_2 AD_IT_1 AD_IT_2 \\\n        --mc-type CGN \\\n        --num-procs 4\n\nMerge allc files (of replicates)\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nThe ``merge-allc`` function can merge multiple allc files into a single\nallc file. It is useful when separate allc files are generated for\nreplicates of a tissue or cell type, and one wants to get a single allc\nfile for that tissue/cell type. See ``methylpy merge-allc -h`` for more\ninformation.\n\n::\n\n    methylpy merge-allc \\\n        --allc-files allc/allc_AD_HT_1.tsv.gz allc/allc_AD_HT_2.tsv.gz \\\n        --output-file allc/allc_AD_HT.tsv.gz \\\n        --compress-output True\n\nConvert allc file to bigwig format\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nThe ``allc-to-bigwig`` function generates bigwig file from allc file.\nMethylation level will be calculated in equally divided non-overlapping\ngenomic bins and the output will be stored in a bigwig file. See\n``methylpy allc-to-bigwig -h`` for more information.\n\n::\n\n    methylpy allc-to-bigwig \\\n        --input-allc-file results/allc_mESC.tsv.gz \\\n        --output-file results/allc_mESC.bw \\\n        --ref-fasta mm10_bt2/mm10.fa \\\n        --mc-type CGN \\\n        --bin-size 100  \n\nQuality filter for bisulfite sequencing reads\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nSometimes, we want to filter out reads that cannot be mapped confidently\nor are likely from under-converted DNA fragments. This can be done using\nthe ``bam-quality-filter`` function. See\n``methylpy bam-quality-filter -h`` for parameter inforamtion.\n\nFor example, below command can be used to filter out reads with less\nthan 30 MAPQ score (poor alignment) and with mCH level greater than 0.7\n(under-conversion) if the reads contain enough (at least 3) CH sites.\n\n::\n\n    methylpy bam-quality-filter \\\n        --input-file mESC_processed_reads_no_clonal.bam \\\n        --output-file mESC_processed_reads_no_clonal.filtered.bam \\\n        --ref-fasta mm10_bt2/mm10.fa \\\n        --quality-cutoff 30 \\\n        --min-num-ch 3 \\\n        --max-mch-level 0.7 \\\n        --buffer-line-number 100\n\nReidentify DMRs from existing result\n^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nmethylpy is able to reidentify-DMR based on the result of previous\nDMRfind run. This function is especially useful in picking out DMRs\nacross a subset of categories and/or with different filters. See\n``methylpy reidentify-DMR -h`` for details about the options.\n\n::\n\n    methylpy reidentify-DMR \\\n        --input-rms-file results/DMR_P0_FBvsHT_rms_results.tsv.gz \\\n        --output-file results/DMR_P0_FBvsHT_rms_results_recollapsed.tsv \\\n        --collapse-samples P0_FB_1 P0_FB_2 P0_HT_1 P0_HT_2 \\\n        --sample-category P0_FB P0_FB P0_HT P0_HT \\\n        --min-cluster 2\n\nCite methylpy\n=============\n\nIf you use methylpy, please cite >Matthew D. Schultz, Yupeng He, John\nW.Whitaker, Manoj Hariharan, Eran A. Mukamel, Danny Leung, Nisha\nRajagopal, Joseph R. Nery, Mark A. Urich, Huaming Chen, Shin Lin, Yiing\nLin, Bing Ren, Terrence J. Sejnowski, Wei Wang, Joseph R. Ecker. Human\nBody Epigenome Maps Reveal Noncanonical DNA Methylation Variation.\nNature. 523(7559):212-216, 2015 Jul.",
    "description_content_type": null,
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "http://pypi.python.org/pypi/methylpy/",
    "keywords": "Bioinformatics pipeline,DNA methylation,Bisulfite sequencing data,Nome-seq data,Differential methylation,Calling DMRs,Epigenetics,Functional genomics",
    "license": "LICENSE.txt",
    "maintainer": "",
    "maintainer_email": "",
    "name": "methylpy",
    "package_url": "https://pypi.org/project/methylpy/",
    "platform": "",
    "project_url": "https://pypi.org/project/methylpy/",
    "project_urls": {
      "Homepage": "http://pypi.python.org/pypi/methylpy/"
    },
    "release_url": "https://pypi.org/project/methylpy/1.0.10/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "Bisulfite sequencing data processing and differential methylation analysis",
    "version": "1.0.10",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 8279527,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "d3522376b81bd94abd1a8b21b5590e897b729dfb58f9895544c3f3147edd7c74",
        "md5": "2f39471fe60c2e232aec4df554af4d30",
        "sha256": "fcad4d2ba969cf21dad2744606774f1281c35b5f5e28e33547d4e31b3db2d8d5"
      },
      "downloads": -1,
      "filename": "methylpy-1.0.10.tar.gz",
      "has_sig": false,
      "md5_digest": "2f39471fe60c2e232aec4df554af4d30",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 96154,
      "upload_time": "2017-11-09T22:06:14",
      "upload_time_iso_8601": "2017-11-09T22:06:14.974044Z",
      "url": "https://files.pythonhosted.org/packages/d3/52/2376b81bd94abd1a8b21b5590e897b729dfb58f9895544c3f3147edd7c74/methylpy-1.0.10.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}