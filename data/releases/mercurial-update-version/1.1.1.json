{
  "info": {
    "author": "Marcin Kasperski",
    "author_email": "Marcin.Kasperski@mekk.waw.pl",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 4 - Beta",
      "Environment :: Console",
      "Intended Audience :: Developers",
      "License :: DFSG approved",
      "License :: OSI Approved :: BSD License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 2",
      "Programming Language :: Python :: 3",
      "Topic :: Software Development :: Libraries",
      "Topic :: Software Development :: Libraries :: Python Modules",
      "Topic :: Software Development :: Version Control"
    ],
    "description": ".. -*- mode: rst; compile-command: \"rst2html README.rst README.html\" -*-\n\n=========================\nMercurial Update Version\n=========================\n\nNo more manual version number editing.\n\nWhenever you issue ``hg tag``, this extension scans your repository\nfor files containing various kinds of ``VERSION =`` lines, updates\nthose constants appropriately, commits the change, and only then tags\nthe release.\n\nFunctionality can be enabled per-repository or (via ``~/.hgrc``) for\nmany repositories at once (so you don't need to remember about\nactivating it on every created, or cloned repository).\n\n.. contents::\n   :local:\n   :depth: 2\n\n.. sectnum::\n\nEnabling the extension\n==========================\n\nInstall the extension as described below. Then either enable it\nper-repository, or enable for many repositories at once.\n\nEnabling per-repository\n---------------------------\n\nIn repository ``.hg/hgrc`` write::\n\n    [update_version]\n    active = true\n    language = python\n    tagfmt = dotted\n\n(of course using appropriate settings). Here:\n\n- ``language`` implies version constants syntax, and sometimes\n  restricts list of files scanned,\n\n- ``tagfmt`` describes expected tag syntax (and how to extract\n  actual version number from the tag).\n\nFor example, ``language = python`` means looking for ``setup.py``,\n``__init__.py`` and ``version.py`` files anywhere inside the\nrepository, and updating lines looking like ``VERSION = \"1.2.3\"``,\nwhile ``tagfmt = dotted`` means simple dotted numbers are used as\ntags (``hg tag 1.0.9``).\n\nBoth languages and tag formats are configurable, extension brings\nsome sane defaults but they can be overridden, and new styles\ncan be defined. See below.\n\nIt is also possible to enable more than one language. For example,\nto update numbers in both python, and javascript files, \none can write in ``.hg/hgrc``::\n\n    [update_version]\n    py.active = true\n    py.language = python\n    py.tagfmt = dotted\n    js.active = true\n    js.language = javascript\n    js.tagfmt = dotted\n\nName prefixes (``py`` and ``js`` in the sample above) are used only\nto group the settings and are not important (use any name you like).\nThe ``tagfmt`` setting should usually be the same in all entries.\n\n\nEnabling for many repositories at once\n------------------------------------------------------\n\nIn ``~/.hgrc`` write something like::\n\n    [update_version]\n    pydev.active_on = ~/sources/pymodules, ~/work/python \n    pydev.language = python\n    pydev.tagfmt = dotted\n    myperl.active_on = ~/scripts, ~/work/scripts \n    myperl.language = perl\n    myperl.tagfmt = dashed\n    excvs.active_on = ~/legacy\n    excvs.expand_keywords = 1\n\nName prefixes (``pydev`` and ``myperl``) are used only to group\nthree settings together (use any names you like).\n\nIn both cases:\n\n- ``.active_on`` lists directory trees to which given rule can be applied\n  (absolute paths, ``~`` and ``~user`` are allowed), \n\n- ``.language`` and ``.tagfmt`` define which language settings and which tag\n  format to use for those directories.\n\n- ``.expand_keywords`` enables CVS keyword expansion (replacement of ``$Name$`` and similar constructs). Note that it works differently than keyword extension, replacements are commited (so will always be present in the checked out code).\n\nIn case multiple directives match the same repo, all are processed, for example with::\n\n    [update_version]\n    pydev.active_on = ~/sources\n    pydev.language = python\n    pydev.tagfmt = dotted\n    jsdev.active_on = ~/sources\n    jsdev.language = javascript\n    jsdev.tagfmt = dotted\n\nin repo ``~/sources/myweb`` both python, and javascript files, will be processed.\n\nEnabling for use in TortoiseHg\n----------------------------------------------------\n\nThe setup above is not sufficient for tags created from TortoiseHg GUI\n(via ``thg tag`` or tagging dialog of main TortoiseHg window). To get\nthose working, you must manually enable the update version hook. Add\nto your ``~/.hgrc``::\n\n   [hooks]\n   pre-tag.update_version = python:mercurial_update_version.pre_tag_hook\n  \nPlease, use exactly that name and value (it will be used by extension\nto detect that you enabled the hook, so it need not be enabled again\nunder bare Mercurial).\n\nThe rest of the configuration remains the same.\n\n.. note::\n\n   Technical details: ``mercurial_update_version`` usually enables\n   that hook by itself. Unfortunately under TortoiseHg dynamic hook\n   activation does not work (THG has it's own command processing chain\n   different from Mercurial core, and hook list is effectively frozen\n   before extensions are able to impact it).\n\n\nUsing\n============================================\n\nAfter enabling the extension:\n\n- ensure your code have some initial version variables\n  (put sth. like ``VERSION = \"0.0.0\"`` in appropriate place(s))\n\n- simply ``hg tag «appropriate-tag»``.\n\nand your version constants will be updated, the change commited, and\nonly the resulting changeset tagged.\n\nVersion numbers are not updated when tag is placed by revision (``hg\ntag -r «version-no» «tag»``), unless specified revision matches\ncurrently checked out revision.\n\nTags not matching the expected pattern are ignored, just like local\ntags (rarely used Mercurial feature).\n\nThe extension notifies you whether and what it does, for example::\n\n  $ hg tag 2.0\n  update_version: Version number in src/version.py set to 2.0. List of changes:\n      Line 2\n      < VERSION = \"1.0\"\n      > VERSION = \"2.0\"\n\nor::\n\n  $ hg tag -r 2 0.5.0\n  update_version: ignoring tag placed -r revision (tag is placed, but version number not updated)\n\nPredefined languages\n=============================================\n\nThe ``language`` setting defines:\n\n- which files to check and patch (by filename patterns)\n\n- what is the appropriate constant format and name\n\nThe following languages are currently supported:\n\nPython (``language=python``)\n----------------------------\n\nLook for files named ``setup.py``, ``__init__.py`` or\n``version.py`` (anywhere inside repository). In those files,\nupdate lines looking like::\n\n    VERSION = '1.2.3'\n\n(at least one dot - but can be more, both single and double-quotes\nare supported, just like various spacing and indentation).\n\nInserted version number is formatted in the same way (as\ndot-separated list of numbers).  Tag being placed should contain\nat least two-part version number to be used.\n\nPerl (``language=perl``)\n-------------------------\n\nLook for files named ``*.pl``, ``*.pm`` and ``*.pod`` around\nrepository. If found, look for lines like::\n\n    our $VERSION = '1.00';\n    my $VERSION = '11.72';\n    use constant VERSION => '21.3374';\n\n(exactly one dot expected, various spacing and indentation\nallowed, double quotes allowed) and also::\n\n    Version 1.23\n\n(usually met in POD sections).\n\nAlso, look for ``dist.ini`` and if found, fix lines like::\n\n    version = 0.02\n\nTwo kinds of tags numbers are supported. If tag contains two-item\nversion, it is left as is (tag ``1.0`` results in version ``1.0``,\ndashed tag ``1-03`` brings ``1.03``). If tag has three parts,\nfirst is left before the dot while second and third each get two\ndigits after the dot (tag ``1.7.2`` is translated into version\n``1.0702``, tag ``17-0-9`` into ``17.0009``). Other tags are\ninvalid.\n\nJavaScript (``language=javascript``)\n-------------------------------------\n\nLook for files named ``version.js``, ``version.jsx``, ``*_version.js``\nand ``*_version.jsx``. In any of those, look for lines like::\n\n     var VERSION = \"1.2.3\";\n     const VERSION = \"1.2.3\";\n     let VERSION = \"1.2.3\";\n\n(final semicolons being optional).\n\nAlso look for ``package.json`` file(s) and if found, update line like::\n\n    \"version\": \"1.0.0\",\n\n(with or without semicolon, and with or without indentation). Note: this\nis currently expected to be the sole item on the line, without other\nkeys.\n\nJSON (``language=json``)\n-------------------------------------\n\nCheck files named ``*.json`` for lines like::\n\n    \"version\": \"1.0.0\",\n\n(with or without semicolon, with or without indentation, with single or double quotes,\nwithout other keys on the same line).\n\nContrary to most other languages, there are additional restrictions:\n\n- checking is limited to first 30 lines of the file,\n\n- only one (first) line of such form is modified.\n\n\n\nLogstash (``language=logstash``)\n---------------------------------------\n\nCheck files named ``*version*.conf`` (``conf`` extension and word\n``version`` anywhere inside basename) for lines like::\n\n    add_field => { \"[version]\" => \"1.0.2\" }\n\nor mayhaps::\n\n    add_field => { \"[some][prefix][version]\" => \"1.0.2\" }\n\n(last - or only - part of the key must be ``[version]``, whitespace can be flexible\nbut whole line as such must be constructed as above).\n\nI recommend using file like ``01-version.conf`` (named so it is\nprocessed early), with content like::\n\n    filter {\n        mutate {\n            add_field => { \"[@metadata][myapp][version]\" => \"1.0.2\" }\n        }\n    }\n\nand then referring to this field (copying it, using inside formatted\nstrings) wherever needed in filters and outputs.\n\n\nC++ (``language=c++``)\n--------------------------\n\nLook for files named ``version.hxx``, ``version.cxx``,\n``version.hpp``, ``version.cpp``. Look for and update lines like::\n\n      const string VERSION = \"1.2.3\";\n      const char* VERSION = \"1.2.3\";\n      const char VERSION[] = \"1.2.3\";\n      string VERSION = \"1.2.3\";\n\n*Support for further languages is planned, feel free to suggest them.*\n\nPredefined tag formats\n=============================\n\nThe following tag formats are supported.\n\nDot-separated numbers (``tagfmt=dotted``)\n-----------------------------------------------\n\nTags like ``1.0``, ``1.0.3``, ``11.17.34``.\n\nDash-separated numbers (``tagfmt=dashed``)\n-----------------------------------------------\n\nTags like ``1-0``, ``1-0-3``, ``11-17-34``.\n\nDotted with text prefix (``tagfmt=pfx-dotted``)\n-------------------------------------------------\n\nTags like ``mylib-1.0`` or ``sth_11.3.17``:\nalphanumeric string, dash or underscore,\nthen actual version as in ``dotted``.\n\nDashed with text prefix (``tagfmt=pfx-dashed``)\n-------------------------------------------------\n\nTags like ``mylib-1-0`` or ``sth_11-3-17``:\nalphanumeric string, dash or underscore,\nthen actual version as in ``dashed``. leading\npart must not end with digit.\n\nKeyword expansion\n=======================\n\nSetting ``expand_keywords=1`` enables CVS keyword expansion.  Source\nwill be scanned for CVS keywords like ``$Name$`` (or ``$Name: mytag_0.7.0 $``), ``$Revision$``, etc, and those will be appropriately updated. This change will be commited, making those changes permanent\n(until they are replaced by newer tag). \n\nThis is an alternative to standard keyword extension, which updates\nthose keywords on update (and causes various problems with merges,\nedits, extension configuration, etc). With ``update_version``\napproach, proper keyword values will be simply commited just before\ntagging, so they will always be present in the checkout.\n\nNote that the replacement is somewhat simplistic: the main purpose is\nto get proper ``$Name$``, everything else (``$Revision$``, ``$Header$``\netc) gets populated with the data of last pre-tag changeset (calculating\ntrue date or revision of last change per each file is possible, but would\nbe fairly costly).\n\nExample configuration (``~/.hgrc``)::\n\n   [update_version]\n   cvsconverts.active_on = ~/devel/legacy ~/devel/libs\n   cvsconverts.expand_keywords = 1\n\nCustom languages\n=============================\n\nNot yet supported, but planned (defining new language by configuration\nsettings, or overriding some default language characteristics). The\ngeneral idea is to have some reasonable defaults built-in, but allow\nreconfiguration.\n\n\nCustom tag formats\n=============================\n\nNot yet supported, but planned (defining new tag format by\nconfiguration settings).\n\n\nCommands\n=====================\n\n``hg tag``\n-----------\n\nExtension mainly work by augmenting ``hg tag``, as described\nabove.\n\n\n``hg tag_version_test``\n------------------------\n\nThis is *dry run* check. The command::\n\n    hg tag_version_test 1.0\n\nlists which files would be checked, whether version lines were found\nin them, and how would they be changed, but does not change anything.\n\n\nInstallation\n==================\n\nLinux/Unix (from PyPI)\n---------------------------------------------\n\nIf you have working ``pip`` or ``easy_install``::\n\n    pip install --user mercurial_update_version\n\nor maybe::\n\n    sudo pip install mercurial_update_version\n\n(or use ``easy_install`` instead of ``pip``). Then activate by::\n\n    [extensions]\n    mercurial_update_version =\n\nTo upgrade, repeat the same command with ``--upgrade`` option, for\nexample::\n\n    pip install --user --upgrade mercurial_update_version\n\nLinux/Unix (from source)\n---------------------------------------------\n\nIf you don't have ``pip``, or wish to follow development more closely:\n\n- clone both this repository and `mercurial_extension_utils`_ and put\n  them in the same directory, for example::\n\n    cd ~/sources\n    hg clone https://foss.heptapod.net/mercurial/mercurial-extension_utils/\n    hg clone https://foss.heptapod.net/mercurial/mercurial-update_version/\n\n- update to newest tags,\n\n- activate by::\n\n    [extensions]\n    mercurial_update_version = ~/sources/mercurial-update_version/mercurial_update_version.py\n\nTo upgrade, pull and update.\n\nSee `mercurial_extension_utils`_ for longer description of this kind\nof installation.\n\nWindows\n---------------------------------------------\n\nIf you have any Python installed, you may install with ``pip``::\n\n    pip install mercurial_update_version\n\nStill, as Mercurial (whether taken from TortoiseHg_, or own package)\nuses it's own bundled Python, you must activate by specifying the path::\n\n    [extensions]\n    mercurial_update_version = C:/Python27/Lib/site-packages/mercurial_update_version.py\n    ;; Or wherever pip installed it, depending on the version it can also be\n    ;; sth like (replace john with proper username and 37 with proper version)\n    ;; mercurial_update_version =  C:\\Users\\john\\AppData\\Local\\Programs\\Python\\Python37\\Lib\\site-packages\\mercurial_update_version.py\n\nTo upgrade to new version::\n\n    pip install --upgrade mercurial_update_version\n\nIf you don't have any Python, clone repositories::\n\n    cd c:\\hgplugins\n    hg clone https://foss.heptapod.net/mercurial/mercurial-extension_utils/\n    hg clone https://foss.heptapod.net/mercurial/mercurial-update_version/\n\nupdate to tagged versions and activate by path::\n\n    [extensions]\n    mercurial_update_version = C:/hgplugins/mercurial-update_version/mercurial_update_version.py\n    ;; Or wherever you cloned\n\nSee `mercurial_extension_utils`_ documentation for more details on\nWindows installation. \n\n\nHistory\n==================================================\n\nSee `HISTORY.rst`_\n\n\nRepository, bug reports, enhancement suggestions\n===================================================\n\nDevelopment is tracked on HeptaPod, see \nhttps://foss.heptapod.net/mercurial/mercurial-update_version/\n\nUse issue tracker there for bug reports and enhancement\nsuggestions.\n\nThanks to Octobus_ and `Clever Cloud`_ for hosting this service.\n\nAdditional notes\n================\n\nInformation about this extension is also available\non Mercurial Wiki: http://mercurial.selenic.com/wiki/UpdateVersionExtension\n\nCheck also `other Mercurial extensions I wrote`_.\n\n.. _Octobus: https://octobus.net/\n.. _Clever Cloud: https://www.clever-cloud.com/\n\n.. _other Mercurial extensions I wrote: http://code.mekk.waw.pl/mercurial.html\n\n.. _Mercurial: http://mercurial.selenic.com\n.. _HISTORY.rst: https://foss.heptapod.net/mercurial/mercurial-update_version/src/tip/HISTORY.rst\n.. _mercurial_extension_utils: https://foss.heptapod.net/mercurial/mercurial-extension_utils/\n.. _TortoiseHg: http://tortoisehg.bitbucket.io/\n\n.. |drone-badge| \n    image:: https://drone.io/bitbucket.org/Mekk/mercurial-update_version/status.png\n     :target: https://drone.io/bitbucket.org/Mekk/mercurial-update_version/latest\n     :align: middle\n",
    "description_content_type": "",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://foss.heptapod.net/mercurial/mercurial-update_version",
    "keywords": "mercurial hg version auto-update tag",
    "license": "BSD",
    "maintainer": "",
    "maintainer_email": "",
    "name": "mercurial_update_version",
    "package_url": "https://pypi.org/project/mercurial_update_version/",
    "platform": "",
    "project_url": "https://pypi.org/project/mercurial_update_version/",
    "project_urls": {
      "Homepage": "https://foss.heptapod.net/mercurial/mercurial-update_version"
    },
    "release_url": "https://pypi.org/project/mercurial_update_version/1.1.1/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "Mercurial Update Version Extension",
    "version": "1.1.1",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 13943121,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "419fb5f8c2d6387271d326939f8be4f63952e55eb9645cccee9aeba62edb5314",
        "md5": "49f502d4d3602e3975be3ad16b39d4f8",
        "sha256": "2383c5dfd7244ab6618369db613333d913771cee37d3673f4dd0ee95333b9baf"
      },
      "downloads": -1,
      "filename": "mercurial_update_version-1.1.1.tar.gz",
      "has_sig": false,
      "md5_digest": "49f502d4d3602e3975be3ad16b39d4f8",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 39054,
      "upload_time": "2020-06-27T22:26:43",
      "upload_time_iso_8601": "2020-06-27T22:26:43.503463Z",
      "url": "https://files.pythonhosted.org/packages/41/9f/b5f8c2d6387271d326939f8be4f63952e55eb9645cccee9aeba62edb5314/mercurial_update_version-1.1.1.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}