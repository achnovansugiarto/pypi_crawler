{
  "info": {
    "author": "Tareian, Faiz",
    "author_email": "tacazares@gmail.com, faizrizvi1993@gmail.com",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "![maxATAC_logo](https://user-images.githubusercontent.com/47329147/137503708-86d000ef-d6d4-4f75-99aa-39f8aab6dec5.png)\n\n# maxATAC: genome-scale transcription-factor binding prediction from ATAC-seq with deep neural networks\n\n[![Downloads](https://static.pepy.tech/personalized-badge/maxatac?period=total&units=international_system&left_color=black&right_color=blue&left_text=Downloads)](https://pepy.tech/project/maxatac) ![PyPI version](https://badge.fury.io/py/maxatac.svg)\n\n## Introduction\n\nmaxATAC is a Python package for transcription factor (TF) binding prediction from ATAC-seq signal and DNA sequence in *human* cell types. maxATAC works with both population-level (bulk) ATAC-seq and pseudobulk ATAC-seq profiles derived from single-cell (sc)ATAC-seq. maxATAC makes TF binding site (TFBS) predictions at 32 bp resolution.\nmaxATAC requires three inputs:\n\n* DNA sequence, in [`.2bit`](https://genome.ucsc.edu/goldenPath/help/twoBit.html) file format.\n* ATAC-seq signal, processed as described [below](#Preparing-your-ATAC-seq-signal).\n* Trained maxATAC TF Models, in [`.h5`](https://www.tensorflow.org/tutorials/keras/save_and_load) file format.\n\n> **maxATAC was trained and evaluated on data generated using the hg38 reference genome. The default paths and files that are used for each function will reference hg38 files. If you want to use maxATAC with any other species or reference, you will need to provide the appropriate chromosome sizes file, blacklist, and `.2bit` file specific to your data.**\n\n___\n\n## Installation\n\nIt is best to install maxATAC into a dedicated virtual environment.\n\nThis version requires python 3.9, `bedtools`, `samtools`, `pigz`, `wget`, `git`, and `bedGraphToBigWig` in order to run all functions.\n\n> The total install requirements for maxATAC with reference data are ~2 GB.\n\n### Installing with Conda\n\n1. Create a conda environment for maxATAC with `conda create -n maxatac -c bioconda python=3.9 samtools wget bedtools ucsc-bedgraphtobigwig pigz`\n\n> If you get an error installing ucsc-bedgraphtobigwig try `conda install -c bioconda ucsc-bedgraphtobigwig`\n\n2. Install maxATAC with `pip install maxatac`\n\n3. Test installation with `maxatac -h`\n\n4. Download reference data with `maxatac data`\n\n### Installing with python virtualenv\n\n1. Create a virtual environment for maxATAC with `virtualenv -p python3.9 maxatac`.\n\n2. Install required packages and make sure they are on your PATH: samtools, bedtools, bedGraphToBigWig, wget, git, pigz.\n\n3. Install maxatac with `pip install maxatac`\n\n4. Test installation with `maxatac -h`\n\n5. Download reference data with `maxatac data`\n\n### Downloading required reference data\n\nIn order to run the maxATAC models that were described in the [maxATAC pre-print](https://www.biorxiv.org/content/10.1101/2022.01.28.478235v1), the following files are required to be downloaded from the [maxATAC_data](https://github.com/MiraldiLab/maxATAC_data) repository and installed in the correct directory:\n\n* hg38 reference genome `.2bit` file\n* hg38 chromosome sizes file\n* maxATAC extended blacklist\n* TF specific `.h5` model files\n* TF specific thresholding files\n* Bash scripts for preparing data\n\nThe easiest option is to use the command `maxatac data` to download the data to the required directory. The `maxatac data` function will download the maxATAC_data repo and reference data into your `~/opt/` directory under `~/opt/maxatac`. Only the hg38 reference genome is supported.\n\n#### Using custom reference data\n\nThe directory `~/opt/maxatac/data` is the default location where maxATAC will look for the maxATAC models, hg38 reference annotations, etc.\n\nIf you want to use your own references (e.g., hg19) or models, set the appropriate flags for each file with the path to your custom files. You can also adjust the relative paths in `constants.py` to be the default values for all functions.\n\n___\n\n## maxATAC Quick Start Overview\n\n![maxATAC Quick Start Overview](./docs/figs/quickstart.svg)\n\n>*Schematic: Overview of a typical maxATAC workflow. First, ATAC-seq data is prepared using the maxatac prepare function. The prepare function processes bulk and scATAC-seq into normalized signal files. The normalized signal track can then be used to make TF binding predictions for the TF of interest. The IGV screenshot shows the maxATAC-normalized ATAC-seq signal (blue) and maxATAC TFBS predictions for the FOXP1 model (magenta), predictions are represented as signal tracks (.bw, bigwig) and TFBS (.bed files), the default outputs from maxATAC.*\n\n### Inputs\n\n* DNA sequence, in [`.2bit`](https://genome.ucsc.edu/goldenPath/help/twoBit.html) file format.\n* ATAC-seq signal, processed as described [below](#preparing-the-atac-seq-signal).\n* Trained maxATAC TF Models, in [`.h5`](https://www.tensorflow.org/tutorials/keras/save_and_load) file format.\n\n### Outputs\n\n* Raw maxATAC TFBS scores tracks in [`.bw`](https://genome.ucsc.edu/FAQ/FAQformat.html#format6.1) file format.\n* [`.bed`](https://genome.ucsc.edu/FAQ/FAQformat.html#format1) file of TF binding sites, thresholded according to a user-supplied confidence cut off (e.g., corresponding to an estimated precision, recall value or $log_2(precision:precision_{random} > 7$) or default ($max(F1score)$)).\n\n## ATAC-seq Data Requirements\n\nAs described in the [maxATAC pre-print](https://www.biorxiv.org/content/10.1101/2022.01.28.478235v1), **maxATAC processing of ATAC-seq signal is critical to maxATAC prediction**. Key maxATAC processing steps, summarized in a single command [`maxatac prepare`](./docs/readme/prepare.md#Prepare), include identification of Tn5 cut sites from ATAC-seq fragments, ATAC-seq signal smoothing, filtering with an extended \"maxATAC\" blacklist, and robust, min-max-like normalization. \n\nThe maxATAC models were trained on paired-end ATAC-seq data in human. For this reason, we recommend paired-end sequencing with sufficient sequencing depth (e.g., ~20M reads for bulk ATAC-seq). Until these models are benchmarked in other species, we recommend limiting their use to human ATAC-seq datasets. \n\n### Preparing the ATAC-seq signal\n\nThe current `maxatac predict` function requires a normalized ATAC-seq signal in a bigwig format. Use `maxatac prepare` to generate a normalized signal track from a `.bam` file of aligned reads.\n\n#### Bulk ATAC-seq\n\nThe function `maxatac prepare` was designed to take an input BAM file that has aligned to the hg38 reference genome. The inputs to `maxatac prepare` are the input bam file, the output directory, and the filename prefix.\n\n```bash\nmaxatac prepare -i SRX2717911.bam -o ./output -prefix SRX2717911 -dedup\n```\n\nThis function took 38 minutes for a sample with 52,657,164 reads in the BAM file. This was tested on a 2019 Macbook Pro with a 2.6 GHz 6-Core Intel Core i7 and 16 GB of memory.\n\n#### Pseudo-bulk scATAC-seq\n\nFirst, convert the `.tsv.gz` output fragments file from CellRanger into pseudo-bulk specific fragment files. Then, use `maxatac prepare` with each of the fragment files in order to generate a normalized bigwig file for input into `maxatac predict`.\n\n```bash\nmaxatac prepare -i HighLoading_GM12878.tsv -o ./output -prefix HighLoading_GM12878\n```\n\nThe prediction parameters and steps are the same for scATAC-seq data after normalization.\n\n## Predicting TF binding from ATAC-seq\n\nFollowing maxATAC-specific processing of ATAC-seq signal inputs, use the [`maxatac predict`](./docs/readme/predict.md#Predict) function to predict TF binding with a maxATAC model.\n\nTF binding predictions can be made genome-wide, for a single chromosome, or, alternatively, the user can provide a `.bed` file of genomic intervals for maxATAC predictions to be made.\n\n### Whole genome prediction\n\nExample command for TFBS prediction across the whole genome:\n\n```bash\nmaxatac predict --sequence hg38.2bit -tf CTCF --signal GM12878.bigwig -o outputdir/\n```\n\nIf data has been installed with maxATAC data, then the following command will use the best model and call peaks using the TF specific threshold statistics. \n\n```bash\nmaxatac predict -tf CTCF -s GM12878.bigwig -o outputdir/\n```\n\n### Prediction in a specific genomic region(s)\n\nFor TFBS predictions within specific regions of the genome, a `BED` file of genomic intervals, `roi` (regions of interest) are supplied:\n\n```bash\nmaxatac predict --sequence hg38.2bit -m CTCF.h5 --signal GM12878.bigwig --roi ROI.bed\n```\n\n### Prediction on a specific chromosome(s)\n\nFor TFBS predictions on a single chromosome or subset of chromosomes, these can be provided using the `--chromosomes` argument:\n\n```bash\nmaxatac predict --sequence hg38.2bit -m CTCF.h5 --signal GM12878.bigwig --chromosomes chr3 chr5\n```\n\n## Raw signal tracks (prediction bigwigs) are large\n\nEach output prediction file for a whole genome is ~700 MB per TF.\n\nThe output bed files are ~60Mb.\n\nThere are 127 TF models x ~700MB per TF model = ~88.9 GB of bigwig files for a single ATAC-seq input track. (Note: it only makes sense to generate maxATAC predicitons for TFs expressed in your cell type / conditions of interest, so this is a worst-case estimate.)\n\n___\n\n## maxATAC functions\n\n| Subcommand                                          | Description                                    |\n|-----------------------------------------------------|------------------------------------------------|\n| [`prepare`](./docs/readme/prepare.md#Prepare)       | Prepare input data                             |\n| [`average`](./docs/readme/average.md#Average)       | Average ATAC-seq signal tracks                 |\n| [`normalize`](./docs/readme/normalize.md#Normalize) | Minmax normalize ATAC-seq signal tracks        |\n| [`train`](./docs/readme/train.md#Train)             | Train a model                                  |\n| [`predict`](./docs/readme/predict.md#Predict)       | Predict TF binding                             |\n| [`benchmark`](./docs/readme/benchmark.md#Benchmark) | Benchmark maxATAC predictions against ChIP-seq |\n| [`peaks`](./docs/readme/peaks.md#Peaks)             | Call \"peaks\" on maxATAC signal tracks          |\n| [`variants`](./docs/readme/variants.md#Variants)    | Predict sequence specific TF binding           |\n\n___\n\n## Publication\n\nThe maxATAC pre-print is currently available on [bioRxiv](https://www.biorxiv.org/content/10.1101/2022.01.28.478235v1.article-metrics). \n\n```pre\nmaxATAC: genome-scale transcription-factor binding prediction from ATAC-seq with deep neural networks\nTareian Cazares, Faiz W. Rizvi, Balaji Iyer, Xiaoting Chen, Michael Kotliar, Joseph A. Wayman, Anthony Bejjani, Omer Donmez, Benjamin Wronowski, Sreeja Parameswaran, Leah C. Kottyan, Artem Barski, Matthew T. Weirauch, VB Surya Prasath, Emily R. Miraldi\nbioRxiv 2022.01.28.478235; doi: https://doi.org/10.1101/2022.01.28.478235\n```\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "https://github.com/MiraldiLab/maxATAC",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/MiraldiLab/maxATAC",
    "keywords": "",
    "license": "Apache-2.0",
    "maintainer": "",
    "maintainer_email": "",
    "name": "maxatac",
    "package_url": "https://pypi.org/project/maxatac/",
    "platform": null,
    "project_url": "https://pypi.org/project/maxatac/",
    "project_urls": {
      "Download": "https://github.com/MiraldiLab/maxATAC",
      "Homepage": "https://github.com/MiraldiLab/maxATAC"
    },
    "release_url": "https://pypi.org/project/maxatac/1.0.5/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "maxATAC: a suite of user-friendly, deep neural network models for transcription factor binding prediction from ATAC-seq",
    "version": "1.0.5",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 13724009,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "ef5fc593818292ce62a2edd4fa3acddc0f2d22d80546091714f9b7e26da84f26",
        "md5": "9ff5095cea77aa64399acc22f88954b8",
        "sha256": "c75bbf3eda801213f9eaf8029110f13334ed2c39d1381e01b6a455d93b776013"
      },
      "downloads": -1,
      "filename": "maxatac-1.0.5.tar.gz",
      "has_sig": false,
      "md5_digest": "9ff5095cea77aa64399acc22f88954b8",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 60052,
      "upload_time": "2022-05-05T19:17:21",
      "upload_time_iso_8601": "2022-05-05T19:17:21.682433Z",
      "url": "https://files.pythonhosted.org/packages/ef/5f/c593818292ce62a2edd4fa3acddc0f2d22d80546091714f9b7e26da84f26/maxatac-1.0.5.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}