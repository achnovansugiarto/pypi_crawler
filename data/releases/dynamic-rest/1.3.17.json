{
  "info": {
    "author": "Anthony Leontiev",
    "author_email": "ant@altschool.com, ryo@altschool.com",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "# Dynamic REST\n\n[![Circle CI](https://circleci.com/gh/AltSchool/dynamic-rest.svg?style=svg)](https://circleci.com/gh/AltSchool/dynamic-rest)\n[![PyPi](https://img.shields.io/pypi/v/dynamic-rest.svg)](https://pypi.python.org/pypi/dynamic-rest)\n\n**Dynamic API extensions for Django REST Framework**\n\nSee http://dynamic-rest.readthedocs.org for full documentation.\n\n<!-- START doctoc generated TOC please keep comment here to allow auto update -->\n<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->\n# Table of Contents\n\n- [Overview](#overview)\n- [Maintainers](#maintainers)\n- [Requirements](#requirements)\n- [Installation](#installation)\n- [Demo](#demo)\n- [Features](#features)\n  - [Linked relationships](#linked-relationships)\n  - [Sideloaded relationships](#sideloaded-relationships)\n  - [Embedded relationships](#embedded-relationships)\n  - [Field inclusions](#field-inclusions)\n  - [Field exclusions](#field-exclusions)\n  - [Field-based filtering](#field-based-filtering)\n  - [Field-based ordering](#field-based-ordering)\n  - [Directory panel](#directory-panel)\n  - [Optimizations](#optimizations)\n- [Settings](#settings)\n- [Compatability table](#compatability-table)\n- [Contributing](#contributing)\n- [License](#license)\n\n<!-- END doctoc generated TOC please keep comment here to allow auto update -->\n\n# Overview\n\nDynamic REST (or DREST) extends the popular [Django REST Framework](https://django-rest-framework.org) (or DRF) with API features that\nempower simple RESTful APIs with the flexibility of a graph query language.\n\nDREST classes can be used as a drop-in replacement for DRF classes, which offer the following features on top of the standard DRF kit:\n\n* Linked relationships\n* Sideloaded relationships\n* Embedded relationships \n* Field inclusions\n* Field exclusions\n* Field-based filtering\n* Field-based sorting\n* Directory panel for your Browsable API\n* Optimizations\n\nDREST was initially written to complement [Ember Data](https://github.com/emberjs/data),\nbut it can be used to provide fast and flexible CRUD operations to any consumer that supports JSON over HTTP.\n\n## Maintainers\n\n* [Anthony Leontiev](mailto:ant@altschool.com)\n* [Ryo Chijiiwa](mailto:ryo@altschool.com)\n\n# Requirements\n\n* Python (2.7, 3.3, 3.4, 3.5)\n* Django (1.7, 1.8, 1.9)\n* Django REST Framework (3.1, 3.2, 3.3)\n\n# Installation\n\n1) Install using `pip`:\n\n```bash\n    pip install dynamic-rest\n```\n\n(or add `dynamic-rest` to `requirements.txt` or `setup.py`)\n\n2) Add `rest_framework` and `dynamic_rest` to `INSTALLED_APPS` in `settings.py`:\n\n```python\n    INSTALLED_APPS = (\n        ...\n        'rest_framework',\n        'dynamic_rest'\n    )\n\n```\n\n# Demo\n\nThis repository comes with a `tests` package that also serves as a demo application.\nThis application is hosted at https://dynamic-rest.herokuapp.com but can also be run locally:\n\n1) Clone this repository:\n\n```bash\n    git clone git@github.com:AltSchool/dynamic-rest.git\n    cd dynamic-rest\n```\n\n2) From within the repository root, start the demo server:\n\n```bash\n    make serve\n```\n\n3) Visit `localhost:9002` in your browser.\n\n4) To load sample fixture data, run `make fixtures` and restart the server.\n\n# Features\n\nTo understand the DREST API features, let us consider a demo model with a corresponding viewset, serializer, and route.\nThis will look very familiar to anybody who has worked with DRF:\n\n```python\n# The related LocationSerializer and GroupSerializer are omitted for brevity\n\n# The Model\nclass User(models.Model):\n    name = models.TextField()\n    location = models.ForeignKey('Location')\n    groups = models.ManyToManyField('Group')\n\n# The Serializer\nclass UserSerializer(DynamicModelSerializer):\n    class Meta:\n        model = User\n        name = 'user'\n        fields = (\"id\", \"name\", \"location\", \"groups\")\n\n    location = DynamicRelationField('LocationSerializer')\n    groups = DynamicRelationField('GroupSerializer', many=True)\n\n# The ViewSet\nclass UserViewSet(DynamicModelViewSet):\n    serializer_class = UserSerializer\n    queryset = User.objects.all()\n\n# The Router\nrouter = DynamicRouter()\nrouter.register('/users', UserViewSet)\n```\n\n## Linked relationships\n\nOne of the key features of the DREST serializer layer is the ability to represent relationships in different ways, depending on the request context (external requirements) and the code context (internal requirements).\n\nBy default, a \"has-one\" (or \"belongs-to\") relationship will be represented as the value of the related object's ID.\nA \"has-many\" relationship will be represented as a list of all related object IDs.\n\nWhen a relationship is represented in this way, DREST automatically includes relationship links for any has-many relationships in the API response that represents the object:\n\n```\n-->\n    GET /users/1/\n<--\n    200 OK\n    {\n        \"user\": {\n            \"id\": 1,\n            \"name\": \"John\",\n            \"location\": 1,\n            \"groups\": [1, 2],\n            \"links\": {\n                \"groups\": \"/users/1/groups\"\n            }\n        }\n    }\n```\n\nAn API consumer can navigate to these relationship endpoints in order to obtain information about the related records. DREST will automatically create\nthe relationship endpoints -- no additional code is required:\n\n```\n-->\n    GET /users/1/groups\n<--\n    200 OK\n    {\n        \"groups\": [{\n            \"id\": 1,\n            \"name\": \"Family\",\n            \"location\": 2,\n        }, {\n            \"id\": 2,\n            \"name\": \"Work\",\n            \"location\": 3,\n        }]\n    }\n```\n\n## Sideloaded relationships\n\nUsing linked relationships provides your API consumers with a \"lazy-loading\" mechanism for traversing through a graph of data. The consumer can first load the primary resource and then load related resources later.\n\nIn some situations, it can be more efficient to load relationships eagerly, in such a way that both the primary records and their related data are loaded simultaneously. In Django, this can be accomplished by using [prefetch_related](https://docs.djangoproject.com/en/1.9/ref/models/querysets/#django.db.models.query.QuerySet.prefetch_related) or [select_related](https://docs.djangoproject.com/en/1.9/ref/models/querysets/#select-related).\n\nIn DREST, the requirement to eagerly load (or \"sideload\") relationships can be expressed with the `include[]` query parameter.\n\nFor example, in order to fetch a user and sideload their groups:\n\n```\n--> \n    GET /users/1/?include[]=groups.*\n<--\n    200 OK\n    {\n        \"user\": {\n            \"id\": 1,\n            \"name\": \"John\",\n            \"location\": 1,\n            \"groups\": [1, 2]\n        },\n        \"groups\": [{\n            \"id\": 1,\n            \"name\": \"Family\",\n            \"location\": 2\n        }, {\n            \"id\": 2,\n            \"name\": \"Work\",\n            \"location\": 3\n        }]\n    }\n```\n\nThe \"user\" portion of the response looks nearly identical to the first example; the user is returned top-level, and the groups are represented by their IDs. However, instead of including a link to the groups endpoint, the group data is present within the respones itself, under a top-level \"groups\" key.\n\nNote that each group itself contains relationships to \"location\", which are linked in this case.\n\nWith DREST, it is possible to sideload as many relationships as you'd like, as deep as you'd like.\n\nFor example, to obtain the user with groups, locations, and groups' locations all sideloaded in the same response:\n\n```\n--> \n    GET /users/1/?include[]=groups.location.*&include[]=location.*\n<--\n    200 OK\n    {\n        \"user\": {\n            \"id\": 1,\n            \"name\": \"John\",\n            \"location\": 1,\n            \"groups\": [1, 2]\n        },\n        \"groups\": [{\n            \"id\": 1,\n            \"name\": \"Family\",\n            \"location\": 2,\n        }, {\n            \"id\": 2,\n            \"name\": \"Work\",\n            \"location\": 3,\n        }],\n        \"locations\": [{\n            \"id\": 1,\n            \"name\": \"New York\"\n        }, {\n            \"id\": 2,\n            \"name\": \"New Jersey\"\n        }, {\n            \"id\": 3,\n            \"name\": \"California\"\n        }]\n    }\n```\n\n## Embedded relationships\n\nIf you want your relationships loaded eagerly but don't want them sideloaded in the top-level, you can instruct your serializer to embed relationships instead. \n\nIn that case, the demo serializer above would look like this:\n\n```python\n\n# The Serializer\nclass UserSerializer(DynamicModelSerializer):\n    class Meta:\n        model = User\n        name = 'user'\n        fields = (\"id\", \"name\", \"location\", \"groups\")\n\n    location = DynamicRelationField('LocationSerializer', embed=True)\n    groups = DynamicRelationField('GroupSerializer', embed=True, many=True)\n\n```\n\n... and the call above would return a response with relationships embedded in place of the usual ID representation:\n\n```\n--> \n    GET /users/1/?include[]=groups.*\n<--\n    200 OK\n    {\n        \"user\": {\n            \"id\": 1,\n            \"name\": \"John\",\n            \"location\": 1,\n            \"groups\": [{\n                \"id\": 1,\n                \"name\": \"Family\",\n                \"location\": 2\n            }, {\n                \"id\": 2,\n                \"name\": \"Work\",\n                \"location\": 3\n            }]\n        }\n    }\n```\n\nIn DREST, sideloading is the default because it can produce much smaller payloads in circumstances where related objects are referenced more than once in the response.\n\nFor example, if you requested a list of 10 users along with their groups, and those users all happened to be in the same groups, the embedded variant would represent each group 10 times. The sideloaded variant would only represent a particular group once, regardless of the number of times that group is referenced.\n\n## Field inclusions \n\nYou can use the `include[]` feature not only to sideload relationships, but also to load basic fields that are marked \"deferred\".\n\nIn DREST, any field or relationship can be marked deferred, which indicates to the framework that the field should only be returned when requested by `include[]`. This could be a good option for fields with large values that are not always relevant in a general context.\n\nFor example, a user might have a \"personal_statement\" field that we would want to defer. At the serializer layer, that would look like this:\n\n```python\n\n# The Serializer\nclass UserSerializer(DynamicModelSerializer):\n    class Meta:\n        model = User\n        name = 'user'\n        fields = (\"id\", \"name\", \"location\", \"groups\", \"personal_statement\")\n        deferred_fields = (\"personal_statement\", )\n    \n    location = DynamicRelationField('LocationSerializer')\n    groups = DynamicRelationField('GroupSerializer', many=True)\n\n```\n\nThis field will only be returned if requested:\n\n```\n-->\n    GET /users/1/?include[]=personal_statement\n<--\n    200 OK\n    {\n        \"user\": {\n            \"id\": 1,\n            \"name\": \"John\",\n            \"location\": 1,\n            \"groups\": [1, 2],\n            \"personal_statement\": \"Hello, my name is John and I like........\",\n            \"links\": {\n                \"groups\": \"/users/1/groups\"\n            }\n        }\n    }\n```\n\nNote that `include[]=personal_statement` does not have a `.` following the field name as in the previous examples for embedding and sideloading relationships. This allows us to differentiate between cases where we have a deferred relationship and want to include the relationship IDs as opposed to including and also sideloading the relationship. \n\nFor example, if the user had a deferred \"events\" relationship, passing `include[]=events` would return an \"events\" field populated by event IDs, passing `include[]=events.` would sideload or embed the events themselves, and by default, only a link to the events would be returned. This can be useful for large has-many relationships.\n\n## Field exclusions\n\nJust as deferred fields can be included on demand with the `include[]` feature, fields that are not deferred can be excluded with the `exclude[]` feature. Like `include[]`, `exclude[]` also supports multiple values and dot notation to allow you to exclude fields on sideloaded relationships.\n\nFor example, if we want to fetch a user with his groups, but ignore the groups' location and user's location, we could make a request like this:\n\n```\n-->\n    GET /users/1/?include[]=groups.*&exclude[]=groups.location&exclude[]=location\n<--\n    200 OK\n    {\n        \"user\": {\n            \"id\": 1,\n            \"name\": \"John\",\n            \"groups\": [1, 2],\n            \"links\": {\n                \"location\": \"/users/1/location\"\n            }\n        },\n        \"groups\": [{\n            \"id\": 1,\n            \"name\": \"Family\",\n            \"links\": {\n                \"location\": \"/groups/1/location\"\n            }\n        }, {\n            \"id\": 2,\n            \"name\": \"Work\",\n            \"links\": {\n                \"location\": \"/groups/2/location\"\n            }\n        }]\n    }\n```\n\n`exclude[]` supports the wildcard value: `*`, which means \"don't return anything\".\nWhy is that useful? `include[]` overrides `exclude[]`, so `exclude[]=*` can be combined with `include[]` to return only a single value or set of values from a resource.\n\nFor example, to obtain only the user's name:\n\n```\n-->\n    GET /users/1/?exclude[]=*&include[]=name\n<--\n    200 OK\n    {\n        \"user\": {\n            \"name\": \"John\",\n            \"links\": {\n                \"location\": \"/users/1/location\",\n                \"groups\": \"/users/1/groups\"\n            }\n        }\n    }\n```\n\nNote that `links` will always be returned for relationships that are deferred.\n\n## Field-based filtering\n\nTired of writing custom filters for all of your fields? DREST has your back with the `filter{}` feature.\n\nYou can filter a user by his name (exact match):\n\n```\n-->\n    GET /users/?filter{name}=John\n<--\n    200 OK\n    ...\n```\n\n... or a partial match:\n\n```\n--> \n   GET /users/?filter{name.icontains}=jo\n<--\n    200 OK\n    ...\n```\n\n... or one of several names:\n\n```\n-->\n    GET /users/?filter{name.in}=John&filter{name.in}=Joe\n<--\n    200 OK\n```\n\n... or a relationship ID:\n\n```\n-->\n    GET /users/?filter{groups}=1\n<--\n    200 OK\n```\n\n... or lack thereof:\n\n```\n-->\n    GET /users/?filter{-groups}=1\n<--\n    200 OK\n```\n\n... or a relationship field:\n\n```\n-->\n    GET /users/?filter{groups.name}=Home\n<--\n    200 OK\n```\n\n... or multiple criteria:\n\n```\n-->\n    GET /users/?filter{groups.name}=Home&filter{name}=John\n<--\n    200 OK\n```\n\n... or combine it with `include[]` to filter the sideloaded data (get all the users and only sideload certain groups):\n\n```\n-->\n    GET /users/?include[]=groups.*&filter{groups.name.icontains}=h\n<--\n    200 OK\n```\n\nThe sky is the limit! DREST supports just about every basic filtering scenario and operator that you can use in Django:\n\n* in\n* icontains\n* istartswith\n* range\n* lt\n* gt\n...\n\nSee the [full list here](dynamic_rest/filters.py#L133).\n\n## Field-based ordering\n\nYou can use the `sort[]` feature to order your response by one or more fields. Dot notation is supported for sorting by nested properties:\n\n```\n-->\n    GET /users/?sort[]=name&sort[]=groups.name\n<--\n    200 OK\n    ...\n```\n\n## Directory panel\n\nWe love the DRF browsable API, but wish that it included a directory that would let you see your entire list of endpoints at a glance from any page.\nDREST adds that in:\n\n![Directory panel][directory]\n\n## Optimizations\n\nSupporting nested sideloading and filtering is expensive and can lead to very poor query performance if implemented naively.\nDREST uses Django's [Prefetch](https://docs.djangoproject.com/en/1.9/ref/models/querysets/#django.db.models.Prefetch) object to prevent N+1 query situations and guarantee that your API is performant. \nWe also optimize the serializer layer to ensure that the conversion of model objects into JSON is as fast as possible. \n\nHow fast is it? Here are some [benchmarks](benchmarks) that compare DREST response time to DRF response time. DREST out-performs DRF on every benchmark:\n\nLinear benchmark: rendering a flat list\n![Linear Benchmark][benchmark-linear]\n\nQuadratic benchmark: rendering a list of lists\n![Quadratic Benchmark][benchmark-quadratic]\n\nCubic benchmark: rendering a list of lists of lists\n![Cubic Benchmark][benchmark-cubic]\n\n# Settings\n\nDREST is configurable, and all settings should be nested under a single block in your `settings.py` file.\nHere are our [defaults](dynamic_rest/conf.py):\n\n```python\nDYNAMIC_REST = {\n    # DEBUG: enable/disable internal debugging\n    'DEBUG': False,\n\n    # ENABLE_BROWSABLE_API: enable/disable the browsable API.\n    # It can be useful to disable it in production.\n    'ENABLE_BROWSABLE_API': True,\n\n    # ENABLE_LINKS: enable/disable relationship links\n    'ENABLE_LINKS': True,\n\n    # ENABLE_SERIALIZER_CACHE: enable/disable caching of related serializers\n    'ENABLE_SERIALIZER_CACHE': True,\n\n    # ENABLE_SERIALIZER_OPTIMIZATIONS: enable/disable representation speedups\n    'ENABLE_SERIALIZER_OPTIMIZATIONS': True,\n\n    # MAX_PAGE_SIZE: global setting for max page size.\n    # Can be overriden at the viewset level.\n    'MAX_PAGE_SIZE': None,\n\n    # PAGE_QUERY_PARAM: global setting for the pagination query parameter.\n    # Can be overriden at the viewset level.\n    'PAGE_QUERY_PARAM': 'page',\n\n    # PAGE_SIZE: global setting for page size.\n    # Can be overriden at the viewset level.\n    'PAGE_SIZE': None,\n\n    # PAGE_SIZE_QUERY_PARAM: global setting for the page size query parameter.\n    # Can be overriden at the viewset level.\n    'PAGE_SIZE_QUERY_PARAM': 'per_page'\n}\n```\n\n# Compatability table\n\nNot all versions of Python, Django, and DRF are compatible. Here are the combinations you can use reliably with DREST (all tested by our tox configuration):\n\n| Python | Django | DRF | OK  |\n| ------ | ------ | --- | --- |\n| 2.7    | 1.7    | 3.1 | YES |\n| 2.7    | 1.7    | 3.2 | YES |\n| 2.7    | 1.7    | 3.3 | YES |\n| 2.7    | 1.8    | 3.1 | YES |\n| 2.7    | 1.8    | 3.2 | YES |\n| 2.7    | 1.8    | 3.3 | YES |\n| 2.7    | 1.9    | 3.1 | NO<sup>1</sup> |\n| 2.7    | 1.9    | 3.2 | YES |\n| 2.7    | 1.9    | 3.3 | YES |\n| 3.3    | 1.7    | 3.1 | YES |\n| 3.3    | 1.7    | 3.2 | YES |\n| 3.3    | 1.7    | 3.3 | YES |\n| 3.3    | 1.8    | 3.1 | YES |\n| 3.3    | 1.8    | 3.2 | YES |\n| 3.3    | 1.8    | 3.3 | YES |\n| 3.3    | 1.9    | 3.1 | NO<sup>1,2</sup> |\n| 3.3    | 1.9    | 3.2 | NO<sup>2</sup> |\n| 3.3    | 1.9    | 3.3 | NO<sup>2</sup> |\n| 3.4    | 1.7    | 3.1 | YES |\n| 3.4    | 1.7    | 3.2 | YES |\n| 3.4    | 1.7    | 3.3 | YES |\n| 3.4    | 1.8    | 3.1 | YES |\n| 3.4    | 1.8    | 3.2 | YES |\n| 3.4    | 1.8    | 3.3 | YES |\n| 3.4    | 1.9    | 3.1 | NO<sup>1</sup> |\n| 3.4    | 1.9    | 3.2 | YES |\n| 3.4    | 1.9    | 3.3 | YES |\n| 3.5    | 1.7    | 3.1 | NO<sup>3</sup> |\n| 3.5    | 1.7    | 3.2 | NO<sup>3</sup> |\n| 3.5    | 1.7    | 3.3 | NO<sup>3</sup> |\n| 3.5    | 1.8    | 3.1 | YES |\n| 3.5    | 1.8    | 3.2 | YES |\n| 3.5    | 1.8    | 3.3 | YES |\n| 3.5    | 1.9    | 3.1 | NO<sup>1</sup> |\n| 3.5    | 1.9    | 3.2 | YES |\n| 3.5    | 1.9    | 3.3 | YES |\n\n* 1: Django 1.9 is not compatible with DRF 3.1\n* 2: Django 1.9 is not compatible with Python 3.3\n* 3: Django 1.7 is not compatible with Python 3.5\n\n# Contributing\n\nSee [Contributing](CONTRIBUTING.md).\n\n# License\n\nSee [License](LICENSE.md).\n\n[directory]: images/directory.png\n[benchmark-linear]: images/benchmark-linear.png\n[benchmark-quadratic]: images/benchmark-quadratic.png\n[benchmark-cubic]: images/benchmark-cubic.png",
    "description_content_type": null,
    "docs_url": null,
    "download_url": "UNKNOWN",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "http://github.com/AltSchool/dynamic-rest",
    "keywords": null,
    "license": "UNKNOWN",
    "maintainer": null,
    "maintainer_email": null,
    "name": "dynamic-rest",
    "package_url": "https://pypi.org/project/dynamic-rest/",
    "platform": "UNKNOWN",
    "project_url": "https://pypi.org/project/dynamic-rest/",
    "project_urls": {
      "Download": "UNKNOWN",
      "Homepage": "http://github.com/AltSchool/dynamic-rest"
    },
    "release_url": "https://pypi.org/project/dynamic-rest/1.3.17/",
    "requires_dist": null,
    "requires_python": null,
    "summary": "Adds Dynamic API support to Django REST Framework.",
    "version": "1.3.17",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 12770610,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "45a5026a180c8be7d64b80ea267d85b05e03ec1f75958e0abeb44707a80e0ade",
        "md5": "b616253a74225c6f39a4f56bcd0ae76f",
        "sha256": "3758aa21f0825e1bcb04a753bd242ceddea7a256e6a86546a9fafec702d307ee"
      },
      "downloads": -1,
      "filename": "dynamic-rest-1.3.17.tar.gz",
      "has_sig": false,
      "md5_digest": "b616253a74225c6f39a4f56bcd0ae76f",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 59724,
      "upload_time": "2016-02-16T22:24:25",
      "upload_time_iso_8601": "2016-02-16T22:24:25.187563Z",
      "url": "https://files.pythonhosted.org/packages/45/a5/026a180c8be7d64b80ea267d85b05e03ec1f75958e0abeb44707a80e0ade/dynamic-rest-1.3.17.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}