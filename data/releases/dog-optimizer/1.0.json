{
  "info": {
    "author": "Maor Ivgi, Oliver Hinder, Yair Carmon",
    "author_email": "",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: MIT License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3"
    ],
    "description": "# DoG Optimizer\n\nThis repository contains the implementation of the algorithms in the paper \n[DoG is SGD's Best Friend: A Parameter-Free Dynamic Step Size Schedule](https://arxiv.org/abs/2302.12022)\nby Maor Ivgi, Oliver Hinder and Yair Carmon.\n\n## Installation\nTo install the package, simply run `pip install dog-optimizer`.\n\n## Usage\nDoG (or LDoG) are implemented using the standard pytorch optimizer interface. After installing the pacakge with `pip install dog-optimizer`,\nAll you need to do is replace the line that creates your optimizer with \n```python\nfrom dog_optimizer import DoG\noptimizer = DoG(optimizer args)\n```\nfor DoG, or\n```python\nfrom dog_optimizer import LDoG\noptimizer = LDoG(optimizer args)\n```\nfor LDoG, \nwhere `optimizer args` follows the standard pytorch optimizer syntex. \nTo see the list of all available parameters, run `help(DoG)` or `help(LDoG)`.\n\n\nUsing the polynomial decay averager is also easy. Simply create it with \n```python\nfrom dog_optimizer import PolynomialDecayAverager\naverager = PolynomialDecayAverager(model)\n```\nthen, after each `optimizer.step()`, call `averager.step()` as well.\nYou can then get both the current model and the averaged model with `averager.base_model` and `averager.averaged_model` respectively.\n\nAn example of how to use the above to train a simple CNN on MNIST can be found in `examples/mnist.py` \n(based on this [pytorch example](https://github.com/pytorch/examples/blob/main/mnist/main.py)).\n\n### Choosing `reps_rel`\nDoG is parameter-free by design, so there is no need to tune a learning rate parameter. \nHowever, as discussed in the paper, DoG has an initial step movement parameter \n$r_{\\epsilon}$ that must be small enough to avoid destructively updates that cause divergence, \nbut an extremely small value of $r_{\\epsilon}$ would slow down training. \nWe recommend choosing $r_{\\epsilon}$ relative to the norm of the initial weights $x_0$. In particular, we set \n$r_{\\epsilon}$ to be `reps_rel` time $1+\\|x_0\\|$, where `reps_rel` is a configurable parameter of the optimizer. The default value \nof `reps_rel` is 1e-6, and we have found it to work well most of the time. However, in our experiments we did encounter \nsome situations that required different values of `reps_rel`:\n- If optimization diverges early, it is likely that `reps_rel` (and hence $r_{\\epsilon}$) is too large: \ntry decreasing it by factors 100 until divergence no longer occurs. This happened when applying LDoG to fine-tune T5, \nwhich had large pre-trained weights; setting `reps_rel` to 1e-8 eliminated the divergence.\n- If the DoG step size (`eta`) does not substantially increase from its initial value for a few hundred steps, it could be that `reps_rel` is too small: \ntry increasing it by factors of 100 until you see `eta` starting to increase in the first few steps. \nThis happened when training models with batch normalization; setting `reps_rel` to 1e-4 eliminated the problem.\n\n\n## Citation\n```\n@article{ivgi2023dog,\n  title={{D}o{G} is {SGD}'s Best Friend: A Parameter-Free Dynamic Step Size Schedule}, \n  author={Maor Ivgi and Oliver Hinder and Yair Carmon}, \n  journal={arXiv:2302.12022}, \n  year={2023},\n}  \n```\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "dog-optimizer",
    "package_url": "https://pypi.org/project/dog-optimizer/",
    "platform": null,
    "project_url": "https://pypi.org/project/dog-optimizer/",
    "project_urls": {
      "Homepage": "https://github.com/formll/dog",
      "Paper": "https://arxiv.org/abs/2302.12022"
    },
    "release_url": "https://pypi.org/project/dog-optimizer/1.0/",
    "requires_dist": null,
    "requires_python": ">=3.7",
    "summary": "implementation of the algorithms in the paper DoG is SGD's Best Friend: A Parameter-Free Dynamic Step Size Schedule",
    "version": "1.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 17052261,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "6c4b805de2a7e90c8c2f9ae5aef83e9960f325537ca66c6218a962ec8987b820",
        "md5": "5d38563a636cab6d135a915bcce78fb0",
        "sha256": "e2de62aba639385822373f720adb492b378b4e7d4bd2c7873102940807330454"
      },
      "downloads": -1,
      "filename": "dog_optimizer-1.0-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "5d38563a636cab6d135a915bcce78fb0",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7",
      "size": 7872,
      "upload_time": "2023-02-25T21:04:43",
      "upload_time_iso_8601": "2023-02-25T21:04:43.505153Z",
      "url": "https://files.pythonhosted.org/packages/6c/4b/805de2a7e90c8c2f9ae5aef83e9960f325537ca66c6218a962ec8987b820/dog_optimizer-1.0-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "dcd69d5e68e57c0b7bb2946f864d4b55df4fcc9a29f2cdebd272670f19e583b3",
        "md5": "52fb545306c28a6faeeb5272102ec4e1",
        "sha256": "88bdcad740129e3b7060205db9c29e1615fe1061aa996a6f8ea5b308d12dc5fe"
      },
      "downloads": -1,
      "filename": "dog_optimizer-1.0.tar.gz",
      "has_sig": false,
      "md5_digest": "52fb545306c28a6faeeb5272102ec4e1",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7",
      "size": 8302,
      "upload_time": "2023-02-25T21:04:45",
      "upload_time_iso_8601": "2023-02-25T21:04:45.991010Z",
      "url": "https://files.pythonhosted.org/packages/dc/d6/9d5e68e57c0b7bb2946f864d4b55df4fcc9a29f2cdebd272670f19e583b3/dog_optimizer-1.0.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}