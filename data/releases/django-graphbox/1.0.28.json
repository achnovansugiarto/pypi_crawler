{
  "info": {
    "author": "Yeison Fernandez",
    "author_email": "contacto@90horasporsemana.com",
    "bugtrack_url": null,
    "classifiers": [
      "Environment :: Web Environment",
      "Framework :: Django",
      "Framework :: Django :: 3.2",
      "Intended Audience :: Developers",
      "License :: OSI Approved :: MIT License",
      "Programming Language :: Python :: 3.6",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Topic :: Software Development :: Libraries :: Application Frameworks"
    ],
    "description": "Django GraphBox is a package for easy building GraphQL APIs with Django. See the full documentation at https://90horasporsemana.com/graphbox/\n\nInstallation\n-----------------------------------------------\n    .. code-block:: bash\n\n        $ pip install django-graphbox\n\nQuickstart\n------------------------------------------------\n\nUse this guide to get started with the GraphBox.\n\n1. Create a new Django project.\n\n    .. code-block:: bash\n\n        $ django-admin startproject my_project\n        $ cd my_project\n        $ python manage.py startapp my_app\n\n2. Define your Django models in the `my_app` app.\n\n    .. code-block:: python3\n\n        from django.db import models\n\n        class MyModel(models.Model):\n            ...\n    .. code-block:: bash\n\n        $ python manage.py makemigrations my_app\n        $ python manage.py migrate\n\n3. Configure and Build your GraphQL schema with django_graphbox.builder.SchemaBuilder on a new file called `schema.py` on the `my_app` app.\n    \n        .. code-block:: python3\n    \n            from django_graphbox.builder import SchemaBuilder\n            from my_app.models import MyModel\n\n            builder = SchemaBuilder()\n            builder.add_model(MyModel)\n            query_class = builder.build_schema_query()\n            mutation_class = builder.build_schema_mutation()\n\n4. Create a main schema in a new file called `schema.py` on `my_project` folder. This file can be used to merge all queries and mutations from all apps builded with django_graphbox or just add your own queries and mutations.\n\n    .. code-block:: python3\n            \n            import graphene\n            from my_app.schema import query_class, mutation_class\n\n            class Query(query_class, graphene.ObjectType):\n                pass\n\n            class Mutation(mutation_class, graphene.ObjectType):\n                pass\n\n            schema = graphene.Schema(query=Query, mutation=Mutation)\n\n5. Add the schema on urls.py file.\n    \n        .. code-block:: python3\n                \n                from django.urls import path\n                from graphene_file_upload.django import FileUploadGraphQLView\n                from django.views.decorators.csrf import csrf_exempt\n                from .schema import schema\n\n                urlpatterns = [\n                    path('graphql/', csrf_exempt(FileUploadGraphQLView.as_view(graphiql=True, schema=schema))),\n                ]\n\n6. Run your project.\n    \n        .. code-block:: bash\n    \n            $ python manage.py runserver\n\nBasic Authentication\n--------------------------------------------------------------------------------\n\nDjango GraphBox implements a SessionManager that can be used to manage access to the GraphQL API.\nThis Manager is based on JWT authentication, so you have to send on Bearer format the token in the Authorization header.\n\nFollow the steps below to create a new user and Manage the access to the GraphQL API.\n\n1. Create your User model.\n\n    .. code-block:: python3\n\n        from django.models import Model\n\n        class User(Model):\n            custom_uname = models.CharField(max_length=100)\n            custom_pwd = models.CharField(max_length=100)\n            custom_active = models.BooleanField(default=True)\n            role = models.CharField(max_length=100)\n\n    Note that you can define your fields as you want, and you will be able to configure this fields in the SessionManager.\n\n2. Configure groups and modify_permissions in `settings.py` file.\n\n    .. code-block:: python3\n\n        ACCESS_GROUPS = {\n            \"GROUP_LEVEL_1\": [\"RULE_LEVEL1\"],\n            \"GROUP_LEVEL_2\": [\"RULE_LEVEL1\", \"RULE_LEVEL_2\",],\n            \"GROUP_LEVEL_3\": [\"RULE_LEVEL1\" ,\"RULE_LEVEL_2\", \"RULE_LEVEL_3\",],\n        }\n    \n    This groups can be interpreted as: If an operation like `create_field` is configured for allow to GROUP_LEVEL_2\n    then the user will be able to create a field only if he has the role RULE_LEVEL_1 or RULE_LEVEL_2.\n\n    .. code-block:: python3\n\n        MODIFY_PERMISSIONS = {\n            \"ROLE_LEVEL_1\": [\"ROLE_LEVEL_3\", \"ROLE_LEVEL_2\", \"ROLE_LEVEL_1\"],\n            \"ROLE_LEVEL_2\": [\"ROLE_LEVEL_3\", \"ROLE_LEVEL_2\",],\n            \"ROLE_LEVEL_3\": [\"ROLE_LEVEL_1\",],\n        }\n\n\n    This permissions are related with the operations of the user model used on SessionManager. A user with the permission ROLE_LEVEL_2 only can create, update and delete user instances with the permission ROLE_LEVEL_2 and ROLE_LEVEL_3.\n    \n3. Create a new instance of the SessionManager on your `schema.py` file on the `my_app` app and configure the user model.\n\n    .. code-block:: python3\n\n        from django_graphbox.session import Manager as SessionManager\n        from my_app.models import User\n        from django.conf import settings\n\n        session_manager = SessionManager(User, rol_field_name='role', login_id_field_name='custom_uname', password_field_name='custom_pwd', active_field_name='custom_active', groups=settings.ACCESS_GROUPS, modify_permissions=settings.MODIFY_PERMISSIONS)\n\n4. Configure and Build your GraphQL schema with django_graphbox.builder.SchemaBuilder on the file called `schema.py` on the `my_app` app.\n    \n        .. code-block:: python3\n    \n            from django_graphbox.builder import SchemaBuilder\n            from my_app.models import MyModel\n\n            # Add the SessionManager to the SchemaBuilder\n            builder = SchemaBuilder(session_manager=session_manager)\n            # Build your operations\n            builder.add_model(MyModel, access_group=\"GROUP_LEVEL_2\") # This operation will be available only for users with the permission ROLE_LEVEL_1 or ROLE_LEVEL_2\n            builder.add_model(\n                User, \n                exclude_fields=('custom_pwd',), # Exclude this field on the builded ModelType\n                save_as_password=['custom_pwd',], # On create and update this field will be saved as a password\n                access_group=\"GROUP_LEVEL_2\", \n                access_by_operation={'delete_field': 'GROUP_LEVEL_1'}\n                ) # This operation will be available only for users with the permission ROLE_LEVEL_1 or ROLE_LEVEL_2 except delete_field operation only for users with the permission ROLE_LEVEL_1.\n            query_class = builder.build_schema_query()\n            mutation_class = builder.build_schema_mutation()\n            # Build your session operations\n            session_query, session_mutation = builder.build_session_schema()\n\n5. Create a main schema in a new file called `schema.py` on `my_project` folder. This file can be used to merge all queries and mutations from all apps builded with django_graphbox or just add your own queries and mutations.\n\n    .. code-block:: python3\n            \n            import graphene\n            from my_app.schema import query_class, mutation_class, session_query, session_mutation\n\n            class Query(query_class, session_query, graphene.ObjectType):\n                pass\n\n            class Mutation(mutation_class, session_mutation, graphene.ObjectType):\n                pass\n\n            schema = graphene.Schema(query=Query, mutation=Mutation)\n\n6. Add the schema on urls.py file.\n    \n        .. code-block:: python3\n                \n                from django.urls import path\n                from graphene_file_upload.django import FileUploadGraphQLView\n                from django.views.decorators.csrf import csrf_exempt\n                from .schema import schema\n\n                urlpatterns = [\n                    path('graphql/', csrf_exempt(FileUploadGraphQLView.as_view(graphiql=True, schema=schema))),\n                ]\n\n7. Run the server and try to access the GraphQL API. Session operations will be available called actualUser query and login mutation. Additionally you can see the operations will require a valid access token and will validate the user role and permissions as you configured.\n\nCustom filters, validators and internal resolvers\n--------------------------------------------------------------------------------\n\nDjango GraphBox Builder allows you to add custom filters and validators to the GraphQL schema.\nThis example assumes that you have two models called `User` and `Favorite` with the following fields:\n\n    .. code-block:: python3\n\n        class User(Model):\n            custom_uname = models.CharField(max_length=100)\n            custom_pwd = models.CharField(max_length=100)\n            custom_active = models.BooleanField(default=True)\n            role = models.CharField(max_length=100)\n\n        class Favorite(Model):\n            book_name = models.CharField(max_length=100)\n            book_author = models.CharField(max_length=100)\n            book_year = models.IntegerField()\n            user = models.ForeignKey(User, on_delete=models.CASCADE)\n\n1. You can add external filters for the Favorite query. External filters are parameters that will be provided by the client and will be used to filter the query. The filters are added to the `external_filters` dictionary on the add_model method like this:\n\n    .. code-block:: python3\n\n        builder.add_model(\n            Favorite,\n            external_filters={\n                {\n                    \"field_name\": \"book_name\", # The field name on the Favorite model\n                    \"param_name\": \"book_name\", # The parameter name on the query\n                    \"param_type\": graphene.String(required=True), # The parameter graphene type\n                }\n            }\n        )\n\n2. You can add internal filters for the Favorite query. Internal filters are callables that will be resolved on the query execution with the parameters of the query resolver. The filters are added to the `internal_filters` dictionary on the add_model method like this:\n    \n        .. code-block:: python3\n    \n            builder.add_model(\n                Favorite,\n                internal_filters={\n                    \"field_name\": \"user__id\", # The field name on the Favorite model\n                    \"resolver_filter\": session_manager.actual_user_attr_getter(field_name='id'), # This function of session_manager will return a function that return the id of the actual user\n                    \"on_return_none\": \"skip\", # If the function returns None, the filter will be skipped. If you want apply the filter like user__id__is_null=True, you can set this parameter to \"set__isnull\".\n                }\n            )\n\n        This will build the query allFavorite filtered by the actual user.\n\n3. Build operations with custom validators by operation for a customizable workflow. The validators callables need receive `info`, `model_instance`, `**kwargs` and must return a boolean.\n\n    .. code-block:: python3\n            \n            builder.add_model(\n                Favorite,\n                validators_by_operation={\n                    'create_field': {\n                        'validators':(\n                            session_manager.actual_user_comparer(actual_user_field='id', operator='=', model_field='user__id'), # This function of session_manager will return a function that compare the id of the actual user with the id of the user field of the Favorite model\n                            session_manager.actual_user_comparer(actual_user_field='role', operator='=', default_value='ROLE_LEVEL_1'), # This function of session_manager will return a function that compare the role of the actual user with the default value\n                        ),\n                        'connector': 'OR', # The connector between the validators. If you want to use AND, you can set this parameter to 'AND'.\n                    },\n                }\n            )\n        \n        The validators are evaluated recursively, this allows you to create complex validators replacing the callable function with other dict with the same structure.\n\n4. Build operations with internal resolvers for some fields of the model. For example to set the actual user as the owner of the Favorite. The resolver callables need receive `info`, `model_instance`, `**kwargs` and must return a value as the model field type.\n    \n    .. code-block:: python3\n                \n                builder.add_model(\n                    Favorite,\n                    internal_field_resolvers={\n                        'create_field': {\n                            'user': session_manager.actual_user_attr_getter(field_name='id'), # This function of session_manager will return a function that return the id of the actual user\n                        },\n                        'update_field': {\n                            'user': session_manager.actual_user_attr_getter(field_name='id'), # This function of session_manager will return a function that return the id of the actual user\n                        },\n                    }\n                )\n\n    Note that the ForeignKey fields need return the id of the related model.\n\n5. Build operations based on modify_permissions. For this example we will configure the User operations for allow create, update and delete to the actual user only if this has permission.\n\n    .. code-block:: python3\n                \n                builder.add_model(\n                    User,\n                    validators_by_operation={\n                        'create_field': {\n                            'validators':(\n                                session_manager.build_access_level_validator(model_field='role'), # This function of session_manager will return a function that compare the role of the actual user with the role of the User instance on the create operation\n                            ),\n                            'connector': 'OR', # The connector between the validators. If you want to use AND, you can set this parameter to 'AND'.\n                        },\n                        'update_field': {\n                            'validators':(\n                                session_manager.build_access_level_validator(model_field='role'), # This function of session_manager will return a function that compare the role of the actual user with the role of the User instance on the update operation\n                            ),\n                            'connector': 'OR', # The connector between the validators. If you want to use AND, you can set this parameter to 'AND'.\n                        },\n                        'delete_field': {\n                            'validators':(\n                                session_manager.build_access_level_validator(model_field='role'), # This function of session_manager will return a function that compare the role of the actual user with the role of the User instance on the delete operation\n                            ),\n                            'connector': 'OR', # The connector between the validators. If you want to use AND, you can set this parameter to 'AND'.\n                        },\n                    }\n                )\n            \n            SessionManager.build_access_level_validator(model_field='role') will return a function that will validate if the user_instance.role exists on the list of MODIFY_PERMISSIONS[actual_user.role].\n\nRelease Notes\n----------------------------\n\n    * Version 1.0.0: Initial release\n    * Version 1.0.1: Bug fixes\n    * Version 1.0.2: Bug fixes\n    * Version 1.0.3: Bug fixes\n    * Version 1.0.4: Bug fixes\n    * Version 1.0.5: Add support for exclude_fields_by_operation\n    * Version 1.0.6: Add support for Paginated Queries\n    * Version 1.0.7: Bug fixes\n    * Version 1.0.8: Fix required files on update operation\n    * Version 1.0.9: Bug fixes\n    * Version 1.0.10: Bug fixes\n    * Version 1.0.11: Bug fixes\n    * Version 1.0.12:\n        * Support for skip when None returning on internal_field_resolvers\n    * Version 1.0.13:\n        * Support for social login\n    * Version 1.0.14 - Version 1.0.17:\n        * Bug fixes on social login\n    * Version 1.0.18:\n        * Update documentation\n    * Version 1.0.19:\n        * Show internal error info on social login\n    * Version 1.0.20, Version 1.0.21:\n        * Bug fixes on social login\n    * Version 1.0.22:\n        * Security fixes on social login (CRITICAL)\n    * Version 1.0.23:\n        * Callbacks by operation\n    * Version 1.0.24:\n        * Bug fix None returning on internal_field_resolvers on update operation\n    * Version 1.0.25:\n        * Add kwargs_field support on session_manager.build_access_level_validator\n    * Version 1.0.26:\n        * Add support for moodle login\n    * Version 1.0.27:\n        * Bug fixes on moodle login\n    * Version 1.0.28:\n        * Change to list of dictionaries moodle_urls  as {url: '', token: ''}\n",
    "description_content_type": "",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://90horasporsemana.com",
    "keywords": "",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "django-graphbox",
    "package_url": "https://pypi.org/project/django-graphbox/",
    "platform": null,
    "project_url": "https://pypi.org/project/django-graphbox/",
    "project_urls": {
      "Homepage": "https://90horasporsemana.com"
    },
    "release_url": "https://pypi.org/project/django-graphbox/1.0.28/",
    "requires_dist": [
      "Django (>=3.2)",
      "graphene-django (>=2.15.0)",
      "graphene-file-upload (>=1.2.2)",
      "pyjwt (>=2.3.0)",
      "urllib3 (>=1.26.9)",
      "pillow (>=8.4.0)",
      "facebook-sdk (>=3.1.0)",
      "google-auth (>=1.6.3)",
      "moodlepy (>=0.22.2)"
    ],
    "requires_python": ">=3.6",
    "summary": "Package for easy building GraphQL API with Django",
    "version": "1.0.28",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 17336913,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "5202cd541c529b9094d0a286600031df2ff1f34b4322f8a5b09f107c0a76d6be",
        "md5": "c67b3b0210950ca63734c489c9409ade",
        "sha256": "5c353fb31cdd1c9c5a21f4ebdcb33f78a7bc963d78b7ce8a1662b676b09687b6"
      },
      "downloads": -1,
      "filename": "django_graphbox-1.0.28-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "c67b3b0210950ca63734c489c9409ade",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.6",
      "size": 20934,
      "upload_time": "2022-10-25T01:01:07",
      "upload_time_iso_8601": "2022-10-25T01:01:07.725554Z",
      "url": "https://files.pythonhosted.org/packages/52/02/cd541c529b9094d0a286600031df2ff1f34b4322f8a5b09f107c0a76d6be/django_graphbox-1.0.28-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "1e2457635625f85b0212b2dcb6bcce1d397be3e2d5cb657e7c7c4075e0a53271",
        "md5": "6164f1d0b82362543f77d6df836ad8f4",
        "sha256": "2b2873b2cbca10c078b1625325360db55470730cd59465561bff491a2c2a5ebf"
      },
      "downloads": -1,
      "filename": "django_graphbox-1.0.28.tar.gz",
      "has_sig": false,
      "md5_digest": "6164f1d0b82362543f77d6df836ad8f4",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.6",
      "size": 21932,
      "upload_time": "2022-10-25T01:01:11",
      "upload_time_iso_8601": "2022-10-25T01:01:11.106237Z",
      "url": "https://files.pythonhosted.org/packages/1e/24/57635625f85b0212b2dcb6bcce1d397be3e2d5cb657e7c7c4075e0a53271/django_graphbox-1.0.28.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}