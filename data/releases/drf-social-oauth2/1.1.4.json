{
  "info": {
    "author": "Wagner de Lima",
    "author_email": "waglds@gmail.com",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 4 - Beta",
      "Environment :: Web Environment",
      "Framework :: Django",
      "License :: OSI Approved :: MIT License",
      "Programming Language :: Python :: 3",
      "Topic :: Internet :: WWW/HTTP",
      "Topic :: Software Development :: Libraries :: Python Modules"
    ],
    "description": "DRF Social OAuth2\n===================================\n\n.. image:: https://badge.fury.io/py/drf-social-oauth2.svg\n    :target: https://badge.fury.io/for/py/drf-social-oauth2\n\nBuy Me A Coffee\n^^^^^^^^^^^^^^^\nIf you liked the project and would like to share a small contribution, please buy me a coffee:\n\n.. image:: https://cdn.buymeacoffee.com/buttons/v2/default-green.png\n    :alt: Buy Me A Coffee\n    :height: 60\n    :width: 270\n    :align: center\n    :target: https://www.buymeacoffee.com/wagnerdelima\n\n\nIntroduction\n^^^^^^^^^^^^\n\nThis module provides OAuth2 social authentication support for applications in Django REST Framework.\n\nThe aim of this package is to help set up social authentication for your REST API. It also helps setting up your OAuth2\nprovider.\n\nThis package relies on `python-social-auth <http://python-social-auth.readthedocs.io>`_ and\n`django-oauth-toolkit <https://django-oauth-toolkit.readthedocs.org>`_.\nYou should probably read their docs if you were to go further than what is done here.\nIf you have some hard time understanding OAuth2, you can read a simple explanation\n`here <https://aaronparecki.com/articles/2012/07/29/1/oauth2-simplified>`_.\n\nIf you would like to test out this framework but you do not want to spend time at setting it up\nin your local environment, you can visit my `facebook_setup <https://github.com/wagnerdelima/facebook_setup>`_ repo.\nIt contains all the configuration necessary for you to try. It's missing database configuration, however\nall you have to do is set up a database in the settings.py file. The facebook API client ID and client secret\nare also included, so don't worry.\n\nInstallation\n------------\n\nThis framework is published at the PyPI, install it with pip::\n\n    pip install drf_social_oauth2\n\n\nAdd the following to your ``INSTALLED_APPS``:\n\n.. code-block:: python\n\n    INSTALLED_APPS = (\n        ...\n        'oauth2_provider',\n        'social_django',\n        'drf_social_oauth2',\n    )\n\n\nInclude social auth urls to your urls.py:\n\n.. code-block:: python\n\n    from django.conf.urls import url\n\n    urlpatterns = patterns(\n        ...\n        url(r'^auth/', include('drf_social_oauth2.urls', namespace='drf'))\n    )\n\nFor versions of Django 4.0 or higher, use:\n\n.. code-block:: python\n\n    from django.urls import re_path\n\n    urlpatterns = patterns(\n        ...\n        re_path(r'^auth/', include('drf_social_oauth2.urls', namespace='drf'))\n    )\n\nAdd these context processors to your ``TEMPLATE_CONTEXT_PROCESSORS``:\n\n.. code-block:: python\n\n    TEMPLATE_CONTEXT_PROCESSORS = (\n        ...\n        'social_django.context_processors.backends',\n        'social_django.context_processors.login_redirect',\n    )\n\nNB: since Django version 1.8, the ``TEMPLATE_CONTEXT_PROCESSORS`` is deprecated, set the ``'context_processors'`` option\nin the ``'OPTIONS'`` of a DjangoTemplates backend instead:\n\n.. code-block:: python\n\n    TEMPLATES = [\n        {\n            ...\n            'OPTIONS': {\n                'context_processors': [\n                    ...\n                    'social_django.context_processors.backends',\n                    'social_django.context_processors.login_redirect',\n                ],\n            },\n        }\n    ]\n\n\nYou can then enable the authentication classes for Django REST Framework by default or per view (add or update the\n``REST_FRAMEWORK`` and ``AUTHENTICATION_BACKENDS`` entries in your settings.py)\n\n.. code-block:: python\n\n    REST_FRAMEWORK = {\n        ...\n        'DEFAULT_AUTHENTICATION_CLASSES': (\n            ...\n            # 'oauth2_provider.ext.rest_framework.OAuth2Authentication',  # django-oauth-toolkit < 1.0.0\n            'oauth2_provider.contrib.rest_framework.OAuth2Authentication',  # django-oauth-toolkit >= 1.0.0\n            'drf_social_oauth2.authentication.SocialAuthentication',\n        ),\n    }\n\n.. code-block:: python\n\n    AUTHENTICATION_BACKENDS = (\n        ...\n       'drf_social_oauth2.backends.DjangoOAuth2',\n       'django.contrib.auth.backends.ModelBackend',\n    )\n\n\nThe settings of this  app are:\n\n- ``DRFSO2_PROPRIETARY_BACKEND_NAME``: name of your OAuth2 social backend (e.g ``\"Facebook\"``), defaults to ``\"Django\"``\n- ``DRFSO2_URL_NAMESPACE``: namespace for reversing URLs\n- ``ACTIVATE_JWT``: If set to True the access and refresh tokens will be JWTed. Default is False.\n\nSetting Up a New Application\n----------------------------\n\nGo to Django admin and add a new Application with the following configuration:\n\n- ``client_id`` and ``client_secret`` should be left unchanged\n- ``user`` should be your superuser\n- ``redirect_uris`` should be left blank\n- ``client_type`` should be set to ``confidential``\n- ``authorization_grant_type`` should be set to ``'Resource owner password-based'``\n- ``name`` can be set to whatever you'd like\n\nThe installation is done, you can now test the newly configured application.\n\nIt is recommended that you read the docs from `python-social-auth` and `django-oauth-toolkit` if you would like to go\nfurther. If you want to enable a social backend (e.g. Facebook), check the docs of `python-social-auth` on\n`supported backends <http://python-social-auth.readthedocs.io/en/latest/backends/index.html#supported-backends>`_\nand `django-social-auth` on `backend configuration <http://python-social-auth.readthedocs.io/en/latest/configuration/django.html>`_.\n\n\nTesting the Setup\n-----------------\n\nNow that the installation is done, let's try out the various functionality.\nWe will assume for the following examples that the REST API is reachable on ``http://localhost:8000``.\n\n- Retrieve a token for a user using ``curl``::\n\n    curl -X POST -d \"client_id=<client_id>&client_secret=<client_secret>&grant_type=password&username=<user_name>&password=<password>\" http://localhost:8000/auth/token\n\n``<client_id>`` and ``<client_secret>`` are the keys generated automatically. you can find in the model Application you created.\n\n-  Refresh token::\n\n    curl -X POST -d \"grant_type=refresh_token&client_id=<client_id>&client_secret=<client_secret>&refresh_token=<your_refresh_token>\" http://localhost:8000/auth/token\n\n- Exchange an external token for a token linked to your app::\n\n    curl -X POST -d \"grant_type=convert_token&client_id=<client_id>&client_secret=<client_secret>&backend=<backend>&token=<backend_token>\" http://localhost:8000/auth/convert-token\n\n``<backend>`` here needs to be replaced by the name of an enabled backend (e.g. \"Facebook\"). Note that ``PROPRIETARY_BACKEND_NAME``\nis a valid backend name, but there is no use to do that here.\n``<backend_token>`` is for the token you got from the service utilizing an iOS app for example.\n\n- Revoke tokens:\n\n    Revoke a single token::\n\n        curl -X POST -d \"client_id=<client_id>&client_secret=<client_secret>&token=<your_token>\" http://localhost:8000/auth/revoke-token\n\n    Revoke all tokens for a user::\n\n        curl -H \"Authorization: Bearer <token>\" -X POST -d \"client_id=<client_id>\" http://localhost:8000/auth/invalidate-sessions\n\n\nAuthenticating Requests\n-----------------------\n\nAs you have probably noticed, we enabled a default authentication backend called ``SocialAuthentication``.\nThis backend lets you register and authenticate your users seamlessly with your REST API.\n\nThe class simply retrieves the backend name and token from the Authorization header and tries to authenticate the user\nusing the corresponding external provider. If the user was not yet registered on your app, it will automatically create\na new user for this purpose.\n\nExample authenticated request::\n\n    curl -H \"Authorization: Bearer <backend_name> <backend_token>\" http://localhost:8000/route/to/your/view\n\n\nIntegration Examples\n--------------------\n\nFor each authentication provider, the top portion of your REST API settings.py file should look like this:\n\n.. code-block:: python\n\n    INSTALLED_APPS = (\n        ...\n        # OAuth\n        'oauth2_provider',\n        'social_django',\n        'drf_social_oauth2',\n    )\n\n    TEMPLATES = [\n        {\n            ...\n            'OPTIONS': {\n                'context_processors': [\n                    ...\n                    # OAuth\n                    'social_django.context_processors.backends',\n                    'social_django.context_processors.login_redirect',\n                ],\n            },\n        }\n    ]\n\n    REST_FRAMEWORK = {\n        ...\n        'DEFAULT_AUTHENTICATION_CLASSES': (\n            ...\n            # OAuth\n            # 'oauth2_provider.ext.rest_framework.OAuth2Authentication',  # django-oauth-toolkit < 1.0.0\n            'oauth2_provider.contrib.rest_framework.OAuth2Authentication',  # django-oauth-toolkit >= 1.0.0\n            'drf_social_oauth2.authentication.SocialAuthentication',\n        )\n    }\n\nListed below are a few examples of supported backends that can be used for social authentication.\n\n\nFacebook Example\n^^^^^^^^^^^^^^^^\n\nTo use Facebook as the authorization backend of your REST API, your settings.py file should look like this:\n\n.. code-block:: python\n\n    AUTHENTICATION_BACKENDS = (\n        # Others auth providers (e.g. Google, OpenId, etc)\n        ...\n\n        # Facebook OAuth2\n        'social_core.backends.facebook.FacebookAppOAuth2',\n        'social_core.backends.facebook.FacebookOAuth2',\n\n        # drf_social_oauth2\n        'drf_social_oauth2.backends.DjangoOAuth2',\n\n        # Django\n        'django.contrib.auth.backends.ModelBackend',\n    )\n\n    # Facebook configuration\n    SOCIAL_AUTH_FACEBOOK_KEY = '<your app id goes here>'\n    SOCIAL_AUTH_FACEBOOK_SECRET = '<your app secret goes here>'\n\n    # Define SOCIAL_AUTH_FACEBOOK_SCOPE to get extra permissions from Facebook.\n    # Email is not sent by default, to get it, you must request the email permission.\n    SOCIAL_AUTH_FACEBOOK_SCOPE = ['email']\n    SOCIAL_AUTH_FACEBOOK_PROFILE_EXTRA_PARAMS = {\n        'fields': 'id, name, email'\n    }\n\nRemember to add this new Application in your Django admin (see section \"Setting up Application\").\n\nYou can test these settings by running the following command::\n\n    curl -X POST -d \"grant_type=convert_token&client_id=<client_id>&client_secret=<client_secret>&backend=facebook&token=<facebook_token>\" http://localhost:8000/auth/convert-token\n\nThis request returns the \"access_token\" that you should use with every HTTP request to your REST API. What is happening\nhere is that we are converting a third-party access token (``<user_access_token>``) to an access token to use with your\nAPI and its clients (\"access_token\"). You should use this token on each and further communications between your\nsystem/application and your api to authenticate each request and avoid authenticating with Facebook every time.\n\nYou can get the ID (``SOCIAL_AUTH_FACEBOOK_KEY``) and secret (``SOCIAL_AUTH_FACEBOOK_SECRET``) of your app at\nhttps://developers.facebook.com/apps/.\n\nFor testing purposes, you can use the access token ``<user_access_token>`` from https://developers.facebook.com/tools/accesstoken/.\n\nFor more information on how to configure python-social-auth with Facebook visit\nhttp://python-social-auth.readthedocs.io/en/latest/backends/facebook.html.\n\n\nGoogle Example\n^^^^^^^^^^^^^^\n\nTo use Google OAuth2 as the authorization backend of your REST API, your settings.py file should look like this:\n\n.. code-block:: python\n\n    AUTHENTICATION_BACKENDS = (\n        # Others auth providers (e.g. Facebook, OpenId, etc)\n        ...\n\n\t# Google OAuth2\n\t'social_core.backends.google.GoogleOAuth2',\n\n        # drf-social-oauth2\n        'drf_social_oauth2.backends.DjangoOAuth2',\n\n        # Django\n        'django.contrib.auth.backends.ModelBackend',\n    )\n\n    # Google configuration\n    SOCIAL_AUTH_GOOGLE_OAUTH2_KEY = <your app id goes here>\n    SOCIAL_AUTH_GOOGLE_OAUTH2_SECRET = <your app secret goes here>\n\n    # Define SOCIAL_AUTH_GOOGLE_OAUTH2_SCOPE to get extra permissions from Google.\n    SOCIAL_AUTH_GOOGLE_OAUTH2_SCOPE = [\n        'https://www.googleapis.com/auth/userinfo.email',\n        'https://www.googleapis.com/auth/userinfo.profile',\n    ]\n\nRemember to add the new Application in your Django admin (see section \"Setting up Application\").\n\nYou can test these settings by running the following command::\n\n    curl -X POST -d \"grant_type=convert_token&client_id=<django-oauth-generated-client_id>&client_secret=<django-oauth-generated-client_secret>&backend=google-oauth2&token=<google_token>\" http://localhost:8000/auth/convert-token\n\nThis request returns an \"access_token\" that you should use with every HTTP requests to your REST API.\nWhat is happening here is that we are converting a third-party access token (``<user_access_token>``)\nto an access token to use with your API and its clients (\"access_token\"). You should use this token on\neach and further communications between your system/application and your API to authenticate each request\nand avoid authenticating with Google every time.\n\nYou can get the ID (``SOCIAL_AUTH_GOOGLE_OAUTH2_KEY``) and secret (``SOCIAL_AUTH_GOOGLE_OAUTH2_SECRET``)\nof your app at https://console.developers.google.com/apis/credentials\nand more information on how to create one on https://developers.google.com/identity/protocols/OAuth2.\n\nFor testing purposes, you can use the access token ``<user_access_token>`` from\nhttps://developers.google.com/oauthplayground/.\n\nFor more information on how to configure python-social-auth with Google visit\nhttps://python-social-auth.readthedocs.io/en/latest/backends/google.html#google-oauth2.\n\n\nRunning local tests\n^^^^^^^^^^^^^^^^^^^\n\nYou may find drf-social-oauth2's unit tests in the tests/ directory. In order to run the tests locally, you can either\nuse pytest directly or coverage itself. Prior to running the test cases you need to install the local dependencies by:\n\n    $ pip3 install -r requirements.tests.txt\n\nThen you can just run pytest in your terminal:\n\n    $ pytest\n\nor call coverage to get the most updated test coverage:\n\n    $ coverage run --source='.' -m pytest && coverage html\n\n\nCustomize token expiration\n^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nYou can set the expiry time for tokens as follows:\n\n.. code-block:: python\n\n    # in your settings.py file.\n    from oauth2_provider import settings as oauth2_settings\n\n    # expires in 6 months\n    oauth2_settings.DEFAULTS['ACCESS_TOKEN_EXPIRE_SECONDS'] = 1.577e7\n\nRun Swagger Editor\n^^^^^^^^^^^^^^^^^^\n\nRun the Swagger Editor's and interact with the API:\n\nOn Mac and Linux:\n\n    $ docker run --rm -p 8080:8080 -v $(pwd):/tmp -e SWAGGER_FILE=/tmp/api.yaml swaggerapi/swagger-editor\n\nOn Windows:\n\n    $ docker run --rm -p 8080:8080 -v ${pwd}:/tmp -e SWAGGER_FILE=/tmp/api.yaml swaggerapi/swagger-editor\n\n\nWhat Am I Working Next?\n^^^^^^^^^^^^^^^^^^^^^^^\n\nI will be working on the issues below. Anyone is welcome to contribute.\n\n- `Add OAS for endpoints <https://github.com/wagnerdelima/drf-social-oauth2/issues/91>`_\n- `Prevent token recreation if they are still valid <https://github.com/wagnerdelima/drf-social-oauth2/issues/93>`_\n   - There is currently a Draft PR I opened in the django-oauth-toolkit: `<https://github.com/jazzband/django-oauth-toolkit/pull/1058>`_\n- `Dockerize test execution <https://github.com/wagnerdelima/drf-social-oauth2/issues/88>`_\n- `Add CI/CD for tests <https://github.com/wagnerdelima/drf-social-oauth2/issues/89>`_",
    "description_content_type": "",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/wagnerdelima/drf-social-oauth2",
    "keywords": "",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "drf-social-oauth2",
    "package_url": "https://pypi.org/project/drf-social-oauth2/",
    "platform": "",
    "project_url": "https://pypi.org/project/drf-social-oauth2/",
    "project_urls": {
      "Homepage": "https://github.com/wagnerdelima/drf-social-oauth2"
    },
    "release_url": "https://pypi.org/project/drf-social-oauth2/1.1.4/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "python-social-auth and oauth2 support for django-rest-framework",
    "version": "1.1.4",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 17550432,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "92fb2a10f69fc9582c2527e32a03bcdb7810c58e1ce36812d8a47538795c4763",
        "md5": "a111f87f64ef8bdfa7c25cb6dc6461a0",
        "sha256": "972aebe2093710685fbf29dccd1ed67a88406bf0f2b8da5d3968006a79d1ab81"
      },
      "downloads": -1,
      "filename": "drf-social-oauth2-1.1.4.tar.gz",
      "has_sig": false,
      "md5_digest": "a111f87f64ef8bdfa7c25cb6dc6461a0",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 20104,
      "upload_time": "2021-12-29T16:15:36",
      "upload_time_iso_8601": "2021-12-29T16:15:36.810386Z",
      "url": "https://files.pythonhosted.org/packages/92/fb/2a10f69fc9582c2527e32a03bcdb7810c58e1ce36812d8a47538795c4763/drf-social-oauth2-1.1.4.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}