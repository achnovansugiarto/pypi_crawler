{
  "info": {
    "author": "Marco Braak",
    "author_email": "mbraak@ridethepony.nl",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 5 - Production/Stable",
      "Framework :: Django",
      "Framework :: Django :: 2.2",
      "Framework :: Django :: 3.0",
      "Framework :: Django :: 3.1",
      "Intended Audience :: Developers",
      "License :: OSI Approved :: Apache Software License",
      "Programming Language :: Python :: 3.6",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Programming Language :: Python :: Implementation :: CPython"
    ],
    "description": "[![Build Status](https://travis-ci.org/mbraak/django-file-form.svg?branch=master)](https://travis-ci.org/mbraak/django-file-form) [![Version](https://badge.fury.io/py/django-file-form.svg)](https://pypi.python.org/pypi/django-file-form/)\n\n[![Coverage Status](https://img.shields.io/coveralls/mbraak/django-file-form.svg)](https://coveralls.io/r/mbraak/django-file-form?branch=master)\n[![Requirements Status](https://requires.io/github/mbraak/django-file-form/requirements.svg?branch=master)](https://requires.io/github/mbraak/django-file-form/requirements/?branch=master)\n\n[![License](https://img.shields.io/pypi/l/django-file-form.svg)](https://pypi.python.org/pypi/django-file-form/)\n\n# Django file form\n\n**Django-file-form** helps you to write forms with a pretty ajax upload.\n\nFeatures:\n\n* You can easily add an ajax file-upload to a form.\n* The ajax upload works the same as an html upload.\n    * This means that you don't have to change your code to support ajax upload.\n* Supports single and multiple file upload.\n* Supports edition of uploaded files.\n* Supports upload directly to AWS S3 compatible storages.\n* Supports frontend events for the addition and removal of files.\n* Supports addition of arbitrary file meta data and related widgets.\n\nThe project is hosted on [github](https://github.com/mbraak/django-file-form).\n\nWorks with Django 2.2 - 3.1. Also with Python 3.6 - 3.8\n\nOlder versions:\n* 2.2 supports Django 2.0 and 2.2\n* 1.0.1 uses fine uploader for the javascript part\n* 0.5.0 supports Django 1.11 and Python 2.\n\nVersion 2.0 has changed: see 'Upgrade from version 1.0' below, if you're upgrading from version 1.0 (or lower).\n\n## Usage\n\n**1 Install django-file-form**\n\n```\npip install django-file-form\n```\n\n**2 Add the apps to your INSTALLED_APPS**\n\nYou must include 'django_file_form'\n\n```python\nINSTALLED_APPS = [\n    'django_file_form',\n]\n```\n\n**3 Add the app to your urls**\n\nIn this example we use the url **upload/**. You can use a different url if you like.\n\n```python\nurlpatterns = patterns(\n    '',\n    url(r'^upload/', include('django_file_form.urls')),\n)\n```\n\n**4 Add FileFormMixin to your form**\n\n```python\nfrom django_file_form.forms import FileFormMixin\n\nclass ExampleForm(FileFormMixin, forms.Form):\n    pass\n```\n\n**5 Add a UploadedFileField**\n\n```python\nfrom django_file_form.forms import FileFormMixin, UploadedFileField\n\nclass ExampleForm(FileFormMixin, forms.Form):\n    input_file = UploadedFileField()\n```\n\nImport and use `MultipleUploadedFileField` if you intent to add multiple files.\n\n**6 Include javascript and css in your template**\n\n```js\n<script src=\"{% static \"file_form/file_form.js\" %}\"></script>\n<link rel=\"stylesheet\" href=\"{% static \"file_form/file_form.css\" %}\">\n```\n\nThere is also an uncompressed javascript version: `file_form/file_form.debug.js`.\n\n**7 Call the initUploadFields javascript function**\n\n```html\n<form id=\"example-form\" method=\"POST\" enctype=\"multipart/form-data\">\n    {% csrf_token %}\n    {{ form }}\n</form>\n\n<script>\n   initUploadFields(\n      document.getElementById(\"example-form\")\n   );\n</script>\n```\n\nIf your form has a prefix, then call `initUploadFields` as follows:\n\n```js\n  // for example, with prefix 'abc'\n  initUploadFields(\n    document.getElementById(\"example-form\"),\n    { prefix: 'abc' }\n  );\n```\n\nSee the [Django documentation](https://docs.djangoproject.com/en/2.1/ref/forms/api/#prefixes-for-forms) for more information about form prefixes.\n\n**8 Handle uploaded files**\n\n```python\nclass ExampleFormView(generic.FormView):\n    template_name = 'example_form.html'\n    form_class = forms.ExampleForm\n\n    def form_valid(self, form):\n        input_file = form.cleaned_data['input_file']\n\n        return super(ExampleFormView, self).form_valid(form)\n```\n\n**9 Delete temporary files**\n\n```python\nclass ExampleFormView(generic.FormView):\n    template_name = 'example_form.html'\n    form_class = forms.ExampleForm\n\n    def form_valid(self, form):\n        input_file = form.cleaned_data['input_file']\n\n        form.delete_temporary_files()\n\n        return super(ExampleFormView, self).form_valid(form)\n```\n\n## Details\n\n**1 Include hidden fields**\n\nMake sure that hidden form fields are included:\n\n```python\n{% for hidden in form.hidden_fields %}\n    {{ hidden }}\n{% endfor %}\n```\n\nNB: it's possible that the hidden fields are already included; for example if you use ``form.as_p``. Do not include the hidden fields twice.\n\nAlso see the testproject in the repository.\n\n**2 Temp upload dir must exist**\n\nMake sure the `FILE_FORM_UPLOAD_DIR` directory exists.\n\n```python\ntemp_upload_dir = os.path.join(settings.MEDIA_ROOT,  settings.FILE_FORM_UPLOAD_DIR)\n\nif not os.path.exists(temp_upload_dir):\n  os.mkdir(temp_upload_dir)\n```\n\n**3 Adding placeholder files**\n\nIf you have used `django-file-form` to upload files, potentially have saved the files elsewhere, but would like to use `django-file-form` to edit (remove or replace) the original uploaded files and append new files, you can add information about the original uploaded files as placeholders to the `UploadedFileField`. More specifically, you can initialize your field with one or more `PlaceholderUploadedFile` as follows:\n\n```python\nfrom django_file_form.models import PlaceholderUploadedFile\n\ninitial['my_field'] = [\n  PlaceholderUploadedFile('testfile1.png')\n]\n```\n\nYou can also add options `size` and `file_id` to specify file size if the file does not exist locally, and an unique ID of the file, respectively.\n\n```python\ninitial['my_field'] = [\n  PlaceholderUploadedFile('testfile1.png', size=12394, file_id=my_file.pk)\n]\n```\n\nThe placeholder file will be listed, and will either be kept intact, or be removed. When you save the form, you will have to handle the placeholders as follows:\n\n```python\nfor f in self.cleaned_data['my_field']:\n    if f.is_placeholder:\n        # do nothing, or something with f.name or f.file_id\n        continue\n    # handle newly uploaded files as usual\n\n# remove existing files if the placeholders are deleted\n# ...\n```\n\n**4 Upload directly to AWS S3**\n\n`django-file-form` supports upload directly to AWS S3 compatible storages. The files will be uploaded\nby clients directly to S3 through AJAX operations and return to the backend as `File` objects\nwith [`S3Boto3Storage`](https://django-storages.readthedocs.io/en/latest/backends/amazon-S3.html).\n\nTo use this method, you will first need to make sure your S3 bucket is configured\nto [allow upload to bucket directly](https://docs.aws.amazon.com/AmazonS3/latest/dev/cors.html),\n[allow `PUT` method, and expose `ETag` header](https://uppy.io/docs/aws-s3-multipart/#S3-Bucket-Configuration).\nYou then need to define the following variables in `settings`\n\n```\nAWS_ACCESS_KEY_ID\nAWS_SECRET_ACCESS_KEY\nAWS_STORAGE_BUCKET_NAME\nAWS_S3_REGION_NAME\nAWS_S3_ENDPOINT_URL\n```\n\nor through environment variables with the same names as described\nin [`django-storage` documentation](https://django-storages.readthedocs.io/en/latest/backends/amazon-S3.html).\n\nThe following CORS settings are also needed in `settings`\n```\nCSP_DEFAULT_SRC = (\"'none'\",)\nCSP_STYLE_SRC = (\"'self'\")\nCSP_SCRIPT_SRC = (\"'self'\",)\nCSP_FONT_SRC = (\"'self'\")\nCSP_IMG_SRC = (\"'self'\",)\nCSP_CONNECT_SRC = (\"'self'\", AWS_S3_ENDPOINT_URL)\n```\nwhere `AWS_S3_ENDPOINT_URL` is the AWS endpoint defined above.\n\nFinally, you will need to define\n\n  ```\n  s3_upload_dir = \"user_or_form_specific_id\"\n  ```\n\nin the form class or passed parameter `s3_upload_dir` to the constructor of the\nform to inform the frontend to use the AJAX uploader for S3. The files will be\nuploaded to\n\n```\n${FILE_FORM_UPLOAD_DIR}/${s3_upload_dir}/\n````\n\nin the specified S3 bucket, where `s3_upload_dir` can be empty or a directory\nspecific to user or form to avoid conflicts on the AWS side. If the object\nalready exists in the S3 bucket, a random string will be added to filename.\n\nAfter form submission, the files will be returned as customized `S3Boto3StorageFile`\nobjects  with `S3Boto3Storage` as its underlying storage. The objects will have attributes\n`is_s3direct=True`,  `is_placeholder=False`, and `original_name` which is the\nname of the file that was uploaded that can be different from the basename\nof the object on S3 (`f.name`). Reading from these objects will download the files\nfrom S3.\n\n**5 Accept attribute**\n\nYou can add an accept attribute to the file input using the `accept` parameter on `UploadedFileField`:\n\n```\nfile = UploadedFileField(accept='image/*,.pdf')\n```\n\n**6 Additional file metadata**\n\nIf you want to add and maintain additional metadata such as short descriptions and\ncategories of uploaded files, you can use the `.metadata` field of uploaded files.\nMore specifically, the AJAX uploader has a hidden field called `metadata` (with form\nspecific prefix) with its `data` being the `JSON.dump`ed meta data of all files. The\ndata should be in the format of\n\n   ```\n   {\n      'filename1': value1,\n      'filename2': value2\n   }\n   ```\n\nTo add metadata to uploaded files, you will need to listen to events triggered after the\nadditional and removal of file list (see \"Javascript events\" for details) to add your own\nwidgets and event handlers to update the `data` of this hidden field.\n\nUpon form submission, `django-file-form` retrieves the data and assign them to returned file\nobjects with matching filename (could be of placeholder and other types) as `f.metadata`.\n\n\n## Upgrade from version 1.0 (to 2.0)\n\n* Add reference to file_form/file_form.css:\n  * `<link rel=\"stylesheet\" href=\"{% static \"file_form/file_form.css\" %}\">`\n* Remove `django_file_form.ajaxuploader` from `INSTALLED_APPS` in your settings\n* Remove reference to `ajaxuploader/js/fileuploader.js` in your template\n* Remove reference to `ajaxuploader/css/fileuploader.css` in your template\n* You don't have to include jquery; the fileuploader doesn't use it\n* The setting `FILE_FORM_UPLOAD_BACKEND` is removed\n* If you use custom css, you might have to change it.\n  * The html uses the prefix `dff` now.\n\n## Settings\n\nSettings in `settings.py`:\n\n* **FILE_FORM_MUST_LOGIN** (True / False):\n  * Must the user be logged in to upload a file.\n  * The default is `False`.\n\n* **FILE_FORM_UPLOAD_DIR** (string):\n  * The directory for the temporary uploads.\n  * The setting is relative to `MEDIA_ROOT`.\n  * The default is `temp_uploads`.\n\n* **FILE_FORM_MAX_FILE_SIZE** (int)\n  * Maximum upload size in bytes\n  * Default is 4GB\n\n* **FILE_FORM_FILE_STORAGE** (string):\n  * Dotted path to the class that is used to store temporary uploads.\n  * The default is `django.core.files.storage.FileSystemStorage`.\n  * Note that files will be uploaded to the local file system first regardless. This storage backend will be used only for fully uploaded files that are then passed back to the form when it's submitted.\n\n* **FILE_FORM_CACHE** (string):\n  * Name of a cache backend defined in `settings.CACHES`.\n  * The default is Django's `default` cache.\n  * The cache is used to store data about files while they are being uploaded. If the default might be cleared while a file upload is in progress then using a different backend like django's database cache might be more appropriate. Note that `cache.clear()` will clear the whole cache at a specified `LOCATION` regardless what the `KEY_PREFIX` is.\n\n## initUploadFields\n\nSignature of `initUploadFields` is:\n\n```\ninitUploadFields(formDomElement, options);\n```\n\n* `formDomElement` (required); e.g. `document.getElementById(\"example-form\")`\n* options (optional)\n  * `callbacks`: callbacks for things like upload progress and errors.\n  * `chunkSize`: the maximum size of an upload. Default is 2.5 MB.\n    * Note that Django limits the size of a request. See https://docs.djangoproject.com/en/3.1/ref/settings/#data-upload-max-memory-size.\n  * `eventEmitter`: experimental api for events. See 'Javascript events' section below\n  * `prefix`: set this if the Django form has a prefix; default is empty\n  * `retryDelays`: set retry delays\n    * Also see `https://github.com/tus/tus-js-client#tusdefaultoptions`\n    * Default is `[0, 1000, 3000, 5000]`\n  * `skipRequired` : don't set the `required` field of the file input; default is `false`\n  * `supportDropArea` : add a drop area; default is `true`\n\nThe callbacks are:\n  * `onDelete`\n    * called when file is deleted\n    * Signature of callback is `function(upload)`\n  * `onError`:\n    * called when an upload error occurs\n    * Signature of callback is `function(error, upload)`\n      * `error`: javascript Error\n  * `onProgress`:\n    * Called each time when progress information is available.\n    * Signature of callback is `function(bytesUploaded, bytesTotal, upload)`\n  * `onSuccess`:\n    * Called when file upload is done.\n    * Signature of callback is `function(upload)`\n\nThe callbacks receive an `upload` parameter which is [this class](https://github.com/tus/tus-js-client#new-tusuploadfile-options).\n\nExamples:\n\n```js\ninitUploadFields(\n  document.getElementById(\"example-form\")\n);\n```\n\n```js\ninitUploadFields(\n  document.getElementById(\"example-form\"),\n  {\n    prefix: \"example\",\n    skipRequired: true,\n    supportDropArea: true\n  }\n);\n```\n\n## Form sets\n\nYou can also use a form set instead of a form. In that case `initFormSet` (instead of `initUploadFields`)\nin your javascript code.\n\n```\ninitFormSet(form_element, options)\n```\n\n```js\ninitFormSet(\n  document.getElementById(\"example-form\"),\n  { prefix: \"form\" }\n);\n```\n\n* Note that the default form set prefix is `form`.\n* Also see the `testproject` directory in the repository for an example.\n\n## Translate\n\nTo update a translation or add new language\n\nFork this repo as usual\n\n```shell\n# enter in project folder\ncd django-file-form\n\n# create virtualenv (example using pipenv)\npipenv install --python=3 -r testproject/requirements.txt\n\n# enter in venv shell\npipenv shell\n\n# update po file for your language\ndjango-admin makemessages -l fr\n```\n\nYou can now edit generated po file and commit your changes as usual\n\n## Javascript events\n\nThere are javascript events for adding and removing an upload. The events are `addUpload`, `removeUpload`,\nand `uploadComplete`.\n\n```js\nimport EventEmitter from 'eventemitter3';\n\nconst eventEmitter = new EventEmitter();\n\neventEmitter.on('addUpload', ({ element, fieldName, fileName, metaDataField, upload }) => {\n  //\n});\n\neventEmitter.on('removeUpload', ({ element, fieldName, fileName, metaDataField, upload }) => {\n  //\n});\n\neventEmitter.on('uploadComplete', ({ element, fieldName, fileName, metaDataField, upload }) => {\n  //\n});\n\n\ninitUploadFields(\n    document.getElementById(\"example-form\"),\n    {\n      eventEmitter,\n    }\n);\n```\n\n* You need the `eventemitter3` package to use this.\n* The `metaDataField` is the metadata input. See 'Additional file metadata' in this document.\n* This api is experimental.\n\n## Changelog\n* **3.1.0 (15 september 2020)**\n  * Issue #324: get placeholder file for UploadWidget (thanks to Shrikrishna Singh)\n  * Issue #330: allow upload directly to S3 compatible storages (thanks to Bo Peng)\n  * Issue #331: fix error in deleting files (thanks to Bo Peng)\n  * Issue #333: replace existing uploaded file with the same name (thanks to Bo Peng)\n  * Issue #341: add javascript events (experimental)\n  * Issue #346: allow define s3_upload_dir in form class (thanks to Bo Peng)\n\n* **3.0.1 (4 september 2020)**\n  * Issue #347: add chunkSize parameter to avoid request error in Django\n\n* **3.0.0 (6 august 2020)**\n  * Issue #320: fix UploadMultipleWidget to return correct placeholder files (thanks to Shrikrishna Singh)\n  * Issue #325: support Django 3.1\n\n* **2.2.0 (22 july 2020)**\n  * Issue #315: file is not removed after form error\n  * Issue #313: allow using custom storage and custom cache (thanks to Balazs Endresz)\n\n* **2.1.3 (20 june 2020)**\n  * Issue #304: rewrite frontend in typescript\n  * Issue #305: don't change migration when setting changes (thanks to Lionqueen94)\n  * Issue #307: add French translations; also make translations discoverable by makemessages (thanks to Simon Maillard)\n\n* **2.1.2 (20 april 2020)**\n  * Issue #298: directory support for drop area\n  * Issue #300: add migration so makemigrations will not create one (thanks to Lionqueen94)\n\n* **2.1.1 (7 april 2020)**\n  * Issue #290: add javascript callbacks (thanks to Peter Dekkers)\n  * Issue #296: fix progress bar\n  * Issue #297: add retry delays\n\n* **2.1.0 (28 march 2020)**\n  * Issue #266: allow relative `FILE_FORM_UPLOAD_DIR` setting (thanks to Bo Peng)\n  * Issue #267: add drop area (thanks to Bo Peng)\n  * Issue #275: show size of uploaded files (thanks to Bo Peng)\n  * Issue #278: allow the addition of placeholder files (thanks to Bo Peng)\n  * Issue #280: remove option `FILE_FORM_FILE_STORAGE`\n\n* **2.0.3 (15 february 2020)**\n  * Issue #237: using with form set (thanks to Juan Carlos Carvajal)\n  * Issue #259: include uncompressed js\n  * Issue #260: correctly use formset prefix (thanks to Gzuba)\n  * Issue #261: fix default for `FILE_FORM_UPLOAD_DIR` (thanks to Gzuba)\n\n* **2.0.2 (14 january 2020)**\n  * Issue #247: support form wizard (thanks to Lionqueen94)\n  * Issue #251: delete after submit\n\n* **2.0.1 (6 january 2020)**\n  * Issue #240: add empty dff files div (thanks to Lionqueen94)\n  * Issue #241: Csp compliance (thanks to Lionqueen94)\n\n* **2.0 (30 december 2019)**\n  * Use tus instead of fine uploader\n\n* **1.0 (5 december 2019)**\n  * Drop support for Python 2 and Django < 2\n  * Issue #217: update fine uploader\n  * Issue #219: use `Selenium` for all tests\n  * Issue #222: use `pathlib2` (instead of pathlib)\n  * Issue #235: support Django 3.0\n\n* **0.4.2 (3 March 2019)**\n  * Issue #207: support form prefixes (thanks to Iw108)\n  * Issue #201: fix multiple file upload without ajax (thanks to Lionqueen94)\n\n* **0.4.1 (5 January 2019)**\n  * Issue #194: correctly call `is_authenticated` (thanks to Dureba)\n\n* **0.4.0 (3 August 2018)**\n  * Support Django 2.1 and Python 3.7\n  * Issue #173: add i18n to upload widget (thanks to Arman Roomana)\n\n* **0.3.0 (6 December 2017)**\n  * Support Django 2.0\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/mbraak/django-file-form",
    "keywords": "",
    "license": "Apache License, Version 2.0",
    "maintainer": "",
    "maintainer_email": "",
    "name": "django-file-form",
    "package_url": "https://pypi.org/project/django-file-form/",
    "platform": "",
    "project_url": "https://pypi.org/project/django-file-form/",
    "project_urls": {
      "Homepage": "https://github.com/mbraak/django-file-form"
    },
    "release_url": "https://pypi.org/project/django-file-form/3.1.0/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "Django-file-form helps you to write forms with a pretty ajax upload",
    "version": "3.1.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 16615564,
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "53af4133f7e9ec4dd1c2a26f561590b58d0456c1420a5eeb4bc67a5a681f8bbb",
        "md5": "e1c565bbf986bae766dffb8525d94f57",
        "sha256": "6b9db51dc2780fe5a65b1d6fab2ade84d908599315f46f2371cb4fb79acd8603"
      },
      "downloads": -1,
      "filename": "django_file_form-3.1.0-py3.8.egg",
      "has_sig": false,
      "md5_digest": "e1c565bbf986bae766dffb8525d94f57",
      "packagetype": "bdist_egg",
      "python_version": "3.8",
      "requires_python": null,
      "size": 321481,
      "upload_time": "2020-09-15T12:06:41",
      "upload_time_iso_8601": "2020-09-15T12:06:41.950788Z",
      "url": "https://files.pythonhosted.org/packages/53/af/4133f7e9ec4dd1c2a26f561590b58d0456c1420a5eeb4bc67a5a681f8bbb/django_file_form-3.1.0-py3.8.egg",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "8db23fb31dab5b08155199aea93459384ab908f28706b91972d28d13fb3e0d49",
        "md5": "e89e6d28bead4708a40d0ff30396c2f6",
        "sha256": "989569be86fa067cf1ec4cd300eefb505c773f3ecd9e56949124647b3879a937"
      },
      "downloads": -1,
      "filename": "django_file_form-3.1.0-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "e89e6d28bead4708a40d0ff30396c2f6",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": null,
      "size": 323064,
      "upload_time": "2020-09-15T12:06:38",
      "upload_time_iso_8601": "2020-09-15T12:06:38.414065Z",
      "url": "https://files.pythonhosted.org/packages/8d/b2/3fb31dab5b08155199aea93459384ab908f28706b91972d28d13fb3e0d49/django_file_form-3.1.0-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "6528af6838b9d91fab24a0820e9584e69ffee22250b01a9f0f5ddd7868e7d114",
        "md5": "c64e4bc9e410323fa3e506f740c9dcb4",
        "sha256": "6ad3319d076b8642dbe3558474fa718597237d489870805824cf4ed33787c720"
      },
      "downloads": -1,
      "filename": "django-file-form-3.1.0.tar.gz",
      "has_sig": false,
      "md5_digest": "c64e4bc9e410323fa3e506f740c9dcb4",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 322067,
      "upload_time": "2020-09-15T12:06:40",
      "upload_time_iso_8601": "2020-09-15T12:06:40.226168Z",
      "url": "https://files.pythonhosted.org/packages/65/28/af6838b9d91fab24a0820e9584e69ffee22250b01a9f0f5ddd7868e7d114/django-file-form-3.1.0.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}