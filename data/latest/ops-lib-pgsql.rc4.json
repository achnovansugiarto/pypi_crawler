{
  "info": {
    "author": "Stuart Bishop",
    "author_email": "stuart.bishop@canonical.com",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 5 - Production/Stable",
      "License :: OSI Approved :: GNU Lesser General Public License v3 (LGPLv3)",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3 :: Only",
      "Programming Language :: Python :: 3.6",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Programming Language :: Python :: 3.9"
    ],
    "description": "Juju Operator Framework Charm Interface for PostgreSQL Relations\n================================================================\n\n[![PyPI version](https://badge.fury.io/py/ops-lib-pgsql.svg)](https://badge.fury.io/py/ops-lib-pgsql)\n[![PyPI Supported Python Versions](https://img.shields.io/pypi/pyversions/ops-lib-pgsql.svg)](https://pypi.python.org/pypi/ops-lib-pgsql/)\n[![GitHub license](https://img.shields.io/github/license/canonical/ops-lib-pgsql)](https://github.com/canonical/ops-lib-pgsql/blob/master/LICENSE)\n[![GitHub Actions (Tests)](https://github.com/canonical/ops-lib-pgsql/workflows/Tests/badge.svg)](https://github.com/canonical/ops-lib-pgsql/actions?query=workflow%3ATests)\n\n\nTo use this interface in your\n[Juju Operator Framework](https://github.com/canonical/operator) charm,\ninstruct [charmcraft](https://github.com/canonical/charmcraft) to embed\nit into your built Operator Framework charm by adding ops-lib-pgsql to\nyour `requirements.txt` file::\n\n```\nops\nops-lib-pgsql\n```\n\nYour charm needs to declare its use of the interface in its `metadata.yaml` file:\n\n```yaml\nrequires:\n  db:\n    interface: pgsql\n    limit: 1  # Most charms only handle a single PostgreSQL Application.\n```\n\n\nYour charm needs to bootstrap it and handle events:\n\n```python\npgsql = ops.lib.use(\"pgsql\", 1, \"postgresql-charmers@lists.launchpad.net\")\n\n\nclass MyCharm(ops.charm.CharmBase):\n    _state = ops.framework.StoredState()\n\n    def __init__(self, *args):\n        super().__init__(*args)\n        self._state.set_default(db_conn_str=None, db_uri=None, db_ro_uris=[])\n        self.db = pgsql.PostgreSQLClient(self, 'db')  # 'db' relation in metadata.yaml\n        self.framework.observe(self.db.on.database_relation_joined, self._on_database_relation_joined)\n        self.framework.observe(self.db.on.master_changed, self._on_master_changed)\n        self.framework.observe(self.db.on.standby_changed, self._on_standby_changed)\n\n    def _on_database_relation_joined(self, event: pgsql.DatabaseRelationJoinedEvent):\n        if self.model.unit.is_leader():\n            # Provide requirements to the PostgreSQL server.\n            event.database = 'mydbname'  # Request database named mydbname\n            event.extensions = ['citext']  # Request the citext extension installed\n        elif event.database != 'mydbname':\n            # Leader has not yet set requirements. Defer, incase this unit\n            # becomes leader and needs to perform that operation.\n            event.defer()\n            return\n\n    def _on_master_changed(self, event: pgsql.MasterChangedEvent):\n        if event.database != 'mydbname':\n            # Leader has not yet set requirements. Wait until next event,\n            # or risk connecting to an incorrect database.\n            return\n\n        # The connection to the primary database has been created,\n        # changed or removed. More specific events are available, but\n        # most charms will find it easier to just handle the Changed\n        # events. event.master is None if the master database is not\n        # available, or a pgsql.ConnectionString instance.\n        self._state.db_conn_str = None if event.master is None else event.master.conn_str\n        self._state.db_uri = None if event.master is None else event.master.uri\n\n        # You probably want to emit an event here or call a setup routine to\n        # do something useful with the libpq connection string or URI now they\n        # are available.\n\n    def _on_standby_changed(self, event: pgsql.StandbyChangedEvent):\n        if event.database != 'mydbname':\n            # Leader has not yet set requirements. Wait until next event,\n            # or risk connecting to an incorrect database.\n            return\n\n        # Charms needing access to the hot standby databases can get\n        # their connection details here. Applications can scale out\n        # horizontally if they can make use of the read only hot\n        # standby replica databases, rather than only use the single\n        # master. event.stanbys will be an empty list if no hot standby\n        # databases are available.\n        self._state.db_ro_uris = [c.uri for c in event.standbys]\n```\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/canonical/ops-lib-pgsql",
    "keywords": "juju charm opslib postgres postgresql pgsql",
    "license": "",
    "maintainer": "PostgreSQL Charmers",
    "maintainer_email": "postgresql-charmers@lists.launchpad.net",
    "name": "ops-lib-pgsql",
    "package_url": "https://pypi.org/project/ops-lib-pgsql/",
    "platform": "",
    "project_url": "https://pypi.org/project/ops-lib-pgsql/",
    "project_urls": {
      "Homepage": "https://github.com/canonical/ops-lib-pgsql",
      "Juju": "https://juju.is/",
      "Juju Operator Framework": "https://pypi.org/project/ops/"
    },
    "release_url": "https://pypi.org/project/ops-lib-pgsql/1.4/",
    "requires_dist": [
      "ops (>=0.8.0)",
      "PyYAML",
      "pgconnstr"
    ],
    "requires_python": ">=3.6",
    "summary": "PostgreSQL database relation for Juju Operator Framework Charms",
    "version": "1.4",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 9372506,
  "releases": {
    "1.0.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "7f7ea2a6f86518eb310e91bfda5c05faca9df60b48f765f9ee8cc2a33801dea9",
          "md5": "349e5435a573af4430057469c39d0266",
          "sha256": "869fd17fd33435dae6b7e562d585e232a25e34230eb511cd8a2f82825a0e163e"
        },
        "downloads": -1,
        "filename": "ops_lib_pgsql-1.0.0-py2.py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "349e5435a573af4430057469c39d0266",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "requires_python": ">=3.6",
        "size": 22543,
        "upload_time": "2020-08-25T03:45:58",
        "upload_time_iso_8601": "2020-08-25T03:45:58.995388Z",
        "url": "https://files.pythonhosted.org/packages/7f/7e/a2a6f86518eb310e91bfda5c05faca9df60b48f765f9ee8cc2a33801dea9/ops_lib_pgsql-1.0.0-py2.py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "b169cf0e5ebee8b4c4f29e47339a5608cd273b54cae7774dbd24f1480d0dca8a",
          "md5": "7076df3b4ce8e6780a296f9d5b306441",
          "sha256": "1eedf0d4d77fccadb7d6b6b6d56d84e9fae04d20aad30544b3ae95baccffb656"
        },
        "downloads": -1,
        "filename": "ops-lib-pgsql-1.0.0.tar.gz",
        "has_sig": false,
        "md5_digest": "7076df3b4ce8e6780a296f9d5b306441",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 11630,
        "upload_time": "2020-08-24T14:34:10",
        "upload_time_iso_8601": "2020-08-24T14:34:10.538942Z",
        "url": "https://files.pythonhosted.org/packages/b1/69/cf0e5ebee8b4c4f29e47339a5608cd273b54cae7774dbd24f1480d0dca8a/ops-lib-pgsql-1.0.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "3b0c2b518c8563219fe4e26854e988a8669deedec9ddb0b41ff801116fdff369",
          "md5": "4d61448ed2f585ccbcb93c0c3af24ed0",
          "sha256": "6f1b4ae5ce8edb7edc651dbd6937491555ea7e4ae49e405d244f860de90f0647"
        },
        "downloads": -1,
        "filename": "ops_lib_pgsql-1.1-py2.py3-none-any.whl",
        "has_sig": true,
        "md5_digest": "4d61448ed2f585ccbcb93c0c3af24ed0",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "requires_python": ">=3.6",
        "size": 20477,
        "upload_time": "2020-10-19T03:16:08",
        "upload_time_iso_8601": "2020-10-19T03:16:08.325630Z",
        "url": "https://files.pythonhosted.org/packages/3b/0c/2b518c8563219fe4e26854e988a8669deedec9ddb0b41ff801116fdff369/ops_lib_pgsql-1.1-py2.py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "6bf6f5464ae64f0185227073bac1a4b58f5604b9c61cd5b38ee5ba6b0fe1f200",
          "md5": "763c9e6a6444d61ef9da5ab653856ab8",
          "sha256": "b9edad70d84edd789e494fcb0844f71fd0a26f3995281138594e122d11c5c34d"
        },
        "downloads": -1,
        "filename": "ops-lib-pgsql-1.1.zip",
        "has_sig": true,
        "md5_digest": "763c9e6a6444d61ef9da5ab653856ab8",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 24307,
        "upload_time": "2020-10-19T03:16:10",
        "upload_time_iso_8601": "2020-10-19T03:16:10.164024Z",
        "url": "https://files.pythonhosted.org/packages/6b/f6/f5464ae64f0185227073bac1a4b58f5604b9c61cd5b38ee5ba6b0fe1f200/ops-lib-pgsql-1.1.zip",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "318c03019f48522f9002d6423b96c31cc2edb50f8d7ffbe3bccc48a2f63c4077",
          "md5": "7b153c739c3bfea2e7a85af1383dc360",
          "sha256": "883eb83b562a063ef63df17e3cb0116687d7771446f44fad0b08183be4e7be98"
        },
        "downloads": -1,
        "filename": "ops_lib_pgsql-1.3-py2.py3-none-any.whl",
        "has_sig": true,
        "md5_digest": "7b153c739c3bfea2e7a85af1383dc360",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "requires_python": ">=3.6",
        "size": 20855,
        "upload_time": "2020-11-11T00:24:40",
        "upload_time_iso_8601": "2020-11-11T00:24:40.066305Z",
        "url": "https://files.pythonhosted.org/packages/31/8c/03019f48522f9002d6423b96c31cc2edb50f8d7ffbe3bccc48a2f63c4077/ops_lib_pgsql-1.3-py2.py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "6fd2e41c4c9d5688683f9a374a90209e475bd5f7b92a6d551ce37994e0bce7e6",
          "md5": "2a2e78d2dca7423bbe4a0c14247e83f1",
          "sha256": "36122f708ba8b9ab44392c69168ef3043885ba8a7424dedac3727879b45fdc1e"
        },
        "downloads": -1,
        "filename": "ops-lib-pgsql-1.3.zip",
        "has_sig": true,
        "md5_digest": "2a2e78d2dca7423bbe4a0c14247e83f1",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 24691,
        "upload_time": "2020-11-11T00:24:41",
        "upload_time_iso_8601": "2020-11-11T00:24:41.710798Z",
        "url": "https://files.pythonhosted.org/packages/6f/d2/e41c4c9d5688683f9a374a90209e475bd5f7b92a6d551ce37994e0bce7e6/ops-lib-pgsql-1.3.zip",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.4": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "72cfd6ad2887b77b403a01f640861dfb657de51aefcd928b68bbc46ea0b7c13f",
          "md5": "021c8028136f4572bb8f041a969c6a72",
          "sha256": "85b07a364339da2423c2631680f03aab8f9b4d8a6493efc66303224ff9ab34af"
        },
        "downloads": -1,
        "filename": "ops_lib_pgsql-1.4-py2.py3-none-any.whl",
        "has_sig": true,
        "md5_digest": "021c8028136f4572bb8f041a969c6a72",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "requires_python": ">=3.6",
        "size": 21146,
        "upload_time": "2020-12-15T09:03:01",
        "upload_time_iso_8601": "2020-12-15T09:03:01.609802Z",
        "url": "https://files.pythonhosted.org/packages/72/cf/d6ad2887b77b403a01f640861dfb657de51aefcd928b68bbc46ea0b7c13f/ops_lib_pgsql-1.4-py2.py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "4c9a9ee6cdd38308847df589f2e7e885784d5e450d5a7d8fdd8112bb5d343a15",
          "md5": "2da14a07f9b939ffa5ef0c85512cf0be",
          "sha256": "3ea802a1a9e6be4457dbe49959a76c50d63b689abc1b803c127bd24e5bd98654"
        },
        "downloads": -1,
        "filename": "ops-lib-pgsql-1.4.zip",
        "has_sig": true,
        "md5_digest": "2da14a07f9b939ffa5ef0c85512cf0be",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 24981,
        "upload_time": "2020-12-15T09:03:03",
        "upload_time_iso_8601": "2020-12-15T09:03:03.758738Z",
        "url": "https://files.pythonhosted.org/packages/4c/9a/9ee6cdd38308847df589f2e7e885784d5e450d5a7d8fdd8112bb5d343a15/ops-lib-pgsql-1.4.zip",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "72cfd6ad2887b77b403a01f640861dfb657de51aefcd928b68bbc46ea0b7c13f",
        "md5": "021c8028136f4572bb8f041a969c6a72",
        "sha256": "85b07a364339da2423c2631680f03aab8f9b4d8a6493efc66303224ff9ab34af"
      },
      "downloads": -1,
      "filename": "ops_lib_pgsql-1.4-py2.py3-none-any.whl",
      "has_sig": true,
      "md5_digest": "021c8028136f4572bb8f041a969c6a72",
      "packagetype": "bdist_wheel",
      "python_version": "py2.py3",
      "requires_python": ">=3.6",
      "size": 21146,
      "upload_time": "2020-12-15T09:03:01",
      "upload_time_iso_8601": "2020-12-15T09:03:01.609802Z",
      "url": "https://files.pythonhosted.org/packages/72/cf/d6ad2887b77b403a01f640861dfb657de51aefcd928b68bbc46ea0b7c13f/ops_lib_pgsql-1.4-py2.py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "4c9a9ee6cdd38308847df589f2e7e885784d5e450d5a7d8fdd8112bb5d343a15",
        "md5": "2da14a07f9b939ffa5ef0c85512cf0be",
        "sha256": "3ea802a1a9e6be4457dbe49959a76c50d63b689abc1b803c127bd24e5bd98654"
      },
      "downloads": -1,
      "filename": "ops-lib-pgsql-1.4.zip",
      "has_sig": true,
      "md5_digest": "2da14a07f9b939ffa5ef0c85512cf0be",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.6",
      "size": 24981,
      "upload_time": "2020-12-15T09:03:03",
      "upload_time_iso_8601": "2020-12-15T09:03:03.758738Z",
      "url": "https://files.pythonhosted.org/packages/4c/9a/9ee6cdd38308847df589f2e7e885784d5e450d5a7d8fdd8112bb5d343a15/ops-lib-pgsql-1.4.zip",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}