{
  "info": {
    "author": "Henning Jacobs",
    "author_email": "henning@jacobs1.de",
    "bugtrack_url": null,
    "classifiers": [
      "Framework :: Pytest",
      "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
      "Programming Language :: Python :: 3",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Programming Language :: Python :: 3.9"
    ],
    "description": "# pytest-kind\n\n[![Build Status](https://travis-ci.com/hjacobs/pytest-kind.svg?branch=master)](https://travis-ci.com/hjacobs/pytest-kind)\n[![PyPI](https://img.shields.io/pypi/v/pytest-kind)](https://pypi.org/project/pytest-kind/)\n![PyPI - Python Version](https://img.shields.io/pypi/pyversions/pytest-kind)\n![License](https://img.shields.io/github/license/hjacobs/pytest-kind)\n![CalVer](https://img.shields.io/badge/calver-YY.MM.MICRO-22bfda.svg)\n\nTest your Python Kubernetes app/operator end-to-end with [kind](https://kind.sigs.k8s.io/) and [pytest](https://pytest.org).\n\n`pytest-kind` is a plugin for pytest which provides the `kind_cluster` fixture.\nThe fixture will install kind 0.9.0, create a Kubernetes 1.19 cluster, and provide convenience functionality such as port forwarding.\n\n\n## Usage\n\nInstall `pytest-kind` via pip or via [poetry](https://poetry.eustace.io/), e.g.:\n\n```\npoetry add --dev pytest-kind\n```\n\nWrite your pytest functions and use the provided `kind_cluster` fixture, e.g.:\n\n```python\ndef test_kubernetes_version(kind_cluster):\n    assert kind_cluster.api.version == ('1', '19')\n```\n\nTo load your custom Docker image and apply deployment manifests:\n\n```python\nimport requests\nfrom pykube import Pod\n\ndef test_myapp(kind_cluster):\n    kind_cluster.load_docker_image(\"myapp\")\n    kind_cluster.kubectl(\"apply\", \"-f\", \"deployment.yaml\")\n    kind_cluster.kubectl(\"rollout\", \"status\", \"deployment/myapp\")\n\n    # using Pykube to query pods\n    for pod in Pod.objects(kind_cluster.api).filter(selector=\"app=myapp\"):\n        assert \"Sucessfully started\" in pod.logs()\n\n    with kind_cluster.port_forward(\"service/myapp\", 80) as port:\n        r = requests.get(f\"http://localhost:{port}/hello/world\")\n        r.raise_for_status()\n        assert r.text == \"Hello world!\"\n```\n\nSee the `examples` directory for sample projects and also check out [kube-web-view](https://codeberg.org/hjacobs/kube-web-view) which uses pytest-kind for its e2e tests.\n\n\n## KindCluster object\n\nThe `kind_cluster` fixture is an instance of the KindCluster class with the following methods:\n\n* `load_docker_image(docker_image)`: load the specified Docker image into the kind cluster\n* `kubectl(*args)`: run the `kubectl` binary against the cluster with the specified arguments. Returns the process output as string.\n* `port_forward(service_or_pod_name, remote_port, *args)`: run \"kubectl port-forward\" for the given service/pod and return the (random) local port. To be used as context manager (\"with\" statement). Pass the namespace as additional args to kubectl via \"-n\", \"mynamespace\".\n\nKindCluster has the following attributes:\n\n* `name`: the kind cluster name\n* `kubeconfig_path`: the path to the Kubeconfig file to access the cluster\n* `kind_path`: path to the `kind` binary\n* `kubectl_path`: path to the `kubectl` binary\n* `api`: [pykube](https://pykube.readthedocs.io/) HTTPClient instance to access the cluster from Python\n\nYou can also use KindCluster directly without pytest:\n\n```python\nfrom pytest_kind import KindCluster\n\ncluster = KindCluster(\"myclustername\")\ncluster.create()\ncluster.kubectl(\"apply\", \"-f\", \"..\")\n# ...\ncluster.delete()\n```\n\n\n## Pytest Options\n\nThe kind cluster name can be set via the `--cluster-name` CLI option.\n\nThe kind cluster is deleted after each pytest session, you can keep the cluster by passing `--keep-cluster` to pytest.\n\nNote that you can use the `PYTEST_ADDOPTS` environment variable to pass these options to pytest. This also works if you call pytest from a Makefile:\n\n```bash\n# for test debugging: don't delete the kind cluster\nPYTEST_ADDOPTS=--keep-cluster make test\n```\n\n\n## Notes\n\n* The `kind_cluster` fixture is session-scoped, i.e. the same cluster will be used across all test modules/functions.\n* The `kind` and `kubectl` binaries will be downloaded once to the local directory `./.pytest-kind/{cluster-name}/`. You can use them to interact with the cluster (e.g. when `--keep-cluster` is used).\n* Some cluster pods might not be ready immediately (e.g. kind's CoreDNS take a moment), add wait/poll functionality as required to make your tests predictable.\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://codeberg.org/hjacobs/pytest-kind",
    "keywords": "",
    "license": "GPL-3.0+",
    "maintainer": "",
    "maintainer_email": "",
    "name": "ioben-pytest-kind",
    "package_url": "https://pypi.org/project/ioben-pytest-kind/",
    "platform": "",
    "project_url": "https://pypi.org/project/ioben-pytest-kind/",
    "project_urls": {
      "Homepage": "https://codeberg.org/hjacobs/pytest-kind",
      "Repository": "https://codeberg.org/hjacobs/pytest-kind"
    },
    "release_url": "https://pypi.org/project/ioben-pytest-kind/21.0.1/",
    "requires_dist": [
      "pykube-ng (>=0.30.0)"
    ],
    "requires_python": ">=3.7,<4.0",
    "summary": "Kubernetes test support with KIND for pytest",
    "version": "21.0.1",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 9078180,
  "releases": {
    "21.0.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a6afc5341f31c5bc8f53c6e901eec0d4f7360d96a6fbfe740d5b7fa42e4a4c93",
          "md5": "92f11402db98565990019980613e55ef",
          "sha256": "f1315fe45f8558fc331a8557aaaea3e752de78828b485394bed00e3a78aecd75"
        },
        "downloads": -1,
        "filename": "ioben_pytest_kind-21.0.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "92f11402db98565990019980613e55ef",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<4.0",
        "size": 18191,
        "upload_time": "2021-01-07T15:28:22",
        "upload_time_iso_8601": "2021-01-07T15:28:22.443720Z",
        "url": "https://files.pythonhosted.org/packages/a6/af/c5341f31c5bc8f53c6e901eec0d4f7360d96a6fbfe740d5b7fa42e4a4c93/ioben_pytest_kind-21.0.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "e18b82fde807cd17e1fb3baaad2b47f4d67213975b9ee3fc011af6a58b0b31d9",
          "md5": "408ec27bb6035cdc7c9227ab50520329",
          "sha256": "96a4603f2c7bfc4bde48a7066d6d2c53e7003e4b4975d286553a181f74c24be3"
        },
        "downloads": -1,
        "filename": "ioben-pytest-kind-21.0.0.tar.gz",
        "has_sig": false,
        "md5_digest": "408ec27bb6035cdc7c9227ab50520329",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<4.0",
        "size": 17680,
        "upload_time": "2021-01-07T15:28:21",
        "upload_time_iso_8601": "2021-01-07T15:28:21.353289Z",
        "url": "https://files.pythonhosted.org/packages/e1/8b/82fde807cd17e1fb3baaad2b47f4d67213975b9ee3fc011af6a58b0b31d9/ioben-pytest-kind-21.0.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "21.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "2e8419d2ba7ec9e4544a42ac57279cfbe171ab0a018fd0d476c30da1b25b540c",
          "md5": "aeb5de9060c3e9d4abfc4ef247b324f0",
          "sha256": "ad52f0532d980bde6f807003c635746ce37e3c0e740b89822b352d112b97b3f0"
        },
        "downloads": -1,
        "filename": "ioben_pytest_kind-21.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "aeb5de9060c3e9d4abfc4ef247b324f0",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<4.0",
        "size": 18202,
        "upload_time": "2021-01-07T16:02:34",
        "upload_time_iso_8601": "2021-01-07T16:02:34.945535Z",
        "url": "https://files.pythonhosted.org/packages/2e/84/19d2ba7ec9e4544a42ac57279cfbe171ab0a018fd0d476c30da1b25b540c/ioben_pytest_kind-21.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "4a2ff92e28a8b8127a489cef11cf587fc117252fa94d1d234adc133d6219e491",
          "md5": "1242ffc203e83318ea44ce9b7fbd2618",
          "sha256": "9ff25805c82c173610ace8739b94885d424f81ec32463a26e94f6271ade37cd0"
        },
        "downloads": -1,
        "filename": "ioben-pytest-kind-21.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "1242ffc203e83318ea44ce9b7fbd2618",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<4.0",
        "size": 17673,
        "upload_time": "2021-01-07T16:02:33",
        "upload_time_iso_8601": "2021-01-07T16:02:33.818164Z",
        "url": "https://files.pythonhosted.org/packages/4a/2f/f92e28a8b8127a489cef11cf587fc117252fa94d1d234adc133d6219e491/ioben-pytest-kind-21.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "2e8419d2ba7ec9e4544a42ac57279cfbe171ab0a018fd0d476c30da1b25b540c",
        "md5": "aeb5de9060c3e9d4abfc4ef247b324f0",
        "sha256": "ad52f0532d980bde6f807003c635746ce37e3c0e740b89822b352d112b97b3f0"
      },
      "downloads": -1,
      "filename": "ioben_pytest_kind-21.0.1-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "aeb5de9060c3e9d4abfc4ef247b324f0",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7,<4.0",
      "size": 18202,
      "upload_time": "2021-01-07T16:02:34",
      "upload_time_iso_8601": "2021-01-07T16:02:34.945535Z",
      "url": "https://files.pythonhosted.org/packages/2e/84/19d2ba7ec9e4544a42ac57279cfbe171ab0a018fd0d476c30da1b25b540c/ioben_pytest_kind-21.0.1-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "4a2ff92e28a8b8127a489cef11cf587fc117252fa94d1d234adc133d6219e491",
        "md5": "1242ffc203e83318ea44ce9b7fbd2618",
        "sha256": "9ff25805c82c173610ace8739b94885d424f81ec32463a26e94f6271ade37cd0"
      },
      "downloads": -1,
      "filename": "ioben-pytest-kind-21.0.1.tar.gz",
      "has_sig": false,
      "md5_digest": "1242ffc203e83318ea44ce9b7fbd2618",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7,<4.0",
      "size": 17673,
      "upload_time": "2021-01-07T16:02:33",
      "upload_time_iso_8601": "2021-01-07T16:02:33.818164Z",
      "url": "https://files.pythonhosted.org/packages/4a/2f/f92e28a8b8127a489cef11cf587fc117252fa94d1d234adc133d6219e491/ioben-pytest-kind-21.0.1.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}