{
  "info": {
    "author": "",
    "author_email": "",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: Apache Software License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3"
    ],
    "description": "# cdp_validator_for_aws\n## Overview\nThis tool validates that AWS resources have been setup correctly for\nuse by Cloudera Data Platform (cdp), so that cdp can use those\nresources to create an environment, as defined in the [Cloudera\ndocumentation](https://docs.cloudera.com/management-console/cloud/environments/topics/mc-environments.html).\n\n## Running the tool\nThe resources to be validated are recorded in a `json` file (called\n`my_cdp.json` below).\n\nThe validation uses AWS services and so needs a role with sufficient\npermissions. We setup and use a role called `validator` in the example\nbelow.\n\nBoth of the above are described in detail later in this document.\n\nOnce you've met the above prerequisites then execution is simple:\n```\npython -m cdp_validator_for_aws -c my_cdp_file.json --profile validator\n```\n\n## Setup\n### Python Package\nWe recommend using a python virtual environment and installing this\npackage into that environment. This will help eliminate any\nenvironmental issues while executing this tool.\n\n### CDP JSON File\nThis tool uses a `json` file (we called it `my_cdp.json` in the\nexample above, but its name doesn't matter) to feed in the information\nabout the resources to be checked.\n\nThe format of this file is shown below (there could be extra\nelements - the once we're displaying are the critical ones) and is\ngenerated from the cdp gui. However there are two elements that are\n*not* generated by the gui and are added by hand. They are:\n* `idBrokerInstanceProfileArn1`\n* `storageLocationBase`\n```json\n{\n  \"aws\": {\n    \"s3guard\": {\n      \"dynamoDbTableName\": \"dynamo\"\n    }\n  },\n  \"idBrokerInstanceProfileArn\": \"arn:aws:iam::007856030109:instance-profile/idbroker_instance_profile_workable-bird\",\n  \"idBrokerMappings\": {\n    \"baselineRole\": \"arn:aws:iam::007856030109:role/datalake_admin_role_workable-bird\",\n    \"dataAccessRole\": \"arn:aws:iam::007856030109:role/ranger_audit_role_workable-bird\",\n  },\n  \"location\": {\n    \"name\": \"us-east-1\"\n  },\n  \"network\": {\n    \"aws\": {\n      \"vpcId\": \"vpc-0bd760316679db5cb\"\n    },\n    \"subnetIds\": [\n      \"subnet-0aaea807fb0bd7324\",\n      \"subnet-0cf3890ddf5418adb\",\n      \"subnet-019052b500b0ec751\"\n    ]\n  },\n  \"securityAccess\": {\n    \"defaultSecurityGroupId\": \"sg-0614ae4bc34aab00a\",\n    \"securityGroupIdForKnox\": \"sg-0881e000a25678273\"\n  },\n  \"storageLocationBase\": \"s3a://terraform-20191004154753079000000001/base\",\n  \"telemetry\": {\n    \"logging\": {\n      \"s3\": {\n        \"instanceProfile\": \"arn:aws:iam::007856030109:instance-profile/logger_instance_profile_workable-bird\"\n      },\n      \"storageLocation\": \"s3a://terraform-20191004154753079700000002/logs\"\n    }\n  }\n}\n```\nThe meanings of these fields is given below using `jsonpath` to denote\nthe fields:\n\n* `aws.s3guard.dynamoDbTableName`: The name of the dynamo db table to\n   be created\n* `idBrokerInstanceProfileArn`: The arn of the idbroker *instance\n  profile* used to run the idbroker ec2 instance\n* `idBrokerMappings.baselineRole`: The arn of the adminstrator role that is used to\n  manage data in the CDP datalake\n* `idBrokerMappings.dataAccessRole`: the arn of the ranger audit role\n* `location.name`: The AWS region for these resources\n* `network.aws.vpcId`: The VPC id\n* `network.subnetIds`: An array of subnet ids that will be used by the\n  CDP\n* `securityAccess.defaultSecurityGroupId`: Id of the default security\n  group\n* `securityAccess.securityGroupIdForKnox`: Id of the security group\n  for Knox\n* `storageLocationBase`: The `s3a://` url to the bucket and path where\n  data will be stored in the data lake\n* `telementery.logging.s3.instanceProfile`: The arn of the instance\n  profile that will be running the logging system\n* `telemetry.logging.storageLocation`: The `s3a://` url where logs\n  will be placed.\n\n### AWS Setup\nAWS needs to be properly setup for this tool to work.\n#### CLI\nWe assume you have installed and configured the AWS CLI as per [AWS\nCLI Documentation](\nhttps://docs.aws.amazon.com/cli/latest/userguide/cli-chap-install.html)\n\n\n#### Permissions\nThe minimum permissions needed to run `cdp_validator_for_aws` are:\n\n```\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Sid\": \"VisualEditor0\",\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"ec2:DescribeRouteTables\",\n                \"ec2:DescribeSecurityGroups\",\n                \"ec2:DescribeSubnets\",\n                \"ec2:DescribeVpcs\",\n                \"ec2:DescribeVpcAttribute\",\n                \"eks:ListClusters\",\n                \"iam:GetContextKeysForPrincipalPolicy\",\n                \"iam:GetInstanceProfile\",\n                \"iam:GetRole\",\n                \"iam:SimulatePrincipalPolicy\",\n                \"s3:GetBucketLocation\",\n                \"s3:HeadBucket\"\n            ],\n            \"Resource\": \"*\"\n        }\n    ]\n}\n```\nThe permissions that have the deepest security impact are those\nrequired to simulate the various roles\n(`iam:GetContextKeysForPrincipalPolicy` &\n`iam:SimulatePrincipalPolicy`), as\n[documented](https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_testing-policies.html#policies-simulator-using-api)\nby AWS. `cdp_validator_for_aws` will do as much as it can with whatever permissions you\ncan give it.\n\n`cdp_validator_for_aws` takes a `--profile profile_name` argument, as\nper the usual AWS CLI, and all calls are handed off to Amazon's\n[boto3](https://boto3.amazonaws.com/v1/documentation/api/latest/reference/core/boto3.html)\npackage to do the actual work.\n\n##### Setting up the permissions structure\nLets assume you've setup to execute AWS CLI commands with the\n`default` profile with whatever permissions you normally get.\n\n1. Create a role (lets call it `cdp_validation`) that:\n   1. Trusts your `default` role\n   1. Has the above permissions (or most of them)\n1. In `${HOME}/.aws/credentials` put the following:\n\n```\n[validator]\nrole_arn = arn:aws:iam::YOUR_AWS_ACCOUNT_ID:role/cdp_validation\nsource_profile = default\n```\n\nNow you can run the validator thus:\n```\npython -m cdp_validator_for_aws -c my_cdp_file.json --profile validator\n```\n\n# Configuration\nNo configuration is needed. The below information is simply for full\ndocumentation purposes.\n## Policy Management\nCloudera's [documentation](https://docs.cloudera.com/management-console/cloud/environments/topics/mc-environment-aws-logs.html)  shows the various policy files\nthat are combined to give each of the four roles their necessary\npermissions for various resources.\n\nThese files are in the `policies` directory of the package and are\nnamed according to Cloudera's naming conventions defined in the\n[Minimal setup for cloud\nstorage](https://docs.cloudera.com/management-console/cloud/environments/topics/mc-idbroker-minimum-setup.html).\nThey dictate the actions and resources that are simulated for each\nrole. If the actions change in the future then these files can be\nsimply updated. If the variables in the resources change then I'm\nafraid you'll have to change the code (look in the `policy_manager.py`\nto start)\n\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "cdp-validator-for-aws",
    "package_url": "https://pypi.org/project/cdp-validator-for-aws/",
    "platform": "",
    "project_url": "https://pypi.org/project/cdp-validator-for-aws/",
    "project_urls": null,
    "release_url": "https://pypi.org/project/cdp-validator-for-aws/0.0.6/",
    "requires_dist": [
      "boto3 (>=1.9.242)"
    ],
    "requires_python": ">=3.7",
    "summary": "Validation of aws resources used to create Cloudera Data Platform environments",
    "version": "0.0.6",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 5957636,
  "releases": {
    "0.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "b0f0f9a1f2085d77c31562fbc294feb3e0211b2de8f0044a36b6ec0d3a5fa25a",
          "md5": "553e5ce28c646133066e7f28be877174",
          "sha256": "f09f91bc0f9693f91079970b51b74315c8596ff1d5900ae3d091978346e88722"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "553e5ce28c646133066e7f28be877174",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 27083,
        "upload_time": "2019-10-04T22:32:56",
        "upload_time_iso_8601": "2019-10-04T22:32:56.947082Z",
        "url": "https://files.pythonhosted.org/packages/b0/f0/f9a1f2085d77c31562fbc294feb3e0211b2de8f0044a36b6ec0d3a5fa25a/cdp_validator_for_aws-0.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "6cfa73cb006f3d190248f4d98b91ef1a444d3e7151f6fc596158428d8d93a3fa",
          "md5": "a8f0b437168202528dcb2c76c33d0a14",
          "sha256": "d52094c9495201ce5d5f68e74376c43a8539c87ee392bb4d0cd6acd25569e6f1"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "a8f0b437168202528dcb2c76c33d0a14",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 19191,
        "upload_time": "2019-10-04T22:32:59",
        "upload_time_iso_8601": "2019-10-04T22:32:59.076035Z",
        "url": "https://files.pythonhosted.org/packages/6c/fa/73cb006f3d190248f4d98b91ef1a444d3e7151f6fc596158428d8d93a3fa/cdp_validator_for_aws-0.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "041e51566b4b549cfc7dd78dff8273c6923cb3bf2e352c576037ac6acceb55b8",
          "md5": "6964ae899ede976b7426181bbd600c9c",
          "sha256": "40fbc8d5baa6bd19654d9918ba953956d58689b2c8fbd9e215c8507eba990e83"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "6964ae899ede976b7426181bbd600c9c",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 27494,
        "upload_time": "2019-10-07T21:25:33",
        "upload_time_iso_8601": "2019-10-07T21:25:33.692173Z",
        "url": "https://files.pythonhosted.org/packages/04/1e/51566b4b549cfc7dd78dff8273c6923cb3bf2e352c576037ac6acceb55b8/cdp_validator_for_aws-0.0.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "15d31fb87e346fac32441681796c83e7e8c7919111157cac069d4b22eb4d5ef3",
          "md5": "42b729259dcdf9af903fc21231c11624",
          "sha256": "67bca71f1e952d99d13ef2ca22c1513f3c204e4f884580c5a4934536b818b878"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.2.tar.gz",
        "has_sig": false,
        "md5_digest": "42b729259dcdf9af903fc21231c11624",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 20736,
        "upload_time": "2019-10-07T21:25:35",
        "upload_time_iso_8601": "2019-10-07T21:25:35.139429Z",
        "url": "https://files.pythonhosted.org/packages/15/d3/1fb87e346fac32441681796c83e7e8c7919111157cac069d4b22eb4d5ef3/cdp_validator_for_aws-0.0.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "ac53d251d96b808b7eeb258b6d66456f67dc8cc748a0ed41297589f45c1608d3",
          "md5": "3e9a893034188a8d712d3438c9eb13ce",
          "sha256": "375b00bc9c270144bced38ab409b9f98fcc735c1aab2459f0066a7c301c41c0d"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.3-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "3e9a893034188a8d712d3438c9eb13ce",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 27653,
        "upload_time": "2019-10-09T20:22:07",
        "upload_time_iso_8601": "2019-10-09T20:22:07.002994Z",
        "url": "https://files.pythonhosted.org/packages/ac/53/d251d96b808b7eeb258b6d66456f67dc8cc748a0ed41297589f45c1608d3/cdp_validator_for_aws-0.0.3-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a47a59b6c585a2833c305072824e93aa0607d078e5292bf9da7c49f4a382726d",
          "md5": "90eeffbfd6a50a22b2f2835bb5245bdc",
          "sha256": "024f7a0da18b4faee19dac488ff41973af6f1d066569da47ab013ab0315798ab"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.3.tar.gz",
        "has_sig": false,
        "md5_digest": "90eeffbfd6a50a22b2f2835bb5245bdc",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 20131,
        "upload_time": "2019-10-09T20:22:09",
        "upload_time_iso_8601": "2019-10-09T20:22:09.333414Z",
        "url": "https://files.pythonhosted.org/packages/a4/7a/59b6c585a2833c305072824e93aa0607d078e5292bf9da7c49f4a382726d/cdp_validator_for_aws-0.0.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.4": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "369703000296c14a2ee18e514dbb23d0830df6988561e7e65e95ccfd5749eae2",
          "md5": "9ad1302551710e5694a12d2aa59c91eb",
          "sha256": "b240b64dfdf0033aedb685297ea567a0a1d7fe6b53fb783e9de4bff7067484a8"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.4-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "9ad1302551710e5694a12d2aa59c91eb",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 28651,
        "upload_time": "2019-10-10T22:38:36",
        "upload_time_iso_8601": "2019-10-10T22:38:36.866850Z",
        "url": "https://files.pythonhosted.org/packages/36/97/03000296c14a2ee18e514dbb23d0830df6988561e7e65e95ccfd5749eae2/cdp_validator_for_aws-0.0.4-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "eeb0862e56b7ba1882ecbfe164ac4dd62f2c54d1f96b8dfd2666481be4d97b98",
          "md5": "634e34b0b0d63fff662311598ad47bb0",
          "sha256": "f6fbc849657b36c6ca52cd75dc25cb64fddaa9ceeb3d71dc8eb1fd5f95af86b0"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.4.tar.gz",
        "has_sig": false,
        "md5_digest": "634e34b0b0d63fff662311598ad47bb0",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 20488,
        "upload_time": "2019-10-10T22:38:38",
        "upload_time_iso_8601": "2019-10-10T22:38:38.204959Z",
        "url": "https://files.pythonhosted.org/packages/ee/b0/862e56b7ba1882ecbfe164ac4dd62f2c54d1f96b8dfd2666481be4d97b98/cdp_validator_for_aws-0.0.4.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.5": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "f9e3455898801ea013f40cb32f9729d5f8e9a5dbf548656c8a4dade4994a802d",
          "md5": "57cf3c04eb54c61192230504b01d60eb",
          "sha256": "77c61273fa69d121deedf93c3621121568d05360c540a86556dbab2adbb783ef"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.5-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "57cf3c04eb54c61192230504b01d60eb",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 28099,
        "upload_time": "2019-10-11T00:04:48",
        "upload_time_iso_8601": "2019-10-11T00:04:48.043810Z",
        "url": "https://files.pythonhosted.org/packages/f9/e3/455898801ea013f40cb32f9729d5f8e9a5dbf548656c8a4dade4994a802d/cdp_validator_for_aws-0.0.5-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "5f662abcb1a120f40ea20b48bb22ed10b9660287b1e34f016f55526f2ee04565",
          "md5": "83c965d82aa9f249649679df17ba6125",
          "sha256": "dd6ad41a1f6d711b00455de2518f5943c5b4508e1a79264edc6175bf9b3ea31b"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.5.tar.gz",
        "has_sig": false,
        "md5_digest": "83c965d82aa9f249649679df17ba6125",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 19961,
        "upload_time": "2019-10-11T00:04:50",
        "upload_time_iso_8601": "2019-10-11T00:04:50.037146Z",
        "url": "https://files.pythonhosted.org/packages/5f/66/2abcb1a120f40ea20b48bb22ed10b9660287b1e34f016f55526f2ee04565/cdp_validator_for_aws-0.0.5.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.6": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "4a7a92658577735790900f3de594581c84c0b2e950c1e35a5cf67cd0bcb9d13b",
          "md5": "cf3e7d874c294a8e33eb8b807a0904e0",
          "sha256": "19c876436f448cda04eea06a351d845c932974c9a8412ce48c477324049a1bc4"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.6-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "cf3e7d874c294a8e33eb8b807a0904e0",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 28098,
        "upload_time": "2019-10-11T00:19:35",
        "upload_time_iso_8601": "2019-10-11T00:19:35.485587Z",
        "url": "https://files.pythonhosted.org/packages/4a/7a/92658577735790900f3de594581c84c0b2e950c1e35a5cf67cd0bcb9d13b/cdp_validator_for_aws-0.0.6-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "ff9672638c3aa19bfd638c19e05ca868d709d7005dea5d112811979ad991bf0a",
          "md5": "47fa57bafce8ef724634c90ceade14ff",
          "sha256": "7f8b8a97928a043d86b7ec637f4786ec33e381264eac02149f6cab2d384f180a"
        },
        "downloads": -1,
        "filename": "cdp_validator_for_aws-0.0.6.tar.gz",
        "has_sig": false,
        "md5_digest": "47fa57bafce8ef724634c90ceade14ff",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 19962,
        "upload_time": "2019-10-11T00:19:39",
        "upload_time_iso_8601": "2019-10-11T00:19:39.211963Z",
        "url": "https://files.pythonhosted.org/packages/ff/96/72638c3aa19bfd638c19e05ca868d709d7005dea5d112811979ad991bf0a/cdp_validator_for_aws-0.0.6.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "4a7a92658577735790900f3de594581c84c0b2e950c1e35a5cf67cd0bcb9d13b",
        "md5": "cf3e7d874c294a8e33eb8b807a0904e0",
        "sha256": "19c876436f448cda04eea06a351d845c932974c9a8412ce48c477324049a1bc4"
      },
      "downloads": -1,
      "filename": "cdp_validator_for_aws-0.0.6-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "cf3e7d874c294a8e33eb8b807a0904e0",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7",
      "size": 28098,
      "upload_time": "2019-10-11T00:19:35",
      "upload_time_iso_8601": "2019-10-11T00:19:35.485587Z",
      "url": "https://files.pythonhosted.org/packages/4a/7a/92658577735790900f3de594581c84c0b2e950c1e35a5cf67cd0bcb9d13b/cdp_validator_for_aws-0.0.6-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "ff9672638c3aa19bfd638c19e05ca868d709d7005dea5d112811979ad991bf0a",
        "md5": "47fa57bafce8ef724634c90ceade14ff",
        "sha256": "7f8b8a97928a043d86b7ec637f4786ec33e381264eac02149f6cab2d384f180a"
      },
      "downloads": -1,
      "filename": "cdp_validator_for_aws-0.0.6.tar.gz",
      "has_sig": false,
      "md5_digest": "47fa57bafce8ef724634c90ceade14ff",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7",
      "size": 19962,
      "upload_time": "2019-10-11T00:19:39",
      "upload_time_iso_8601": "2019-10-11T00:19:39.211963Z",
      "url": "https://files.pythonhosted.org/packages/ff/96/72638c3aa19bfd638c19e05ca868d709d7005dea5d112811979ad991bf0a/cdp_validator_for_aws-0.0.6.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}