{
  "info": {
    "author": "Hans-Joachim Ruscheweyh",
    "author_email": "hansr@ethz.ch",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 5 - Production/Stable",
      "Intended Audience :: Science/Research",
      "License :: OSI Approved :: GNU General Public License v3 (GPLv3)",
      "Operating System :: OS Independent",
      "Programming Language :: Python",
      "Programming Language :: Python :: 3",
      "Topic :: Scientific/Engineering :: Bio-Informatics"
    ],
    "description": "\n\n\n\n\n  \n<p align=\"center\">\n<img src=\"https://raw.githubusercontent.com/SushiLab/mVIRs/master/pics/mVIRs.png\" width=\"500\"  />\n</p>\n\n\n# mVIRs: Localisation of inducible prophages using NGS data\n \nmVIRs is a command-line tool that localizes and extracts genome sequences of inducible prophages in bacterial host genomes using paired-end DNA sequencing data as input. The approach relies on identifying DNA segments that are predicted to exist in a circularized or concatenated form upon induction. To achieve this, mVIRs uses information on the orientation of short, paired-end sequencing (e.g., Illumina) reads that are aligned to the genome of a lysogenic host as a reference. The identified segments can be length-filtered and classified by prediction tools (e.g., [VirSorter2](https://doi.org/10.1186/s40168-020-00990-y), [VirFinder](https://doi.org/10.1186/s40168-017-0283-5), [VIBRANT](https://doi.org/10.1186/s40168-020-00867-0) or [Prophage Hunter](https://doi.org/10.1093/nar/gkz380)), to identify putative prophage candidates.\n\nThe tool was developed by Hans-Joachim Ruscheweyh, Mirjam Zünd and Shinichi Sunagawa. It is distributed under [![License GPL v3](https://img.shields.io/badge/license-GPL%20v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0.en.html). \n\nIf you use **mVIRs**, please cite:\n> [Zünd M, Ruscheweyh HJ, Field CM, Meyer N, Cuenca M, Hoces D, Hardt WD, Sunagawa S. **High throughput sequencing provides exact genomic locations of inducible prophages and accurate phage-to-host ratios in gut microbial strains.** *Microbiome*, 9: 77, 2021.](https://doi.org/10.1186/s40168-021-01033-w)\n\nAnalyses in the publication were executed using version 1.0.0.\n\nQuestions/Comments? Write a github issue.\n\n\n## Installation\n\nThe tools is written in `Python` and has the following dependencies:\n\n- [Python](https://www.python.org/) >= 3.7\n- [BWA](https://github.com/lh3/bwa) (tested: v0.7.17-r1188)\n- [samtools](https://github.com/samtools/samtools) (tested: v1.9)\n\n\n### Installation using conda\n\nThe easiest way to install **mVIRs** is to use the conda package manager using the [bioconda channel](https://bioconda.github.io/user/install.html#set-up-channels), which will automatically create an environment with the correct versions of the dependencies and then install **mVIRs** using `pip`.\n\n```bash\n# Install dependencies\n\n$ conda create -n mvirs python>=3.7 pip bwa samtools\n$ conda activate mvirs\n$ python -m pip install mvirs\n\n# Test installation\n\n$ mvirs -h\n\nProgram: mVIRs - Localisation of inducible prophages using NGS data\nVersion: 1.1.1\nReference: Zünd, Ruscheweyh, et al.\nHigh throughput sequencing provides exact genomic locations of inducible\nprophages and accurate phage-to-host ratios in gut microbial strains.\nMicrobiome (2021). doi:10.1186/s40168-021-01033-w\n\nUsage: mvirs <command> [options]\nCommand:\n\n    index   create index files for reference used in the\n            mvirs oprs routine\n\n    oprs    align reads against reference and used clipped\n            alignment positions and OPRs to extract potential\n            prophages\n\n    test    run mVIRs for a public dataset\n  \n```\n\n\n### Manual installation\n\nAlthough installation using conda is recommended, manual installation of dependencies is also possible. `pip` is then used to install **mVIRs**:\n\n```bash\n# Manually install dependencies\n...\n\n# Install mVIRs\n$ python -m pip install mvirs\n\n# Test installation\n$ mvirs -h\n\n...\n\n```\n\n## Running mVIRs\n\n\nThe `mVIRs` toolkit includes three commands, `index`, `oprs` and `test`. The `index` command takes a reference sequence file as input and builds the reference database files that are needed for the execution of the `oprs` command. The `oprs` command aligns paired-end reads against the reference database to detect so called outward-oriented paired-end reads (OPRs) and uses soft-clipped alignments (clipped reads) to identify the location and extract the sequence of potential prophages. The test function executes `mVIRs` on a test dataset that is downloaded as part of this function.  \n\n### `mvirs index`\n\nThis step takes a FASTA-formatted reference sequence file as input and builds an index using the `bwa index` command. This command needs to be executed before running the `oprs` command.\n\n```bash\n$ mvirs index\n\nProgram: mVIRs - Localisation of inducible prophages using NGS data\nVersion: 1.1.1\nReference: Zünd, Ruscheweyh, et al.\nHigh throughput sequencing provides exact genomic locations of inducible\nprophages and accurate phage-to-host ratios in gut microbial strains.\nMicrobiome, 9: 77, 2021. doi:10.1186/s40168-021-01033-w\n\nUsage: mvirs index [options]\n\n    Input:\n        -f  FILE   Reference FASTA file. Can be gzipped. [Required]\n\n```\n\n**Example**\n\n```bash\nmvirs index reference.fasta\n```\n\n\n\n### `mvirs oprs`\n\nThis step takes paired-end read files as input (one for each forward and reverse reads) and the name of the reference database produced by `mvirs index`. It aligns the reads against the reference database and uses the alignment information to identify potential prophage sequences within the reference genome using coverage information from OPRS and clipped reads.\n\n\n```bash\n$ mvirs oprs\n\nProgram: mVIRs - Localisation of inducible prophages using NGS data\nVersion: 1.1.1\nReference: Zünd, Ruscheweyh, et al.\nHigh throughput sequencing provides exact genomic locations of inducible\nprophages and accurate phage-to-host ratios in gut microbial strains.\nMicrobiome, 9: 77, 2021. doi:10.1186/s40168-021-01033-w\n\nUsage: mvirs oprs [options]\n\n    Input:\n        -f  FILE   Forward reads file. FastA/Q. Can be gzipped. [Required]\n        -r  FILE   Reverse reads file. FastA/Q. Can be gzipped. [Required]\n        -db FILE   Reference database file (prefix) created by mvirs index. [Required]\n\n    Output:\n        -o  PATH   Prefix for output files. [Required]\n\n    Options:\n        -t  INT    Number of threads. [1] \n        -ml INT    Minimum sequence length for extraction. [4000]\n        -ML INT    Maximum sequence length for extraction. [800000]\n        -m         Allow full contigs/scaffolds/chromosomes to be reported \n\t           (When OPRs and clipped reads are found at the start and end of contigs/scaffolds/chromosomes)\n\n```\n\n**Example**\n\nRun `mvirs oprs` on the read files (`reads.1.fq.gz` and `reads.2.fq.gz`) using the same reference sequence file (`reference.fasta`) that was used as input for `mvirs index`.\n\n```bash\n$ mvirs oprs -f reads.1.fq.gz -r reads.2.fq.gz -db reference.fasta -o mvirs.output\n\n# Will produce the following files (see below for explanation of the files)\n# mvirs.output.bam --> Alignments\n# mvirs.output.oprs --> The OPR positions in a tab separated file\n# mvirs.output.clipped --> The clipped alignment positions in a tab separated file\n# mvirs.output.fasta --> The potential prophage regions as a fasta file\n```\n\n### `mvirs test`\n\nThe `mvirs test` command downloads example read and reference files and launches the default `mvirs oprs` using the downloaded files as input.\n\n\n\n```bash\n$ mvirs.py test\n\n2021-09-20 08:44:31,283 INFO: Starting mVIRs\nProgram: mVIRs - Localisation of inducible prophages using NGS data\nVersion: 1.1.1\nReference: Zünd, Ruscheweyh, et al.\nHigh throughput sequencing provides exact genomic locations of inducible\nprophages and accurate phage-to-host ratios in gut microbial strains.\nMicrobiome, 9: 77, 2021. doi:10.1186/s40168-021-01033-w\nUsage: mvirs test [options]\n\n    Input:\n        -o  PATH   Output folder. [Required]\n```\n\n**Example**\n\n```bash\n$ mvirs test ~/mVIRs_test/\n# Will produce the following files (see below for explanation of the files)\n# mvirs.output.bam --> Alignments\n# mvirs.output.oprs --> The OPR positions in a tab separated file\n# mvirs.output.clipped --> The clipped alignment positions in a tab separated file\n# mvirs.output.fasta --> The potential prophage regions as a fasta file\n\n```\n\n\n## Output files\n\n`mvirs oprs` produces four output files (`mvirs.output.bam`. `mvirs.output.oprs`, `mvirs.output.clipped` and `mvirs.output.fasta`) of which we will explain the latter three.\n\n\n\n### mvirs.output.fasta\n\nThe `mvirs.output.fasta` is a FASTA-formatted file with the potential prophage sequences that were extracted from the reference genome. The FASTA headers include information on the \n\n- source scaffold\n- start and end coordinates of the extracted sequence\n- number of supporting OPRs\n- number of supporting clipped alignments\n- fraction of the scaffold length that is covered by the extracted region\n\n**Example**\n\n```\n>SalmonellaLT2:1213986-1255756\tORPs=3868-HSs=1473-SF=0.852597\nATTCGTAATGCGAAGGTCGTAGGTTCGACTCCTATTATCGGCACCAGTTAAATCAAATACTTAC...\n\n# SalmonellaLT2:1213986-1255756 --> Scaffold:START-STOP\n# ORPs=3868 --> Number of OPRs = 3868\n# HSs=1473 --> Number of hard- and soft-clipped alignments\n# SF=0.852597 --> 0.85% of the scaffold length is covered by the extracted region\n```\n\n\n### mvirs.output.oprs \n\nThe `mvirs.output.oprs` file lists the inserts of paired-end reads that align either with an unusual orientation (e.g. OPR or SAME) or have an unexpected large insert size (IPR) when compared to the estimated insert size (See section [Concepts](#concepts) for the definition of OPR, SAME and IPR)\n\nThe columns of the file are:\n   \n- `INSERTNAME`: The name of the insert\n- `REFERENCE`: Name of the scaffold/genomic region of the reference sequence\n- `INSERT_SIZE`: The size of the insert\n- `R1_ORIENTATION`: The orientation of the R1 read on the reference\n- `R2_ORIENTATION`: The orientation of the R2 read on the reference\n- `BWA_SCORE`: The sum of scores reported by bwa for the insert\n- `R1_START`: The leftmost coordinate on the reference where the R1 read aligns\n- `R2_START`: The leftmost coordinate on the reference where the R2 read aligns\n- `R1_ALNLENGTH`: The length of the alignment of the R1 read on the reference\n- `R2_ALNLENGTH`: The length of the alignment of the R2 read on the reference\n- `INSERT_ORIENTATION`: The orientation of the both reads to each other. Can either be IPR, OPR or SAME\n\n\nAn example output is below:\n\n```\n#MIN_REASONABLE_INSERTSIZE=0\n#MAX_REASONABLE_INSERTSIZE=1628\n```\n| #INSERTNAME                               \t| REFERENCE             \t| INSERT_SIZE \t| R1_ORIENTATION \t| R2_ORIENTATION \t| BWA_SCORE \t| R1_START \t| R2_START \t| R1_ALNLENGTH \t| R2_ALNLENGTH \t| INSERT_ORIENTATION \t|\n|-----------------------------------------\t|-----------------------\t|-------------\t|----------------\t|----------------\t|-----------\t|----------\t|----------\t|--------------\t|--------------\t|--------------------\t|\n| K00206:180:H2CJWBBXY:8:1107:6644:49230  \t| SalmonellaLT2         \t| 41477       \t| forward        \t| reverse        \t| 297       \t| 1255437  \t| 1214111  \t| 151          \t| 147          \t| OPR                \t|\n| K00206:180:H2CJWBBXY:8:1107:7182:12181  \t| SalmonellaLT2         \t| 41392       \t| forward        \t| reverse        \t| 288       \t| 1255606  \t| 1214365  \t| 151          \t| 143          \t| OPR                \t|\n| K00206:180:H2CJWBBXY:8:1107:7436:46873  \t| SalmonellaLT2         \t| 41449       \t| reverse        \t| forward        \t| 302       \t| 1214126  \t| 1255424  \t| 151          \t| 151          \t| OPR                \t|\n| K00206:180:H2CJWBBXY:8:1107:8582:43304  \t| SalmonellaLT2         \t| 1351429     \t| reverse        \t| reverse        \t| 225       \t| 4216570  \t| 2865291  \t| 150          \t| 80           \t| SAME               \t|\n| K00206:180:H2CJWBBXY:8:1107:9404:2176   \t| SalmonellaLT2         \t| 41222       \t| forward        \t| reverse        \t| 291       \t| 1255124  \t| 1214053  \t| 151          \t| 145          \t| OPR                \t|\n| K00206:180:H2CJWBBXY:8:1107:10470:14959 \t| SalmonellaLT2         \t| 41453       \t| reverse        \t| forward        \t| 302       \t| 1214268  \t| 1255570  \t| 151          \t| 151          \t| OPR                \t|\n| K00206:180:H2CJWBBXY:8:1107:10724:29958 \t| SalmonellaLT2         \t| 140         \t| reverse        \t| forward        \t| 201       \t| 475072   \t| 475135   \t| 140          \t| 76           \t| OPR                \t|\n\n### mvirs.output.clipped\n\n\nThe `mvirs.output.clipped` file contains the name, orientation and position of aligned reads that were clipped (i.e., the read could only be partially aligned).\n\nThe columns of the file are:\n\n- `INSERTNAME`: Name of the insert\n- `READ ORIENTATION`: R1 or R2 \n- `HARD/SOFTCLIP`: Reported clip type by BWA (Soft --> longer part of the alignment. Hard --> shorter part of the alignment)\n- `DIRECTION`: Direction of the alignment with respect to the reference sequence\n- `POSITION`: Leftmost coordinate of the alignment on the reference sequence\n- `REFERENCE`: Name of the scaffold/genomic region of the reference sequence\n\nAn example output is below:\n\n| #INSERT                                | READORIENTATION | HARD/SOFTCLIP | DIRECTION | POSITION | REFERENCE      |\n|----------------------------------------|-----------------|---------------|-----------|----------|---------------|\n| K00206:180:H2CJWBBXY:8:1101:1336:1982  | R2              | S             | ->        | 252072   | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:1418:9895  | R2              | S             | <-        | 1946641  | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:1468:42231 | R2              | S             | ->        | 1492581  | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:1864:3670  | R2              | S             | <-        | 2886283  | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:1915:46346 | R1              | S             | <-        | 1255756  | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:1915:46346 | R1              | H             | ->        | 1213986  | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:1996:25738 | R2              | S             | <-        | 4147832  | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:2037:2457  | R2              | S             | ->        | 465110   | SalmonellaLT2 |\n| K00206:180:H2CJWBBXY:8:1101:2087:10422 | R1              | S             | <-        | 4769629  | SalmonellaLT2 |\n\n\n\n  \n\n## Concepts\n\n### IPRs, OPRs and SAME\n\n\nA paired-end read can align in the following orientations:\n\n```\n# IPRs --> If the insert orientation matches the reference sequence\n\nREFERENCE ---------------------------------------\nR1              -------->\nR2                        <--------\n\n# OPRs --> If the insert orientation does not match the reference genome (e.g., paired-end reads from circularized phage genomes spanning across attP sites)\n\nREFERENCE ---------------------------------------\nR1              <--------\nR2                        -------->\n\n\n# SAME -> If the insert orientation does not match the reference genome (e.g., due to inversions)\n\nREFERENCE ---------------------------------------\nR1              -------->\nR2                        -------->\n \n```\n\n\nThis tool reports IPRs with unreasonable insert sizes and OPRs.\n\n## Algorithm\n\nThe algorithm for potential prophage genome detection consists of three steps.The first two steps scan the alignment file (`mvirs.output.bam`) and report OPRs and clipped alignments. The last step uses the information generated in the first two steps to detect potential prophages and report their sequences as a FASTA formatted output file. \n\n\n### 1. Read Alignment Orientation\n\n1. Reads are conceptually paired as inserts according to their naming.\n2. Upper and lower maxima for reasonable insert sizes are estimated using the mean insert size +/- seven standard deviations for uniquely mapping inward-oriented paired-end reads (IPRs).\n3. For each insert:\n  - Find the best-scoring alignment pairs within 3% of the best alignment score.\n  - Report the insert as OPR if there is no IPR with a reasonable insert size within the 3% cutoff and if the OPR is the best scoring alignment.\n\n### 2. Clipped Alignments\n\nThe alignment of a read is clipped if it can not be fully aligned against the reference genome. Two reasons for clipped alignments are:\n\n1. The representation of circular bacterial chromosome sequence in linear form. Reads that align at the beginning of the linearised chromosome (here named reference) will also align at the end. A single full length alignment is not possible. In the example below, the first three bases of a given read align at the end of the reference, the last 3 bases at the beginning:\n\n\t```\n\tREFERENCE ---------------------------------------\n\tREAD      ---                                 ---\n\t          456                                 123  \n\t```\n\t\t\n\tSimilarly, if a read originates from a circularized phage genome that is also encoded as a prophage in the reference, the reads will align at the end and the beginning of the integrated prophage genome:  \t\n \n\t```\n\t# Phage genome integrated in reference chromosome (denoted as P)\n\tREFERENCE ----------------PPPPPPPPPPP------------\n\tREAD                      ---     ---\n\t                          456     123\n\t```\n\t\n\n2. The reference genome contains an element (e.g., an integrated phage), but the read originates from a genome of a naive host (i.e., without the prophage). In the example below, the read originates from a naive host that does not contain the prophage genome (denoted as P), and thus flanks the phage integration site. \n\n\t```\n\tREFERENCE ----------------PPPPPPPP---------------\n\tREAD                   ---        ---\n\t                       123        456\n\t```\n\n\n\n### 3. Identification of potential prophages\n\nRegions where an accumulation of clipped alignments and OPRs are detected are reported as potential phages in the output fasta file.\n\nThe start and end positions of OPRs are distributed around the phage insertion sites. As such, they are indicative for potential prophages; however, they cannot be used to determine their exact positions. The locations of clipped alignments are precise; however, they often miss part of the alignment due to ambiguous alignments or not passing  the criteria for minimal alignment lengths. Therefore,  a genomic region requires the support from at least 1 OPR and at least 1 clipped alignment to be considered as a potential inducible  prophage. Furthermore, potential sites must have in total a sum of 5 or more OPRs and clipped alignments.\n\nPotential prophage regions are also filtered by length, with a minimum requirement of 4kb and a maximum of 800kb. These limits can be modified with the `-ml` (minimum) and `-ML` (maximum) parameters.\n\nIf the `-m` flag is set, potential prophage regions that cover entire contigs/scaffolds will be reported, otherwise they will be discarded.\n\n\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "https://github.com/SushiLab/mVIRs/archive/refs/tags/1.1.1.tar.gz",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/SushiLab/mVIRs",
    "keywords": "bioinformatics metagenomics NGS alignment OPRs Prophages",
    "license": "GPLv3",
    "maintainer": "",
    "maintainer_email": "",
    "name": "mVIRs",
    "package_url": "https://pypi.org/project/mVIRs/",
    "platform": null,
    "project_url": "https://pypi.org/project/mVIRs/",
    "project_urls": {
      "Download": "https://github.com/SushiLab/mVIRs/archive/refs/tags/1.1.1.tar.gz",
      "Homepage": "https://github.com/SushiLab/mVIRs"
    },
    "release_url": "https://pypi.org/project/mVIRs/1.1.1/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "mVIRs: Localisation of inducible prophages using NGS data",
    "version": "1.1.1",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 13591038,
  "releases": {
    "1.1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "4dd511c02c2d65ab300cbcc266fb0fc7200934a996ac14518b8e3c78e901c373",
          "md5": "ed63f04073e6283f7c42c8ae4a26120a",
          "sha256": "72c775b444d3acef3a681b8f10aa51c72741db6c717021c43a949d73df738427"
        },
        "downloads": -1,
        "filename": "mVIRs-1.1.1.tar.gz",
        "has_sig": false,
        "md5_digest": "ed63f04073e6283f7c42c8ae4a26120a",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 37886,
        "upload_time": "2022-04-22T13:06:17",
        "upload_time_iso_8601": "2022-04-22T13:06:17.238099Z",
        "url": "https://files.pythonhosted.org/packages/4d/d5/11c02c2d65ab300cbcc266fb0fc7200934a996ac14518b8e3c78e901c373/mVIRs-1.1.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "4dd511c02c2d65ab300cbcc266fb0fc7200934a996ac14518b8e3c78e901c373",
        "md5": "ed63f04073e6283f7c42c8ae4a26120a",
        "sha256": "72c775b444d3acef3a681b8f10aa51c72741db6c717021c43a949d73df738427"
      },
      "downloads": -1,
      "filename": "mVIRs-1.1.1.tar.gz",
      "has_sig": false,
      "md5_digest": "ed63f04073e6283f7c42c8ae4a26120a",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 37886,
      "upload_time": "2022-04-22T13:06:17",
      "upload_time_iso_8601": "2022-04-22T13:06:17.238099Z",
      "url": "https://files.pythonhosted.org/packages/4d/d5/11c02c2d65ab300cbcc266fb0fc7200934a996ac14518b8e3c78e901c373/mVIRs-1.1.1.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}