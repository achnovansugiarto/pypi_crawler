{
  "info": {
    "author": "Hans-Joachim Ruscheweyh",
    "author_email": "hansr@ethz.ch",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 5 - Production/Stable",
      "Intended Audience :: Science/Research",
      "License :: OSI Approved :: GNU General Public License v3 (GPLv3)",
      "Operating System :: OS Independent",
      "Programming Language :: Python",
      "Programming Language :: Python :: 3",
      "Topic :: Scientific/Engineering :: Bio-Informatics"
    ],
    "description": "<p align=\"center\">\n<img src=\"img/mtags_logo.png\" width=\"500\"  />\n</p>\n\n# mTAGs: taxonomic profiling using degenerate consensus reference sequences of ribosomal RNA genes\n\n\n\n\n\n\n  * [Installation](#installation)\n    + [Installation using conda](#installation-using-conda)\n    + [Manual installation](#manual-installation)\n  * [Usage](#usage)\n    + [PROFILE](#profile)\n    + [MERGE](#merge)\n  * [Output Files](#output-files)\n    + [Profile file](#profile-file)\n    + [Single insert annotation](#single-insert-annotation)\n  * [Database](#database)\n  * [References](#references)\n\nmTAGs is a tool for the taxonomic profiling of metagenomes. It detects sequencing reads belonging to the small subunit of the ribosomal RNA (SSU-rRNA) gene and annotates them through the alignment to full-length degenerate consensus SSU-rRNA reference sequences. The tool is capable of processing single-end and pair-end metagenomic reads, takes advantage of the information contained in any region of the SSU-rRNA gene and provides relative abundance profiles at multiple taxonomic ranks (Domain, Phylum, Class, Order, Family, Genus and OTUs defined at a 97% sequence identity cutoff).\n\n\nThe tool is developed by Hans-Joachim Ruscheweyh and Guillem Salazar and distributed under the [![License GPL v3](https://img.shields.io/badge/license-GPL%20v3-blue.svg)](https://www.gnu.org/licenses/gpl-3.0.en.html).\n\n\nIf you use mTAGs, please cite:\n\n\n> Salazar G\\*, Ruscheweyh H-J\\*, Hildebrand F, Acinas S and Sunagawa S. **mTAGs: taxonomic profiling using degenerate\nconsensus reference sequences of ribosomal RNA gene.** *Bioinformatics*, 2021.\n\nAnalyses in the publication were executed using version 1.0.0\n\nQuestions/Comments? Write a github issue.\n\n## Installation\n\n\n`mTAGs` is written in `python` and has the following dependencies:\n\n\n- Python>=v3.7\n- [vsearch](https://github.com/torognes/vsearch/) (tested: v2.15.0)\n- [hmmer](http://hmmer.org/) (tested: v3.3)\n\n\n\n### Installation using conda\n\nThe easiest way to install mTAGs is to use the conda package manager, which will automatically create an environment with dependencies installed in the correct version.\n\n```bash\n$ conda create -n mtags python=3.7 hmmer vsearch\n$ source activate mtags\n# or\n$ conda activate mtags\n\n$ git clone https://github.com/SushiLab/mTAGs.git\n$ cd mTAGs\n$ pip install -e . \n\n# Download mTAGs database\n$ mtags download\n\n2021-06-21 12:02:40,294 INFO: Starting mTAGs\n2021-06-21 12:02:40,294 INFO: Start downloading the mTAGs database. ~600MB\n2021-06-21 12:05:17,883 INFO: Finished downloading the mTAGs database.\n2021-06-21 12:05:17,883 INFO: Finishing mTAGs\n\n$ mtags\n```\n<details><summary>mTAGs output</summary>\n<p>\n\n\n```bash\nProgram:    mTAGs - taxonomic profiling using degenerate consensus reference\n            sequences of ribosomal RNA gene\nVersion:    1.0.0\nReference:  Salazar, Ruscheweyh, et al. mTAGs: taxonomic profiling using\n            degenerate consensus reference sequences of ribosomal RNA\n            gene. Bioinformatics (2021)\n\nUsage: mtags <command> [options]\nCommand:\n\n-- General\n    profile     Extract and taxonomically annotate rRNA reads in metagenomic samples\n    merge       Merge profiles\n\n-- Expert\n    extract     Extract rRNA reads in metagenomic samples\n    annotate    Annotate and quantify rRNA reads\n\n-- Installation\n    download    Download the mTAGs database - Once after download of the tool\n\nThe database needs to be downloaded in the last step of the installation. This needs to be done once and before the first metagenomic samples can be processed:\n```\n\n</p>\n</details>\n\n\n### Manual installation\n\nManual installation is possible but not recommended. Install via pip after installation of dependencies:\n\n```bash\n$ git clone https://github.com/SushiLab/mTAGs.git\n$ cd mTAGs\n$ pip install -e . \n\n# Download mTAGs database\n$ mtags download\n\n2021-06-21 12:02:40,294 INFO: Starting mTAGs\n2021-06-21 12:02:40,294 INFO: Start downloading the mTAGs database. ~600MB\n2021-06-21 12:05:17,883 INFO: Finished downloading the mTAGs database.\n2021-06-21 12:05:17,883 INFO: Finishing mTAGs\n\n$ mtags\n```\n<details><summary>mTAGs output</summary>\n<p>\n\n\n```bash\nProgram:    mTAGs - taxonomic profiling using degenerate consensus reference\n            sequences of ribosomal RNA gene\nVersion:    1.0.0\nReference:  Salazar, Ruscheweyh, et al. mTAGs: taxonomic profiling using\n            degenerate consensus reference sequences of ribosomal RNA\n            gene. Bioinformatics (2021)\n\nUsage: mtags <command> [options]\nCommand:\n\n-- General\n    profile     Extract and taxonomically annotate rRNA reads in metagenomic samples\n    merge       Merge profiles\n\n-- Expert\n    extract     Extract rRNA reads in metagenomic samples\n    annotate    Annotate and quantify rRNA reads\n\n-- Installation\n    download    Download the mTAGs database - Once after download of the tool\n\nThe database needs to be downloaded in the last step of the installation. This needs to be done once and before the first metagenomic samples can be processed:\n```\n\n</p>\n</details>\n\n\n## Usage\n\nThe tool is split in to two steps: profiling and merging. The first step (`mtags profile [options]`) uses HMM models to extract potential rRNA sequences from metagenomic data and annotates them taxonomically through the alignment of these sequences against a modified Silva database. The second step (`mtags merge [options]`) is a function that merges taxonomic profiles from different metagenomic samples. The steps for extraction and annotation of rRNA sequences are grouped into a single command but can also be run independently (`mtags extract [options]` and `mtags annotate [options]`).\n\n\n\n### PROFILE\n\nThis step uses precomputed HMM models to extract rRNA sequences from a metagenomic sample. The rRNA sequences are then aligned against a clustered rRNA database to annotate sequences and profile samples. `mTAGs` takes as input fasta/fastq files with quality controlled sequencing data.\n\n\n\n```bash\n\n$ mtags profile\nProgram:    mTAGs - taxonomic profiling using degenerate consensus reference\n            sequences of ribosomal RNA gene\nVersion:    1.0.0\nReference:  Salazar, Ruscheweyh, et al. mTAGs: taxonomic profiling using\n            degenerate consensus reference sequences of ribosomal RNA\n            gene. Bioinformatics (2021)\n\nUsage: mtags profile [options]\n\nInput options:\n    -f  FILE [FILE ...]   Forward reads file. Can be fasta/fastq and gzipped.\n    -r  FILE [FILE ...]   Reverse reads file. Can be fasta/fastq and gzipped.\n    -s  FILE [FILE ...]   Single/merge reads file. Can be fasta/fastq and gzipped.\n\nOutput options:\n    -o  DIR               Output folder [Required]\n\nOther options:\n    -n  STR               Samplename [Required]\n    -t  INT               Number of threads. [4]\n    -ma INT               Maxaccepts, vsearch parameter. Larger\n                          numbers increase sensitivity and runtime. [1000]\n    -mr INT               Maxrejects, vsearch parameter. Larger\n                          numbers increase sensitivity and runtime. [1000]\n\n# Example usage of the mTAGs profile routine\n$ mtags profile -f sample.1.fq.gz -r sample.2.fq.gz -s sample.s.fq.gz sample.m.fq.gz -o output -t 4 -n sample -ma 1000 -mr 1000\n```\n<details><summary>mTAGs log</summary>\n<p>\n\n\n```bash\n2021-06-21 09:04:48,644 INFO: Starting mTAGs\n2021-06-21 09:04:48,646 INFO: Extracting FastA and revcomp FastA from input/sample.1.fq.gz\n2021-06-21 09:04:59,536 INFO: Processed reads:\t824523\n2021-06-21 09:04:59,536 INFO: Finished extracting. Found 824523 sequences.\n2021-06-21 09:04:59,536 INFO: Start detecting rRNA sequences in FastA files\n2021-06-21 09:04:59,536 INFO: Start detecting rRNA sequences for molecule=ssu\n2021-06-21 09:04:59,536 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.1.fq.gz_fw.fasta_ssu.hmmer --domtblout sample/sample.1.fq.gz_fw.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.1.fq.gz_fw.fasta\n2021-06-21 09:05:06,982 INFO: Finished hmmsearch\n2021-06-21 09:05:06,988 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.1.fq.gz_rev.fasta_ssu.hmmer --domtblout sample/sample.1.fq.gz_rev.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.1.fq.gz_rev.fasta\n2021-06-21 09:05:14,442 INFO: Finished hmmsearch\n2021-06-21 09:05:14,449 INFO: Finished detecting rRNA sequences for molecule=ssu\n2021-06-21 09:05:14,449 INFO: Start detecting rRNA sequences for molecule=lsu\n2021-06-21 09:05:14,450 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.1.fq.gz_fw.fasta_lsu.hmmer --domtblout sample/sample.1.fq.gz_fw.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.1.fq.gz_fw.fasta\n2021-06-21 09:05:35,255 INFO: Finished hmmsearch\n2021-06-21 09:05:35,266 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.1.fq.gz_rev.fasta_lsu.hmmer --domtblout sample/sample.1.fq.gz_rev.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.1.fq.gz_rev.fasta\n2021-06-21 09:05:55,845 INFO: Finished hmmsearch\n2021-06-21 09:05:55,859 INFO: Finished detecting rRNA sequences for molecule=lsu\n2021-06-21 09:05:55,859 INFO: Found 4143 potential rRNA sequences.\n2021-06-21 09:05:55,859 INFO: Finished detecting rRNA sequences from FastA files.\n2021-06-21 09:05:55,859 INFO: Finding best molecule for each read\n2021-06-21 09:05:55,867 INFO: Finished finding best molecule for each read\n2021-06-21 09:05:55,867 INFO: Start extracting reads/writing output\n2021-06-21 09:05:58,911 INFO: Processed reads:\t824523\n2021-06-21 09:05:58,912 INFO: Finished extracting reads/writing output\n2021-06-21 09:05:58,912 INFO: euk_lsu\t1571\n2021-06-21 09:05:58,912 INFO: bac_lsu\t1114\n2021-06-21 09:05:58,912 INFO: euk_ssu\t865\n2021-06-21 09:05:58,912 INFO: bac_ssu\t583\n2021-06-21 09:05:58,912 INFO: arc_lsu\t9\n2021-06-21 09:05:58,912 INFO: arc_ssu\t1\n2021-06-21 09:05:58,927 INFO: Extracting FastA and revcomp FastA from input/sample.2.fq.gz\n2021-06-21 09:06:10,001 INFO: Processed reads:\t824523\n2021-06-21 09:06:10,002 INFO: Finished extracting. Found 824523 sequences.\n2021-06-21 09:06:10,002 INFO: Start detecting rRNA sequences in FastA files\n2021-06-21 09:06:10,002 INFO: Start detecting rRNA sequences for molecule=ssu\n2021-06-21 09:06:10,002 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.2.fq.gz_fw.fasta_ssu.hmmer --domtblout sample/sample.2.fq.gz_fw.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.2.fq.gz_fw.fasta\n2021-06-21 09:06:17,074 INFO: Finished hmmsearch\n2021-06-21 09:06:17,084 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.2.fq.gz_rev.fasta_ssu.hmmer --domtblout sample/sample.2.fq.gz_rev.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.2.fq.gz_rev.fasta\n2021-06-21 09:06:24,016 INFO: Finished hmmsearch\n2021-06-21 09:06:24,022 INFO: Finished detecting rRNA sequences for molecule=ssu\n2021-06-21 09:06:24,022 INFO: Start detecting rRNA sequences for molecule=lsu\n2021-06-21 09:06:24,022 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.2.fq.gz_fw.fasta_lsu.hmmer --domtblout sample/sample.2.fq.gz_fw.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.2.fq.gz_fw.fasta\n2021-06-21 09:06:44,641 INFO: Finished hmmsearch\n2021-06-21 09:06:44,653 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.2.fq.gz_rev.fasta_lsu.hmmer --domtblout sample/sample.2.fq.gz_rev.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.2.fq.gz_rev.fasta\n2021-06-21 09:07:04,995 INFO: Finished hmmsearch\n2021-06-21 09:07:05,005 INFO: Finished detecting rRNA sequences for molecule=lsu\n2021-06-21 09:07:05,005 INFO: Found 4144 potential rRNA sequences.\n2021-06-21 09:07:05,005 INFO: Finished detecting rRNA sequences from FastA files.\n2021-06-21 09:07:05,005 INFO: Finding best molecule for each read\n2021-06-21 09:07:05,012 INFO: Finished finding best molecule for each read\n2021-06-21 09:07:05,012 INFO: Start extracting reads/writing output\n2021-06-21 09:07:08,038 INFO: Processed reads:\t824523\n2021-06-21 09:07:08,039 INFO: Finished extracting reads/writing output\n2021-06-21 09:07:08,039 INFO: euk_lsu\t1607\n2021-06-21 09:07:08,039 INFO: bac_lsu\t1121\n2021-06-21 09:07:08,039 INFO: euk_ssu\t833\n2021-06-21 09:07:08,039 INFO: bac_ssu\t577\n2021-06-21 09:07:08,039 INFO: arc_lsu\t5\n2021-06-21 09:07:08,039 INFO: arc_ssu\t1\n2021-06-21 09:07:08,055 INFO: Extracting FastA and revcomp FastA from input/sample.s.fq.gz\n2021-06-21 09:07:14,410 INFO: Processed reads:\t472552\n2021-06-21 09:07:14,410 INFO: Finished extracting. Found 472552 sequences.\n2021-06-21 09:07:14,410 INFO: Start detecting rRNA sequences in FastA files\n2021-06-21 09:07:14,410 INFO: Start detecting rRNA sequences for molecule=ssu\n2021-06-21 09:07:14,411 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.s.fq.gz_fw.fasta_ssu.hmmer --domtblout sample/sample.s.fq.gz_fw.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.s.fq.gz_fw.fasta\n2021-06-21 09:07:18,525 INFO: Finished hmmsearch\n2021-06-21 09:07:18,529 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.s.fq.gz_rev.fasta_ssu.hmmer --domtblout sample/sample.s.fq.gz_rev.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.s.fq.gz_rev.fasta\n2021-06-21 09:07:22,690 INFO: Finished hmmsearch\n2021-06-21 09:07:22,696 INFO: Finished detecting rRNA sequences for molecule=ssu\n2021-06-21 09:07:22,697 INFO: Start detecting rRNA sequences for molecule=lsu\n2021-06-21 09:07:22,697 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.s.fq.gz_fw.fasta_lsu.hmmer --domtblout sample/sample.s.fq.gz_fw.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.s.fq.gz_fw.fasta\n2021-06-21 09:07:34,547 INFO: Finished hmmsearch\n2021-06-21 09:07:34,554 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.s.fq.gz_rev.fasta_lsu.hmmer --domtblout sample/sample.s.fq.gz_rev.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.s.fq.gz_rev.fasta\n2021-06-21 09:07:46,666 INFO: Finished hmmsearch\n2021-06-21 09:07:46,675 INFO: Finished detecting rRNA sequences for molecule=lsu\n2021-06-21 09:07:46,675 INFO: Found 2236 potential rRNA sequences.\n2021-06-21 09:07:46,676 INFO: Finished detecting rRNA sequences from FastA files.\n2021-06-21 09:07:46,676 INFO: Finding best molecule for each read\n2021-06-21 09:07:46,679 INFO: Finished finding best molecule for each read\n2021-06-21 09:07:46,680 INFO: Start extracting reads/writing output\n2021-06-21 09:07:48,487 INFO: Processed reads:\t472552\n2021-06-21 09:07:48,488 INFO: Finished extracting reads/writing output\n2021-06-21 09:07:48,488 INFO: euk_lsu\t909\n2021-06-21 09:07:48,489 INFO: bac_lsu\t602\n2021-06-21 09:07:48,489 INFO: euk_ssu\t406\n2021-06-21 09:07:48,489 INFO: bac_ssu\t313\n2021-06-21 09:07:48,489 INFO: arc_lsu\t6\n2021-06-21 09:07:48,498 INFO: Extracting FastA and revcomp FastA from input/sample.m.fq.gz\n2021-06-21 09:08:04,216 INFO: Processed reads:\t1000000\n2021-06-21 09:08:16,996 INFO: Processed reads:\t1888111\n2021-06-21 09:08:16,997 INFO: Finished extracting. Found 1888111 sequences.\n2021-06-21 09:08:16,997 INFO: Start detecting rRNA sequences in FastA files\n2021-06-21 09:08:16,997 INFO: Start detecting rRNA sequences for molecule=ssu\n2021-06-21 09:08:16,997 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.m.fq.gz_fw.fasta_ssu.hmmer --domtblout sample/sample.m.fq.gz_fw.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.m.fq.gz_fw.fasta\n2021-06-21 09:08:39,040 INFO: Finished hmmsearch\n2021-06-21 09:08:39,051 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.m.fq.gz_rev.fasta_ssu.hmmer --domtblout sample/sample.m.fq.gz_rev.fasta_ssu.dom -E 0.01 mTAGs/data/ssu.hmm sample/sample.m.fq.gz_rev.fasta\n2021-06-21 09:09:00,018 INFO: Finished hmmsearch\n2021-06-21 09:09:00,036 INFO: Finished detecting rRNA sequences for molecule=ssu\n2021-06-21 09:09:00,036 INFO: Start detecting rRNA sequences for molecule=lsu\n2021-06-21 09:09:00,037 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.m.fq.gz_fw.fasta_lsu.hmmer --domtblout sample/sample.m.fq.gz_fw.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.m.fq.gz_fw.fasta\n2021-06-21 09:10:08,160 INFO: Finished hmmsearch\n2021-06-21 09:10:08,184 INFO: Executing:\thmmsearch --cpu 4 -o sample/sample.m.fq.gz_rev.fasta_lsu.hmmer --domtblout sample/sample.m.fq.gz_rev.fasta_lsu.dom -E 0.01 mTAGs/data/lsu.hmm sample/sample.m.fq.gz_rev.fasta\n2021-06-21 09:11:12,726 INFO: Finished hmmsearch\n2021-06-21 09:11:12,762 INFO: Finished detecting rRNA sequences for molecule=lsu\n2021-06-21 09:11:12,762 INFO: Found 10237 potential rRNA sequences.\n2021-06-21 09:11:12,762 INFO: Finished detecting rRNA sequences from FastA files.\n2021-06-21 09:11:12,762 INFO: Finding best molecule for each read\n2021-06-21 09:11:12,784 INFO: Finished finding best molecule for each read\n2021-06-21 09:11:12,784 INFO: Start extracting reads/writing output\n2021-06-21 09:11:16,805 INFO: Processed reads:\t1000000\n2021-06-21 09:11:20,280 INFO: Processed reads:\t1888111\n2021-06-21 09:11:20,282 INFO: Finished extracting reads/writing output\n2021-06-21 09:11:20,282 INFO: euk_lsu\t3713\n2021-06-21 09:11:20,282 INFO: bac_lsu\t3017\n2021-06-21 09:11:20,282 INFO: euk_ssu\t1902\n2021-06-21 09:11:20,282 INFO: bac_ssu\t1582\n2021-06-21 09:11:20,282 INFO: arc_lsu\t16\n2021-06-21 09:11:20,282 INFO: arc_ssu\t7\nFalse\n2021-06-21 09:11:20,334 INFO: Input files:\n2021-06-21 09:11:20,334 INFO: \tForward readfiles:\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.1.fq.gz_bac_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.1.fq.gz_euk_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.1.fq.gz_arc_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \tReverse readfiles:\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.2.fq.gz_euk_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.2.fq.gz_bac_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.2.fq.gz_arc_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \tSingle/Merged readfiles:\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.s.fq.gz_bac_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.s.fq.gz_euk_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.m.fq.gz_euk_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.m.fq.gz_bac_ssu.fasta\n2021-06-21 09:11:20,334 INFO: \t\tsample/sample.m.fq.gz_arc_ssu.fasta\n2021-06-21 09:11:20,334 INFO: Output pattern:\n2021-06-21 09:11:20,334 INFO: \tsample/sample\n2021-06-21 09:11:20,334 INFO: Reading and testing FastA files\n2021-06-21 09:11:20,355 INFO: Paired files stats:\n2021-06-21 09:11:20,355 INFO: \tFound 1682 inserts in paired files of which 1178 are actually paired and 504 are singletons\n2021-06-21 09:11:20,355 INFO: Singleton/Merged files stats:\n2021-06-21 09:11:20,355 INFO: \tFound 4210 inserts in singleton files.\n2021-06-21 09:11:20,355 INFO: Total stats:\n2021-06-21 09:11:20,355 INFO: \tPaired inserts:\t1178\n2021-06-21 09:11:20,355 INFO: \tSingleton inserts:\t4714\n2021-06-21 09:11:20,355 INFO: Finished reading and testing FastA files\n2021-06-21 09:11:20,356 INFO: Writing paired sequences to FastA:\tsample/sample.pe.fasta\n2021-06-21 09:11:20,358 INFO: Writing finished\n2021-06-21 09:11:20,358 INFO: Writing singleton sequences to FastA:\tsample/sample.se.fasta\n2021-06-21 09:11:20,363 INFO: Writing finished\n2021-06-21 09:11:20,363 INFO: Aligning paired sequence file:\tvsearch --usearch_global sample/sample.pe.fasta --db SILVA-138_NR-97_complink_cons.vsearch.udb --id 0.97 --maxaccepts 1000 --maxrejects 1000 --strand both --userout sample/sample.pe.m8 --userfields query+target+qcov+id+qilo+qihi+tilo+tihi+alnlen+ids+mism+gaps+qstrand --query_cov 0.5 --threads 4 --output_no_hits\nvsearch v2.15.0_macos_x86_64, 16.0GB RAM, 4 cores\nhttps://github.com/torognes/vsearch\n\nReading UDB file SILVA-138_NR-97_complink_cons.vsearch.udb 100%\nReorganizing data in memory 100%\nCreating bitmaps 100%\nParsing abundances 100%\n341368570 nt in 233519 seqs, min 900, max 3718, avg 1462\nSearching 100%\nMatching unique query sequences: 1890 of 2356 (80.22%)\n2021-06-21 09:13:26,382 INFO: Finished alignment\n2021-06-21 09:13:26,383 INFO: Aligning singleton sequence file:\tvsearch --usearch_global sample/sample.se.fasta --db SILVA-138_NR-97_complink_cons.vsearch.udb --id 0.97 --maxaccepts 1000 --maxrejects 1000 --strand both --userout sample/sample.se.m8 --userfields query+target+qcov+id+qilo+qihi+tilo+tihi+alnlen+ids+mism+gaps+qstrand --query_cov 0.5 --threads 4 --output_no_hits\nvsearch v2.15.0_macos_x86_64, 16.0GB RAM, 4 cores\nhttps://github.com/torognes/vsearch\n\nReading UDB file SILVA-138_NR-97_complink_cons.vsearch.udb 100%\nReorganizing data in memory 100%\nCreating bitmaps 100%\nParsing abundances 100%\n341368570 nt in 233519 seqs, min 900, max 3718, avg 1462\nSearching 100%\nMatching unique query sequences: 3644 of 4714 (77.30%)\n2021-06-21 09:19:54,957 INFO: Finished alignment\n2021-06-21 09:19:54,958 INFO: Parsing alignment files\n2021-06-21 09:20:09,033 INFO: Finished parsing alignment files\n2021-06-21 09:20:09,033 INFO: Filtering alignments by score and length\n2021-06-21 09:20:10,883 INFO: Finished filtering\n2021-06-21 09:20:10,883 INFO: Performing LCA calculations\n2021-06-21 09:20:14,174 INFO: Finished LCA calculations\n2021-06-21 09:20:14,174 INFO: Start writing output files\n2021-06-21 09:20:14,174 INFO: Start writing:\tsample/sample.bins\n2021-06-21 09:20:14,631 INFO: Start writing:\tsample/sample.otu.tsv\n2021-06-21 09:20:14,759 INFO: Start writing:\tsample/sample.genus.tsv\n2021-06-21 09:20:14,763 INFO: Start writing:\tsample/sample.family.tsv\n2021-06-21 09:20:14,765 INFO: Start writing:\tsample/sample.order.tsv\n2021-06-21 09:20:14,766 INFO: Start writing:\tsample/sample.class.tsv\n2021-06-21 09:20:14,766 INFO: Start writing:\tsample/sample.phylum.tsv\n2021-06-21 09:20:14,767 INFO: Start writing:\tsample/sample.domain.tsv\n2021-06-21 09:20:14,767 INFO: Start writing:\tsample/sample.root.tsv\n2021-06-21 09:20:14,768 INFO: Finished writing output files\n2021-06-21 09:20:15,178 INFO: Finished annotate command\n2021-06-21 09:20:15,178 INFO: mTAGs finished successfully\n```\n\n</p>\n</details>\n\n \n\n\n### MERGE\n\nThe previous step produces taxonomic profiles for different samples. It is useful for downstream analysis to have multiple profiles in one file. The merge function combines multiple profiles into a tab-separated file with each column representating a sample:\n\n```bash\n$  mtags merge\n\n2021-06-21 10:01:33,628 INFO: Starting mTAGs\nProgram:    mTAGs - taxonomic profiling using degenerate consensus reference\n            sequences of ribosomal RNA gene\nVersion:    1.0.0\nReference:  Salazar, Ruscheweyh, et al. mTAGs: taxonomic profiling using\n            degenerate consensus reference sequences of ribosomal RNA\n            gene. Bioinformatics (2021)\n\nUsage: mtags merge [options]\n\nInput options:\n    -i  FILE [FILE ...]   List of mTAGs bin files [Required]\n\nOutput options:\n    -o  STR               Output prefix [Required]\n                      \n$ mtags merge -i *bins -o merged_profile\n\n# Example usage of mTAGs merge:\n\n$ mtags merge -i mtags2/*bins -o out\n2021-06-21  16:36:06,642 INFO: Starting mTAGs\n2021-06-21  16:36:06,642 INFO: Executing command merge\n2021-06-21  16:36:06,676 INFO: Finished reading sample1.mTAG.bins. Found 35405 inserts.\n2021-06-21  16:36:06,691 INFO: Finished reading sample2.mTAG.bins. Found 16265 inserts.\n2021-06-21  16:36:06,718 INFO: Finished reading sample3.mTAG.bins. Found 25680 inserts.\n2021-06-21  16:36:06,749 INFO: Finished reading sample4.mTAG.bins. Found 34954 inserts.\n\n```\n\n\n\n## Output Files\n\nThe tool produces two types of output, the taxonomic profiles (`*.tsv`) and the annotation of every insert (`*.bins`).\n\n### Profile file\n\nThe tool produces profiles for 8 taxonomic ranks:\n\n- otu\n- genus\n- family\n- order\n- class\n- phylum\n- domain\n- root\n\nAll levels but the otu and the root levels are standard Silva level names. The root level was added to group all domains. The otu level entries represent taxonomic units that were generated by complete linkage clustering of distances between all sequences inside the respective genus.\n\nThe otu level is comprised of a complete taxonomic path plus the name of the otu (e.g. `otu__silva_138_complink_cons_otu_215825`) and the number of inserts that map to this otu. The output of a file looks the following:\n\n```\nroot__Root;domain__Archaea;phylum__Euryarchaeota;class__Methanobacteria;order__Methanobacteriales;family__Methanobacteriaceae;genus__Methanobrevibacter;otu__silva_138_complink_cons_otu_128716\t1\nroot__Root;domain__Bacteria;phylum__Actinobacteriota;class__Actinobacteria;order__Corynebacteriales;family__Mycobacteriaceae;genus__Mycobacterium;otu__silva_138_complink_cons_otu_99206\t1\nroot__Root;domain__Bacteria;phylum__Proteobacteria;class__Alphaproteobacteria;order__Rickettsiales;family__Mitochondria;genus__unknown;otu__silva_138_complink_cons_otu_102401\t1\nroot__Root;domain__Bacteria;phylum__Proteobacteria;class__Alphaproteobacteria;order__Rickettsiales;family__Mitochondria;genus__unknown;otu__silva_138_complink_cons_otu_133706\t1\nroot__Root;domain__Bacteria;phylum__Proteobacteria;class__Gammaproteobacteria;order__Burkholderiales;family__Comamonadaceae;genus__Comamonas;otu__silva_138_complink_cons_otu_29404\t1\nroot__Root;domain__Eukaryota;phylum__Basidiomycota;class__Agaricomycetes;order__unknown;family__unknown;genus__unknown;otu__silva_138_complink_cons_otu_187209\t4\nroot__Root;domain__Eukaryota;phylum__Basidiomycota;class__Agaricomycetes;order__unknown;family__unknown;genus__unknown;otu__silva_138_complink_cons_otu_215825\t16\nUnaligned\t427\nUnassigned\t738\n```\n\nThe two last rows represent all sequences that could not be aligned or that could be aligned but could not be assigned at this taxonomic level. For almost all downstream analyses, it is better to remove this value, since it does not represent a single taxa but it needs to be taken into account when computing relative abundances.\n\nThe output for the phylum level then looks the following:\n\n```\nroot__Root;domain__Archaea;phylum__Euryarchaeota\t1\nroot__Root;domain__Bacteria;phylum__Actinobacteriota\t2\nroot__Root;domain__Bacteria;phylum__Firmicutes\t1\nroot__Root;domain__Bacteria;phylum__Proteobacteria\t5\nroot__Root;domain__Eukaryota;phylum__Apicomplexa\t1\nroot__Root;domain__Eukaryota;phylum__Ascomycota\t57\nroot__Root;domain__Eukaryota;phylum__Basidiomycota\t1310\nroot__Root;domain__Eukaryota;phylum__Phragmoplastophyta\t1\nroot__Root;domain__Eukaryota;phylum__uncultured\t1\nroot__Root;domain__Eukaryota;phylum__unknown\t6\nUnaligned\t427\nUnassigned\t47\n```\n\nThe file with merged profiles has one column per sample.\n\n### Single insert annotation\n\nThe `*.bins` file with the taxonomic annotation of each insert looks the following:\n\n`INSERTNAME\tRANK\tPATH`\n\n```\nHISEQ:384:HCVGNBCXY:2:2212:4002:35447   domain  root__Root;domain__Unaligned\nHISEQ:384:HCVGNBCXY:1:1102:14918:19710  order   root__Root;domain__Eukaryota;phylum__Basidiomycota;class__Agaricomycetes;order__Polyporales\nHISEQ:384:HCVGNBCXY:1:1102:9303:55752   domain  root__Root;domain__Unaligned\nHISEQ:384:HCVGNBCXY:1:1102:17349:43609  class   root__Root;domain__Eukaryota;phylum__Basidiomycota;class__Agaricomycetes\nHISEQ:384:HCVGNBCXY:1:1102:14716:53354  phylum  root__Root;domain__Eukaryota;phylum__Basidiomycota\nHISEQ:384:HCVGNBCXY:1:1103:7884:25295   otu     root__Root;domain__Eukaryota;phylum__Basidiomycota;class__Agaricomycetes;order__Polyporales;family__unknown;genus__Postia;otu__silva_138_complink_cons_otu_15163\nHISEQ:384:HCVGNBCXY:1:1103:19448:91267  otu     root__Root;domain__Eukaryota;phylum__Basidiomycota;class__Agaricomycetes;order__Agaricales;family__Tricholomataceae;genus__Leucopaxillus;otu__silva_138_complink_cons_otu_14867\nHISEQ:384:HCVGNBCXY:1:1103:2033:80107   domain  root__Root;domain__Unaligned\nHISEQ:384:HCVGNBCXY:1:1103:14200:48593  family  root__Root;domain__Eukaryota;phylum__Ascomycota;class__Sordariomycetes;order__Xylariales;family__unknown\n```\n\n## Database\n\nThe default database of mTAGs is a modified version of the Silva release 138. We cluster the database at genus level using a complete linkage algorithm on pairwise distances and then build one consensus sequence per cluster. We also generated a database from Silva release 128 using the same strategy for reproducibility reasons. However, **we encourage users to perform their analysis with most recent database version**, which is the one installed by default through the `mtags download` command.\n\nIf users need to use the Silva release 128 (NOT RECOMMENDED) they can do it by using the following commands:\n\n```bash\n# Use Silva release 128\n\n$ cd mTAGs\n\n# move default database \n$ mv db db_r138\n# create database folder for release 128\n$ mkdir db\n$ cd db\n$ wget https://sunagawalab.ethz.ch/share/MTAGS_DB/silva/s128/SILVA-128_NR-97_complink_cons.vsearch.udb.gz\n$ wget https://sunagawalab.ethz.ch/share/MTAGS_DB/silva/s128/SILVA-128_NR-97_complink_cons.taxmap.gz\n$ gunzip *gz\n$ touch download.done\n```\nUsing mTAGs will now use release version 128 of the database.\n\n\n## References\n\n\nSilva:\n\n**Quast C, Pruesse E, Yilmaz P, Gerken J, Schweer T, Yarza P, Peplies J, Glöckner FO** (2013) *The SILVA ribosomal RNA gene database project: improved data processing and web-based tools.* Nucl. Acids Res. 41 (D1): D590-D596.\n\nVsearch:\n\n**Rognes T, Flouri T, Nichols B, Quince C, Mahé F.** (2016) *VSEARCH: a versatile open source tool for metagenomics.* PeerJ 4:e2584. doi: 10.7717/peerj.2584\n\n\nHmmer:\n\n**S. R. Eddy.** *Accelerated profile HMM searches.* PLOS Comp. Biol., 7:e1002195, 2011.\n\nBioconda:\n\n**Grüning, Björn, Ryan Dale, Andreas Sjödin, Brad A. Chapman, Jillian Rowe, Christopher H. Tomkins-Tinch, Renan Valieris, the Bioconda Team, and Johannes Köster.** 2018. *Bioconda: Sustainable and Comprehensive Software Distribution for the Life Sciences.* Nature Methods, 2018 doi:10.1038/s41592-018-0046-7.\n\nBiopython:\n\n**Cock PA, Antao T, Chang JT, Chapman BA, Cox CJ, Dalke A, Friedberg I, Hamelryck T, Kauff F, Wilczynski B and de Hoon MJL** (2009) *Biopython: freely available Python tools for computational molecular biology and bioinformatics.* Bioinformatics, 25, 1422-1423\n\n\n\n\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "https://github.com/SushiLab/mTAGs/archive/refs/tags/1.0.4.tar.gz",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/SushiLab/mTAGs",
    "keywords": "bioinformatics metagenomics ngs 16S",
    "license": "GPLv3",
    "maintainer": "",
    "maintainer_email": "",
    "name": "mTAGs",
    "package_url": "https://pypi.org/project/mTAGs/",
    "platform": "",
    "project_url": "https://pypi.org/project/mTAGs/",
    "project_urls": {
      "Download": "https://github.com/SushiLab/mTAGs/archive/refs/tags/1.0.4.tar.gz",
      "Homepage": "https://github.com/SushiLab/mTAGs"
    },
    "release_url": "https://pypi.org/project/mTAGs/1.0.4/",
    "requires_dist": null,
    "requires_python": "",
    "summary": "mTAGs - taxonomic profiling using degenerate consensus reference sequences of ribosomal RNA gene.",
    "version": "1.0.4",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 11516513,
  "releases": {
    "1.0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "9eab609ae690ce95a032124a8ff6ed92d460c425758c5cd8d829521583ab26ee",
          "md5": "0f090c2ab19f4942d85169406700aea3",
          "sha256": "e448d35d0db20b5aba5469e42e37d47729c9fee89b71be0dd682844b7caefd4d"
        },
        "downloads": -1,
        "filename": "mTAGs-1.0.3.tar.gz",
        "has_sig": false,
        "md5_digest": "0f090c2ab19f4942d85169406700aea3",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 938102,
        "upload_time": "2021-09-22T09:28:50",
        "upload_time_iso_8601": "2021-09-22T09:28:50.705760Z",
        "url": "https://files.pythonhosted.org/packages/9e/ab/609ae690ce95a032124a8ff6ed92d460c425758c5cd8d829521583ab26ee/mTAGs-1.0.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.4": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "50fa464949e6d182972d9375fa4b6b550e13192c92451b33ca7f5a4a48b15e95",
          "md5": "559d6f684ea6a19a1d3c84e93625f74d",
          "sha256": "3f56def2495d47487da7159204b9703b566863d3cee19a5843e02857e5461a43"
        },
        "downloads": -1,
        "filename": "mTAGs-1.0.4.tar.gz",
        "has_sig": false,
        "md5_digest": "559d6f684ea6a19a1d3c84e93625f74d",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 945536,
        "upload_time": "2021-09-22T10:04:26",
        "upload_time_iso_8601": "2021-09-22T10:04:26.208041Z",
        "url": "https://files.pythonhosted.org/packages/50/fa/464949e6d182972d9375fa4b6b550e13192c92451b33ca7f5a4a48b15e95/mTAGs-1.0.4.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "50fa464949e6d182972d9375fa4b6b550e13192c92451b33ca7f5a4a48b15e95",
        "md5": "559d6f684ea6a19a1d3c84e93625f74d",
        "sha256": "3f56def2495d47487da7159204b9703b566863d3cee19a5843e02857e5461a43"
      },
      "downloads": -1,
      "filename": "mTAGs-1.0.4.tar.gz",
      "has_sig": false,
      "md5_digest": "559d6f684ea6a19a1d3c84e93625f74d",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 945536,
      "upload_time": "2021-09-22T10:04:26",
      "upload_time_iso_8601": "2021-09-22T10:04:26.208041Z",
      "url": "https://files.pythonhosted.org/packages/50/fa/464949e6d182972d9375fa4b6b550e13192c92451b33ca7f5a4a48b15e95/mTAGs-1.0.4.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}