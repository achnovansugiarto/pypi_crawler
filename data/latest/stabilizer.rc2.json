{
  "info": {
    "author": "flowerpot-ai",
    "author_email": "vignesh.sbaskaran@gmail.com",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: MIT License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3"
    ],
    "description": "# Stabilizer\n### Stabilize and achieve excellent performance with transformers.  \nThe stabilizer library offer solutions to tackle one of the biggest challenges that comes along with training State of the art Transformer models, **Unstable training**\n\n## Unstable training\nUnstable training is the phenomenon in which training large transformer models with trivial changes such as changing the random seed drastically changes the performance of the model. Here is a screenshot of finetuning the CoLA dataset from GLUE tasks with two different random seeds applied only to the dropout of the transformer model.\n\n![dropout_random_seed](https://i.ibb.co/jyx3tLT/baseline-dropout-seed.png)\n\n## Installation\n`pip install stabilizer`\n\n\n## Techniques currently implemented in this library\n1. Reinitialization\n2. Layerwise Learning Rate Decay\n\n\n### Reinitialization\nReinitialize the last `n` layers of the transformer encoder. This technique works well because we reinitialize the task specific parameters that the pretrained models have learnt specific to the pretraining task.\n```python\nfrom stabilizer.reinitialize import reinit_autoencoder_model\nfrom transformers import AutoModel\n\ntransformer = AutoModel.from_pretrained(\n    pretrained_model_name_or_path=\"bert-base-uncased\",\n    hidden_dropout_prob=0.1,\n    attention_probs_dropout_prob=0.1,\n)\ntransformer.encoder = reinit_autoencoder_model(\n    transformer.encoder, reinit_num_layers=1\n)\n```\nHere is the result of the same model but reinitialized last 4 layers applied on the CoLA dataset. You can see that the model has converged to almost the same performance with reinitialization.\n![reinit_random_seed](https://i.ibb.co/1MyPbfG/reinit-dropout-seed.png)\n\n\n\n### Layerwise Learning Rate Decay\nApply layerwise learning rate to the transformer layers. Starting from the task specific layer every layer before it gets an exponentially decreasing learning rate. \n\n\n```python\n\nfrom stabilizer.llrd import get_optimizer_parameters_with_llrd\nfrom stabilizer.model import PoolerClassifier\n\nfrom transformers import AdamW, AutoModel\n\n\n    transformer = AutoModel.from_pretrained(\n        pretrained_model_name_or_path=config[\"pretrained_model_name_or_path\"],\n        hidden_dropout_prob=config[\"dropout_prob\"],\n        attention_probs_dropout_prob=config[\"dropout_prob\"],\n    )\n\n    model = PoolerClassifier(\n        transformer=transformer,\n        transformer_output_size=transformer.config.hidden_size,\n        transformer_output_dropout_prob=config[\"dropout_prob\"],\n        num_classes=config[\"num_classes\"],\n        task_specific_layer_seed=config[\"layer_initialization_seed\"],\n    )\n\n    model_parameters = get_optimizer_parameters_with_llrd(\n        model=model,\n        peak_lr=config[\"lr\"],\n        multiplicative_factor=config[\"multiplicative_factor\"],\n    )\n    optimizer = AdamW(params=model_parameters, lr=config[\"lr\"])\n\n\n```\n\nHere is the result of the same model but with LLRD applied on the CoLA dataset. Here you can see that the model has diverged quite a lot by applying LLRD. Therefore as we discussed earlier their is no universal remedy yet but some techniques work well on some datasets\n![llrd_random_seed](https://i.ibb.co/jkLJSP0/llrd-dropout-seed.png)\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/flowerpot-ai/stabilizer",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "stabilizer",
    "package_url": "https://pypi.org/project/stabilizer/",
    "platform": "",
    "project_url": "https://pypi.org/project/stabilizer/",
    "project_urls": {
      "Homepage": "https://github.com/flowerpot-ai/stabilizer"
    },
    "release_url": "https://pypi.org/project/stabilizer/1.0.2/",
    "requires_dist": [
      "torch (==1.9.0)",
      "pandas (==1.3.1)",
      "scikit-learn (==0.24.2)",
      "transformers (==4.10.0)"
    ],
    "requires_python": ">=3.7",
    "summary": "Stabilize and achieve excellent performance with transformers",
    "version": "1.0.2",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 11536651,
  "releases": {
    "1.0.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "535f53104db55ac7ef939d33dfa32d881a8c971c0125228f018078e2f42c3f0a",
          "md5": "b65cb4a9f9442c80856df9b8593dd299",
          "sha256": "72e8e6e5a7c25a533e797f6a9daf113b800345b5e6136999f21a50f1473cd4fc"
        },
        "downloads": -1,
        "filename": "stabilizer-1.0.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "b65cb4a9f9442c80856df9b8593dd299",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 9700,
        "upload_time": "2021-09-24T07:44:35",
        "upload_time_iso_8601": "2021-09-24T07:44:35.340613Z",
        "url": "https://files.pythonhosted.org/packages/53/5f/53104db55ac7ef939d33dfa32d881a8c971c0125228f018078e2f42c3f0a/stabilizer-1.0.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "aee9ead573381a17c98bf5cc1c675bcf9b22428d9427fdbb8725d9dd78e00aaa",
          "md5": "af48293fa4a855f0e6749fae8b8b0ff2",
          "sha256": "3c52e32574c073af2f98ec4776e180c05804c635a2af197769c92cd0b79f9d84"
        },
        "downloads": -1,
        "filename": "stabilizer-1.0.0.tar.gz",
        "has_sig": false,
        "md5_digest": "af48293fa4a855f0e6749fae8b8b0ff2",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 6060,
        "upload_time": "2021-09-24T07:44:39",
        "upload_time_iso_8601": "2021-09-24T07:44:39.610619Z",
        "url": "https://files.pythonhosted.org/packages/ae/e9/ead573381a17c98bf5cc1c675bcf9b22428d9427fdbb8725d9dd78e00aaa/stabilizer-1.0.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "459ae65f2e3b7a634dd6a805beb489978efece60e36ecc69f1577cbecedd9eef",
          "md5": "cc2cc769532e272823a54e814c72f984",
          "sha256": "6f1a67c66a01c3c5d8bf1efc98f89534032c16351cc703b26b891bca245a9983"
        },
        "downloads": -1,
        "filename": "stabilizer-1.0.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "cc2cc769532e272823a54e814c72f984",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 9699,
        "upload_time": "2021-09-24T07:44:37",
        "upload_time_iso_8601": "2021-09-24T07:44:37.873652Z",
        "url": "https://files.pythonhosted.org/packages/45/9a/e65f2e3b7a634dd6a805beb489978efece60e36ecc69f1577cbecedd9eef/stabilizer-1.0.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "6f51d601bf31cdf5072bea92826e563ab38cc23775dcce94d588a2b09e106b19",
          "md5": "18ce7873a9aef087c38166589b650e1c",
          "sha256": "91cae36bfff7b7e9ff921f28d455fb84be0c258fe670951eeac6fa55895ea065"
        },
        "downloads": -1,
        "filename": "stabilizer-1.0.2.tar.gz",
        "has_sig": false,
        "md5_digest": "18ce7873a9aef087c38166589b650e1c",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 6049,
        "upload_time": "2021-09-24T07:44:41",
        "upload_time_iso_8601": "2021-09-24T07:44:41.208019Z",
        "url": "https://files.pythonhosted.org/packages/6f/51/d601bf31cdf5072bea92826e563ab38cc23775dcce94d588a2b09e106b19/stabilizer-1.0.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "459ae65f2e3b7a634dd6a805beb489978efece60e36ecc69f1577cbecedd9eef",
        "md5": "cc2cc769532e272823a54e814c72f984",
        "sha256": "6f1a67c66a01c3c5d8bf1efc98f89534032c16351cc703b26b891bca245a9983"
      },
      "downloads": -1,
      "filename": "stabilizer-1.0.2-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "cc2cc769532e272823a54e814c72f984",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7",
      "size": 9699,
      "upload_time": "2021-09-24T07:44:37",
      "upload_time_iso_8601": "2021-09-24T07:44:37.873652Z",
      "url": "https://files.pythonhosted.org/packages/45/9a/e65f2e3b7a634dd6a805beb489978efece60e36ecc69f1577cbecedd9eef/stabilizer-1.0.2-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "6f51d601bf31cdf5072bea92826e563ab38cc23775dcce94d588a2b09e106b19",
        "md5": "18ce7873a9aef087c38166589b650e1c",
        "sha256": "91cae36bfff7b7e9ff921f28d455fb84be0c258fe670951eeac6fa55895ea065"
      },
      "downloads": -1,
      "filename": "stabilizer-1.0.2.tar.gz",
      "has_sig": false,
      "md5_digest": "18ce7873a9aef087c38166589b650e1c",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7",
      "size": 6049,
      "upload_time": "2021-09-24T07:44:41",
      "upload_time_iso_8601": "2021-09-24T07:44:41.208019Z",
      "url": "https://files.pythonhosted.org/packages/6f/51/d601bf31cdf5072bea92826e563ab38cc23775dcce94d588a2b09e106b19/stabilizer-1.0.2.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}