{
  "info": {
    "author": "Anthony Harrison",
    "author_email": "anthony.p.harrison@gmail.com",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 3 - Alpha",
      "Intended Audience :: Developers",
      "License :: OSI Approved :: MIT License",
      "Natural Language :: English",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3.10",
      "Programming Language :: Python :: 3.11",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Programming Language :: Python :: 3.9",
      "Programming Language :: Python :: Implementation :: CPython",
      "Programming Language :: Python :: Implementation :: PyPy"
    ],
    "description": "# CSAF-Tool\n\nThe CSAF-Tool generates a [CSAF 2.0 file](https://www.csaf.io) including product tree and vulnerabilities associated with products\nspecified in the product tree. It can also be used to generate a human-readable output of a CSAF document.\n\n## Installation\n\nTo install use the following command:\n\n`pip install csaf-tool`\n\nAlternatively, just clone the repo and install dependencies using the following command:\n\n`pip install -U -r requirements.txt`\n\nThe tool requires Python 3 (3.7+). It is recommended to use a virtual python environment especially\nif you are using different versions of python. `virtualenv` is a tool for setting up virtual python environments which\nallows you to have all the dependencies for the tool set up in a single environment, or have different environments set\nup for testing using different versions of Python.\n\n## Usage\n\n```\nusage: csaf-tool [-h] [-g] [-i INPUT_FILE] [-p PRODUCT] [-v VULNERABILITIES] [-t TITLE] [--header HEADER] [--id ID] [-C CONFIG] [-o OUTPUT_FILE] [-V]\n\nCSAF-tool generates a CSAF 2.0 file including product tree and vulnerabilities associated with products specified in the product tree.\n\noptions:\n  -h, --help            show this help message and exit\n  -C CONFIG, --config CONFIG\n                        name of config file\n  -V, --version         show program's version number and exit\n\nInput:\n  -g, --generate        generate CSAF file\n  -i INPUT_FILE, --input-file INPUT_FILE\n                        CSAF filename to be analysed\n  -p PRODUCT, --product PRODUCT\n                        product tree\n  -v VULNERABILITIES, --vulnerabilities VULNERABILITIES\n                        list of vulnerabilities\n  -t TITLE, --title TITLE\n                        CSAF title\n  --header HEADER       CSAF heading\n  --id ID               CSAF document identifier\n\n\nOutput:\n  -o OUTPUT_FILE, --output-file OUTPUT_FILE\n                        CSAF filename\n```\n\n## Operation\n\nThe CSAF tool can be used as a command line tool to generate or analyse a CSAF document. It can also be used as a Python library\nto programmatically generate a CSAF document.\n\n### CSAF Generation using command line\n\nThe `--generate` option is used to indicate that a CSAF file is to be produced.\n\nThe following parameters are mandatory:\n\n1. The `--product` option is used to specify the products to be included in the CSAF product tree. The file\nis a CSV file and consists of one entry per line per product which specifies the product name, the name of the vendor and the release.\nMultiple releases of a product should be specified as separate entries. The first line of the file contains the\nheader `product,vendor,release`. The following is an example product file.\n\n```\nproduct,vendor,release\nproduct_1,AVendor,1.1\nproduct_1,AVendor,1.2\nproduct_1,AVendor,2.0\nproduct_2,AVendor1,1\nproduct_3,AVendor,2022H2\n\n```\n\n2. The `--vulnerabilities` option is used to specify the vulnerabilities to be included in the CSAF document. The file\nis a CSV file and consists of one entry per line per vulnerability which specifies the product name, the release of the product,\nthe identity of the vulnerability (e.g. CVE number), a brief description of the vulnerability, the status of the vulnerability (one of\n\"mitigation\", \"no_fix_planned\", \"none_available\", \"vendor_fix\" or \"workaround\") and an associated comment. Multiple vulnerabilities for a product should be specified as separate entries. The first line of the file contains the\nheader `product,release,id,description,status,comment`. The following is an example vulnerabilities file.\n\n```\nproduct,release,id,description,status,comment\nproduct_1,1.1,CVE-2020-1234,This is a simple description,vendor_fix,Customers should upgrade to the latest version of the product\nproduct_1,1.1,CVE-2020-9876,This is another vulnerabilty description,none_available,Still under investigation\n```\n\n3. The `--output-file` option is used to specify the filename for the generated CSAF document.\n\nThe `--header` option is used to specify a title for the document generated by the tool. It is recommended that this is\nsufficiently unique to distinguish it from similar documents.\n\nThe `--title` option is used to provide a brief summary note of the document generated by the tool.\n\nThe `--id` option is used to provide a unique document identifier for the document. If this is not provided a default\nidentifier of _**CSAF-Document-YYYYMMDDHHMMSS**_ is used.\n\nThe `--config` option is used to specify the [configuration file](#configuration-file) to be used.\nThis is required when the  `--generate` option is specified and is used to specify static information included\nin the CSAF document. If this is not specified, a default filename of _**csaf.ini**_ in the current directory shall be assumed.\nIf the filename cannot be found, default values shall be used in the generation of the document.\n\nExample usage:\n\n```\ncsaf-tool --generate --product product.csv --vulnerabilities vulnerability.csv --id \"Avendor-advisory-0004\" --title \"Technical summary\" --header \"Product backdoor identified\" --output-file \"test-csaf.json\"\n```\n\nThere is no output unless an error is detected due to missing parameters e.g.\n\n```\n[ERROR] Vulnerabilties filename not specified\n```\n\n#### Configuration File\n\nA configuration file is used to specify a number of fixed parameters to be used in the generation of the CSAF document. The following is an example file.\n\n```\n# CSAF configuration file\n[publisher]\n# This is a comment which is ignored\ncategory = vendor\nname = Organisation\nurl = https://psirt.example.com\n```\n\nComments are indicated by lines starting with '#'. All content is ignored.\n\nThe options are grouped into a single section **publisher**.\n\nThe following options are supported:\n\n- *category* is used to specify the type of organisation publishing the CSAF document. Valid values for this are\n\"coordinator\", \"discoverer\", \"other\", \"translator\", \"user\" or \"vendor\"\n\n- *name* is used to specify the name of organisation publishing the CSAF document.\n\n- *url* is used to specify a URL under the control of the organisation publishing the CSAF document.\n\n\n### CSAF Analysis using command line\n\nThe `--input-file` option is used to specify the name of the CSAF document to be analysed by the tool.\n\nOther parameters will be ignored.\n\nExample usage:\n\n```\ncsaf-tool --input-file test_pv.json\n```\n\nSample output\n\n```\n                                                                                                                                             1 ⨯\n╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮\n│ CSAF HEADER                                                                                                                                                                                │\n╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯\n┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃ Item                            ┃ Details                                ┃\n┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ CSAF Version                    │ 2.0                                    │\n│ Title                           │ Product backdoor identified            │\n│ Category                        │ csaf_vex                               │\n│ Date                            │ 2022-12-09T15-58-39Z                   │\n│ Technical summary               │ Auto generated CSAF document           │\n│ Publisher                       │ Organisation https://psirt.example.com │\n│ Generator                       │ csaf-tool version 0.1.0                │\n│ Id                              │ CSAF-Document-20221209155839           │\n│ Revision 1 2022-12-09T15-58-39Z │ Initial version                        │\n│ Status                          │ final                                  │\n│ Version                         │ 1                                      │\n└─────────────────────────────────┴────────────────────────────────────────┘\n╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮\n│ PRODUCT TREE                                                                                                                                                                               │\n╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯\n┏━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┓\n┃ Family ┃ Product   ┃ Vendor   ┃ Release ┃\n┡━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━┩\n│        │ product_1 │ AVendor  │ 1.1     │\n│        │ product_1 │ AVendor  │ 1.2     │\n│        │ product_1 │ AVendor  │ 2.0     │\n│        │ product_2 │ AVendor1 │ 1       │\n│        │ product_3 │ AVendor  │ 2022H2  │\n└────────┴───────────┴──────────┴─────────┘\n╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮\n│ VULNERABILITIES                                                                                                                                                                            │\n╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯\n╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮\n│ VULNERABILITY CVE-2020-1234                                                                                                                                                                │\n╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯\n┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃ Item            ┃ Details                      ┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ CVE ID          │ CVE-2020-1234                │\n│ CVE description │ This is a simple description │\n└─────────────────┴──────────────────────────────┘\n\nKNOWN_AFFECTED\n--------------\n\n┏━━━━━━━━━━━┳━━━━━━━━━┓\n┃ Product   ┃ Release ┃\n┡━━━━━━━━━━━╇━━━━━━━━━┩\n│ product_1 │ 1.1     │\n└───────────┴─────────┘\n\nRemediations\n------------\n\nVENDOR_FIX                               : Customers should upgrade to the latest version of the product\n┏━━━━━━━━━━━┳━━━━━━━━━┓\n┃ Product   ┃ Release ┃\n┡━━━━━━━━━━━╇━━━━━━━━━┩\n│ product_1 │ 1.1     │\n└───────────┴─────────┘\n╭────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╮\n│ VULNERABILITY CVE-2020-9876                                                                                                                                                                │\n╰────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯\n┏━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓\n┃ Item            ┃ Details                                  ┃\n┡━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩\n│ CVE ID          │ CVE-2020-9876                            │\n│ CVE description │ This is another vulnerabilty description │\n└─────────────────┴──────────────────────────────────────────┘\n\nKNOWN_AFFECTED\n--------------\n\n┏━━━━━━━━━━━┳━━━━━━━━━┓\n┃ Product   ┃ Release ┃\n┡━━━━━━━━━━━╇━━━━━━━━━┩\n│ product_1 │ 1.1     │\n└───────────┴─────────┘\n\nRemediations\n------------\n\nNONE_AVAILABLE                           : Still under investigation\n┏━━━━━━━━━━━┳━━━━━━━━━┓\n┃ Product   ┃ Release ┃\n┡━━━━━━━━━━━╇━━━━━━━━━┩\n│ product_1 │ 1.1     │\n└───────────┴─────────┘\n```\n\nAn error message is reported if the specified file is not found.\n\n```\n[ERROR] CSAF filename not found\n```\n\n### CSAF Generation using the csaf library\n\nThe following example shows the generation of a CSAF document.\n\n```\nfrom csaf.generator import CSAFGenerator\n\ncsaf_gen = CSAFGenerator(\"csaf.ini\")\n# Define header information\ncsaf_gen.set_title(\"Test CSAF document\")\ncsaf_gen.set_header_title(\"Example VEX Document Use Case 1 - Affected\")\n\n# Define product tree\ncsaf_gen.add_product(product_name = \"product1\", vendor = \"Avendor\", release = 1 )\ncsaf_gen.add_product(product_name = \"product1\", vendor = \"Avendor\", release = 2 )\ncsaf_gen.add_product(product_name = \"product1\", vendor = \"Avendor\", release = 3 )\ncsaf_gen.add_product(product_name = \"product2\", vendor = \"Avendor1\", release = 1.0 )\ncsaf_gen.add_product(product_name = \"product2\", vendor = \"Avendor1\", release = 1.1 )\ncsaf_gen.add_product(product_name = \"product3\", vendor = \"Avendor\", release = 1 )\ncsaf_gen.add_product(product_name = \"product3\", vendor = \"Avendor\", release = 2 )\ncsaf_gen.add_product(product_name = \"product3\", vendor = \"Avendor\", release = 3 )\n\n# Add vulnerabilities \ncsaf_gen.add_vulnerability(product_name = \"product2\", release = 1.1, id=\"CVE-2020-1234\", description=\"A simple example\", status=\"vendor_fix\", comment=\"Upgrade product to latest version.\")\ncsaf_gen.add_vulnerability(product_name = \"product2\", release = 1.1, id=\"CVE-2020-9876\", description=\"Another simple example\", status=\"none_available\", comment=\"Still under review.\")\n\n# Generate the CSAF\ncsaf_gen.generate_csaf()\n# And publish to file\ncsaf_gen.publish_csaf(\"test_csaf.json\")\n```\n\n### CSAF Analysis using the csaf library\n\nThe following code sample can be used to analyse a CSAF file. It can be used to confirm that the CSAF file conforms with the CSAF specification\n\n```\nfrom csaf.analyser import CSAFAnalyser\n\ntry:\n    csaf_filename = \"test_csaf.json\"\n    csaf = CSAFAnalyser(csaf_filename)\n    print (f\"Is {csaf_filename} a valid CSAF document : {csaf.validate()}\")\n    csaf.analyse()\nexcept FileNotFoundError:\n    print (\"[ERROR] CSAF filename not found\")\n```\n\n## Licence\n\nLicenced under the MIT Licence.\n\n## Feedback and Contributions\n\nBugs and feature requests can be made via GitHub Issues.\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/anthonyharrison/csaf",
    "keywords": "security,tools,CSAF,CSAF 2.0,VexDevSecOps,vulnerabilities",
    "license": "MIT",
    "maintainer": "Anthony Harrison",
    "maintainer_email": "anthony.p.harrison@gmail.com",
    "name": "csaf-tool",
    "package_url": "https://pypi.org/project/csaf-tool/",
    "platform": null,
    "project_url": "https://pypi.org/project/csaf-tool/",
    "project_urls": {
      "Homepage": "https://github.com/anthonyharrison/csaf"
    },
    "release_url": "https://pypi.org/project/csaf-tool/0.2.0/",
    "requires_dist": [
      "packageurl-python",
      "rich"
    ],
    "requires_python": ">=3.7",
    "summary": "CSAF generator and analyser",
    "version": "0.2.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 16377196,
  "releases": {
    "0.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "ce1b0dcde05cf6708398ba9e3ce0c0839e782ded4979a764ed01ca45517652cf",
          "md5": "92902665f18a78a2131c117abacf77e2",
          "sha256": "7ebd2aba493cc54be60dcfaa8cdcc61b59aad5a1f44cda7bef295510ce11e257"
        },
        "downloads": -1,
        "filename": "csaf_tool-0.1.0-py2.py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "92902665f18a78a2131c117abacf77e2",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "requires_python": ">=3.7",
        "size": 12357,
        "upload_time": "2022-12-09T16:36:12",
        "upload_time_iso_8601": "2022-12-09T16:36:12.092420Z",
        "url": "https://files.pythonhosted.org/packages/ce/1b/0dcde05cf6708398ba9e3ce0c0839e782ded4979a764ed01ca45517652cf/csaf_tool-0.1.0-py2.py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.2.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "86d7850b92e28fba4fb2f08f1b21ab1bf0224f1634dc8a789ca3b1bed95a2f28",
          "md5": "b12c8bb9a190959ce364c90fed45258d",
          "sha256": "d22c1ea9eb4412a951e1a5000519c0080d4946f61b97c53d8c57abfbf27d4d05"
        },
        "downloads": -1,
        "filename": "csaf_tool-0.2.0-py2.py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "b12c8bb9a190959ce364c90fed45258d",
        "packagetype": "bdist_wheel",
        "python_version": "py2.py3",
        "requires_python": ">=3.7",
        "size": 14078,
        "upload_time": "2023-01-10T16:33:17",
        "upload_time_iso_8601": "2023-01-10T16:33:17.326650Z",
        "url": "https://files.pythonhosted.org/packages/86/d7/850b92e28fba4fb2f08f1b21ab1bf0224f1634dc8a789ca3b1bed95a2f28/csaf_tool-0.2.0-py2.py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "86d7850b92e28fba4fb2f08f1b21ab1bf0224f1634dc8a789ca3b1bed95a2f28",
        "md5": "b12c8bb9a190959ce364c90fed45258d",
        "sha256": "d22c1ea9eb4412a951e1a5000519c0080d4946f61b97c53d8c57abfbf27d4d05"
      },
      "downloads": -1,
      "filename": "csaf_tool-0.2.0-py2.py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "b12c8bb9a190959ce364c90fed45258d",
      "packagetype": "bdist_wheel",
      "python_version": "py2.py3",
      "requires_python": ">=3.7",
      "size": 14078,
      "upload_time": "2023-01-10T16:33:17",
      "upload_time_iso_8601": "2023-01-10T16:33:17.326650Z",
      "url": "https://files.pythonhosted.org/packages/86/d7/850b92e28fba4fb2f08f1b21ab1bf0224f1634dc8a789ca3b1bed95a2f28/csaf_tool-0.2.0-py2.py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}