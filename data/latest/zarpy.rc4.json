{
  "info": {
    "author": "Alexander Bagnall",
    "author_email": "Alexander Bagnall <abagnalla@gmail.com>",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: MIT License",
      "Programming Language :: Python",
      "Programming Language :: Python :: 3"
    ],
    "description": "# Zarpy: formally verified biased coin and n-sided die.\n\nSee the [paper](https://arxiv.org/abs/2211.06747) (to appear in\nPLDI'23) and [Github repository](https://github.com/bagnalla/zar).\n\n## Why use Zarpy?\n\n### Probabilistic choice\n\nA basic operation in randomized algorithms is *probabilistic choice*:\nfor some `p ∈ [0,1]`, execute action `a1` with probability `p` or\naction `a2` with probability `1-p` (i.e., flip a biased coin to\ndetermine the path of execution). A common method for performing\nprobabilistic choice is as follows:\n```python\nif random() < p:\n  execute a1\nelse:\n  execute a2\n```\n\nwhere `p` is a float in the range `[0,1]` and `random()` produces a\nrandom float in the range `[0,1)`. While good enough for many\napplications, this approach is not always correct due to float\nroundoff error. We can only expect `a1` to be executed with\nprobability `p + ϵ` for some small error term `ϵ`, which technically\ninvalidates any correctness guarantees of our overall system that\ndepend on the correctness of its probabilistic choices.\n\nZarpy provides an alternative that is guaranteed (by formal proof in\nCoq) to execute `a1` with probability `p` (where `n` and `d` are\nintegers such that `p = n/d`):\n```python\nfrom zarpy import build_coin, flip\nbuild_coin((n, d)) # Build and cache coin with bias p = n/d\nif flip(): # Generate a Boolean value with Pr(True) = p \n  execute a1\nelse:\n  execute a2\n```\n\n### Uniform sampling\n\nAnother common operation is to randomly draw from a finite collection\nof values with equal (uniform) probability of each. An old trick for\ndrawing an integer uniformly from the range `[0, n)` is to generate a\nrandom integer from `[0, RAND_MAX]` and take the modulus wrt. `n`:\n```python\nx = rand() % n # Assign x random value from [0,n)\n```\nbut this method suffers from modulo bias when `n` is not a power of 2,\ncausing some values to occur with higher probability than others (see,\ne.g., [this\narticle](https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/)\nfor more information on modulo bias). Zarpy provides a uniform sampler\nthat is guaranteed for any integer `0 < n` to generate samples from\n`[0,n)` with probability `1/n` each:\n```python\nfrom zarpy import build_die, roll\nbuild_die(n)\nx = roll()\n```\n\nAlthough the Python function `random.randint` is ostensibly free from\nmodulo bias, our implementation guarantees so by a *formal proof of\ncorrectness* in Coq.\n\n## Trusted Computing Base\n\nThe samplers provided by Zarpy have been implemented and verified in\nCoq and extracted to OCaml and bundled into Python package via\n[pythonlib](https://github.com/janestreet/pythonlib). Validity of the\ncorrectness proofs is thus dependent on the correctness of Coq's\nextraction mechanism, the OCaml compiler and runtime, a small amount\nof OCaml shim code (viewable\n[here](https://github.com/bagnalla/zar/blob/main/python/zar/ocaml/zarpy.ml)),\nand the pythonlib library.\n\n## Proofs of correctness\n\nThe coin and die samplers are implemented as probabilistic programs in\nthe [Zar](https://github.com/bagnalla/zar) system and compiled to\n[interaction trees](https://github.com/DeepSpec/InteractionTrees)\nimplementing them via reduction to sequences of fair coin flips. See\nSection 3 of the [paper](https://arxiv.org/abs/2211.06747) for details\nand the file\n[zarpy.v](https://github.com/bagnalla/zar/blob/main/zarpy.v) for their\nimplementations and proofs of correctness.\n\nCorrectness is two-fold. For biased coin with bias `p`, we prove:\n\n*\n  [coin_itree_correct](https://github.com/bagnalla/zar/blob/main/zarpy.v#L57):\n  the probability of producing `true` according to the formal probabilistic\n  semantics of the constructed interaction tree is equal to `p`, and\n\n*\n  [coin_samples_equidistributed](https://github.com/bagnalla/zar/blob/main/zarpy.v#L75):\n  when the source of random bits is uniformly distributed, for any\n  sequence of coin flips the proportion of `true` samples converges to\n  `p` as the number of samples goes to +∞.\n\nThe equidistribution result is dependent on uniform distribution of\nthe Boolean values generated by OCaml's\n[`Random.bool`](https://v2.ocaml.org/api/Random.html) function. See\n[the paper](https://arxiv.org/abs/2211.06747) for a more detailed\nexplanation.\n\nSimilarly, the theorem\n[die_itree_correct](https://github.com/bagnalla/zar/blob/main/zarpy.v#L136)\nproves semantic correctness of the n-sided die, and\n[die_samples_equidistributed](https://github.com/bagnalla/zar/blob/main/zarpy.v#L161)\nequidistribution of its samples.\n\n## Usage\n\n`seed()` initializes the PRNG via\n[Random.self_init](https://v2.ocaml.org/api/Random.html).\n\n### Biased coin\n\n`build_coin((num, denom))` builds and caches a coin with `Pr(True) =\nnum/denom` for nonnegative integer `num` and positive integer `denom`.\n\n`flip()` produces a single Boolean sample by flipping the cached coin.\n\n`flip_n(n)` produces `n` Boolean samples by flipping the cached coin.\n\n### N-sided die\n\n`build_die(n)` builds and caches an n-sided die with `Pr(m) = 1/n` for\ninteger `m` where `0 <= m < n`.\n\n`roll()` produces a single sample by rolling the cached die.\n\n`roll_n(n)` produces `n` integer samples by rolling the cached die.\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "zar,zarpy,random,sampler,biased,coin,bernoulli,uniform,die,verified,coq",
    "license": "MIT License  Copyright (c) [2022] [Alexander A. Bagnall]  Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:  The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.  THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.",
    "maintainer": "",
    "maintainer_email": "",
    "name": "zarpy",
    "package_url": "https://pypi.org/project/zarpy/",
    "platform": null,
    "project_url": "https://pypi.org/project/zarpy/",
    "project_urls": {
      "Homepage": "https://github.com/bagnalla/zar"
    },
    "release_url": "https://pypi.org/project/zarpy/1.0.1/",
    "requires_dist": null,
    "requires_python": ">=3.6.3",
    "summary": "Formally verified biased coin and n-sided die",
    "version": "1.0.1",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 17234820,
  "releases": {
    "0.9.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "847152948e24b8e800decd71b6a460679672b497c340781c307f8476a643e3d3",
          "md5": "2873210c9c68f0095632d233116e1511",
          "sha256": "9a250308fd49a5f9c7cc0248542f553ccb49730277a3239291b9da8650f0d4fd"
        },
        "downloads": -1,
        "filename": "zarpy-0.9.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "2873210c9c68f0095632d233116e1511",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": null,
        "size": 2576,
        "upload_time": "2022-11-11T16:20:40",
        "upload_time_iso_8601": "2022-11-11T16:20:40.340487Z",
        "url": "https://files.pythonhosted.org/packages/84/71/52948e24b8e800decd71b6a460679672b497c340781c307f8476a643e3d3/zarpy-0.9.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "f5ee3a12fd33a299806a2918e610b8361e5864ef5669be7549a8f2c91b5180be",
          "md5": "9bbf98e1eefcf662c94b0687922360ef",
          "sha256": "0523461c188b52a181196e29909622f858ae33572e5be6008089d2a1ad821118"
        },
        "downloads": -1,
        "filename": "zarpy-0.9.0.tar.gz",
        "has_sig": false,
        "md5_digest": "9bbf98e1eefcf662c94b0687922360ef",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 3222,
        "upload_time": "2022-11-11T16:20:42",
        "upload_time_iso_8601": "2022-11-11T16:20:42.118592Z",
        "url": "https://files.pythonhosted.org/packages/f5/ee/3a12fd33a299806a2918e610b8361e5864ef5669be7549a8f2c91b5180be/zarpy-0.9.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.9.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "17ec662481a321aec2682fff302fdb3c8cafcedbf946caa82dfe25e88060b717",
          "md5": "3c551920c87aebe675a0b7baa5ab6514",
          "sha256": "2e4b487e895d9c7aad5369ea45bcc24562e1f177bcd00e36be41f34b479e7d61"
        },
        "downloads": -1,
        "filename": "zarpy-0.9.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "3c551920c87aebe675a0b7baa5ab6514",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": null,
        "size": 6034436,
        "upload_time": "2022-11-16T18:58:25",
        "upload_time_iso_8601": "2022-11-16T18:58:25.522809Z",
        "url": "https://files.pythonhosted.org/packages/17/ec/662481a321aec2682fff302fdb3c8cafcedbf946caa82dfe25e88060b717/zarpy-0.9.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "0b5c8c85e97cadfb32c580903f8ddbd62844ef5143e80491fd558949f38f544b",
          "md5": "a5e98f5ef9c2982447d9b683d4047fbb",
          "sha256": "a681d17da479f51a2a3621d451fc41af8d8f178ecf87ff5629e80ea01d72c419"
        },
        "downloads": -1,
        "filename": "zarpy-0.9.1.tar.gz",
        "has_sig": false,
        "md5_digest": "a5e98f5ef9c2982447d9b683d4047fbb",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 5971848,
        "upload_time": "2022-11-16T18:58:31",
        "upload_time_iso_8601": "2022-11-16T18:58:31.234498Z",
        "url": "https://files.pythonhosted.org/packages/0b/5c/8c85e97cadfb32c580903f8ddbd62844ef5143e80491fd558949f38f544b/zarpy-0.9.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "63fd6ecffd0dc5ef60c7177f80a5f4ae28db843574bd2d81eaf2daa3340135c1",
          "md5": "d8590c77ca92ef7049a3948d383c529f",
          "sha256": "afffc7d7bdb7ae9008f5cc9f2bfde76ba334b45e15f70eb8512c9519c6b0693c"
        },
        "downloads": -1,
        "filename": "zarpy-1.0.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "d8590c77ca92ef7049a3948d383c529f",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6.3",
        "size": 6057297,
        "upload_time": "2023-03-10T04:28:42",
        "upload_time_iso_8601": "2023-03-10T04:28:42.451212Z",
        "url": "https://files.pythonhosted.org/packages/63/fd/6ecffd0dc5ef60c7177f80a5f4ae28db843574bd2d81eaf2daa3340135c1/zarpy-1.0.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "3f2b6d5977979430ab6e231d7d307a821f442ebee3f09f23a5bbda9251aa5949",
          "md5": "1865a1dbce18d6744fcb253c3f81307b",
          "sha256": "39af375dba67f892eee9f6f2bf0612ba4714a242412937a3db94954b29859877"
        },
        "downloads": -1,
        "filename": "zarpy-1.0.0.tar.gz",
        "has_sig": false,
        "md5_digest": "1865a1dbce18d6744fcb253c3f81307b",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6.3",
        "size": 6001524,
        "upload_time": "2023-03-10T04:28:48",
        "upload_time_iso_8601": "2023-03-10T04:28:48.964041Z",
        "url": "https://files.pythonhosted.org/packages/3f/2b/6d5977979430ab6e231d7d307a821f442ebee3f09f23a5bbda9251aa5949/zarpy-1.0.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "6d8bc0aadb8a10c90c71e504c38e0bd36de0a34b279f0f40660f0abefdf440c0",
          "md5": "8cb54012c7418996532e07d688b09a0a",
          "sha256": "741d1b23f50622103a40404a40a9bfdc25f18f8138354a0ce70954f20531b047"
        },
        "downloads": -1,
        "filename": "zarpy-1.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "8cb54012c7418996532e07d688b09a0a",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6.3",
        "size": 6057384,
        "upload_time": "2023-03-10T05:41:35",
        "upload_time_iso_8601": "2023-03-10T05:41:35.991121Z",
        "url": "https://files.pythonhosted.org/packages/6d/8b/c0aadb8a10c90c71e504c38e0bd36de0a34b279f0f40660f0abefdf440c0/zarpy-1.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "4c560a7fc15f4a73008ee19e47a9bec2e9425776132dc131a9d35ae3e957d9fd",
          "md5": "7c672b2c45d7ce42a6c81111b0190ad9",
          "sha256": "102b4a3f591eb034cae1847a74928953dcf5843146758fa363d75ec7d29567c6"
        },
        "downloads": -1,
        "filename": "zarpy-1.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "7c672b2c45d7ce42a6c81111b0190ad9",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6.3",
        "size": 6001785,
        "upload_time": "2023-03-10T05:41:42",
        "upload_time_iso_8601": "2023-03-10T05:41:42.185167Z",
        "url": "https://files.pythonhosted.org/packages/4c/56/0a7fc15f4a73008ee19e47a9bec2e9425776132dc131a9d35ae3e957d9fd/zarpy-1.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "6d8bc0aadb8a10c90c71e504c38e0bd36de0a34b279f0f40660f0abefdf440c0",
        "md5": "8cb54012c7418996532e07d688b09a0a",
        "sha256": "741d1b23f50622103a40404a40a9bfdc25f18f8138354a0ce70954f20531b047"
      },
      "downloads": -1,
      "filename": "zarpy-1.0.1-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "8cb54012c7418996532e07d688b09a0a",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.6.3",
      "size": 6057384,
      "upload_time": "2023-03-10T05:41:35",
      "upload_time_iso_8601": "2023-03-10T05:41:35.991121Z",
      "url": "https://files.pythonhosted.org/packages/6d/8b/c0aadb8a10c90c71e504c38e0bd36de0a34b279f0f40660f0abefdf440c0/zarpy-1.0.1-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "4c560a7fc15f4a73008ee19e47a9bec2e9425776132dc131a9d35ae3e957d9fd",
        "md5": "7c672b2c45d7ce42a6c81111b0190ad9",
        "sha256": "102b4a3f591eb034cae1847a74928953dcf5843146758fa363d75ec7d29567c6"
      },
      "downloads": -1,
      "filename": "zarpy-1.0.1.tar.gz",
      "has_sig": false,
      "md5_digest": "7c672b2c45d7ce42a6c81111b0190ad9",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.6.3",
      "size": 6001785,
      "upload_time": "2023-03-10T05:41:42",
      "upload_time_iso_8601": "2023-03-10T05:41:42.185167Z",
      "url": "https://files.pythonhosted.org/packages/4c/56/0a7fc15f4a73008ee19e47a9bec2e9425776132dc131a9d35ae3e957d9fd/zarpy-1.0.1.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}