{
  "info": {
    "author": "James Pavur",
    "author_email": "james.pavur@cs.ox.ac.uk",
    "bugtrack_url": null,
    "classifiers": [
      "Intended Audience :: Science/Research",
      "License :: OSI Approved :: MIT License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3",
      "Topic :: Security"
    ],
    "description": "# GSExtract\nGSExtract is a tool for converting imperfect satellite radio captures of internet traffic transmitted using Generic Stream Encapsulation (GSE) over DVB-S into usable *.pcap files.\n\nYou can learn more about the tool and its capabilites by [watching](https://www.youtube.com/watch?v=ku0Q_Wey4K0) the corresponding Black Hat USA 2020 / DEFCON 28 briefings.\n\nThe tool was first presented at IEEE S&P 2020 in [this paper](https://doi.ieeecomputersociety.org/10.1109/SP40000.2020.00056). \n\n>:warning: **Disclaimer**: This tool is provided as a research proof of concept and it is the user's responsibility to ensure that they have appropriate permissions and authority for its use. Take care to adhere to regulations regarding radio communications interception if evaluating this tool in real-world systems.\n\n## Installation\nYou can install from PyPI as follows:\n```bash\npip install gsextract\n``` \n\nYou can also install directly from github as follows:\n```bash\ngit clone https://github.com/ssloxford/gsextract\npip install ./gsextract\n```\n\nThis will add the command ``gsextract`` to your python path. \n\n## Usage\nBasic usage of GSExtract requires a binary file containing continuous DVB-S BBFrames as input and a file to output the resulting pcap into.\n\n```bash\ngsextract [satellite_recording.ts] [output.pcap]\n```\n\nYou can also stream from a live recording of satellite traffic continuously using the ``--stream`` option. This will cause gsextract to watch the input file for new BBFrames and process them as they arrive.\n```bash\ngsextract --stream [satellite_recording.ts] [output.pcap]\n```\n\n### Caveats and Additional Features\n#### Header Extensions\nSome service providers use proprietary header extensions for GSE. Generally, parsing traffic with such extensions will require modifying the kaitai struct used for GSE data extraction (you can find it in ``gsextract/parsers/pure_gse.ksy`` and ``gsextract/parsers/pure_gse.py``).\n\nA simple feature to try and force the addition of semi-valid IP headers can be enabled with the ``--no-reliable`` flag. This can increase the number of packets extracted with unusual GSE header extensions but can also result in false IP headers.\n```bash\ngsextract --no-reliable [satellite_recording.ts] [output.pcap]\n```\n#### Mod Codes and Multiple Input Streams\nAs written, GSExtract works best with streams that use the modcode 0x4200. This is by far the most common format for GSE-based services that we have encountered. However, it can also be manually overwritten in ``gsextract/parsers/pure_bb.ksy`` and ``gsextract/parsers/pure_bb.py``. Multiple input streams are not supported in this release as GSExtract requires a \"crutch\" Mod Code to resync with corrupt feeds. You will need to choose a single code to synchronize to at a time but can, of course, run gsextract multiple times on a given file as a workaround. Pull requests adding multiple input stream support in a smoother way are very much welcome.\n\n#### TCP Hijacking\nThe command line version of the tool does not include support for TCP hijacking by default as many of the implementation details are scenario and network specific. However, you can find an example of TCP hijacking using GSExtract at the bottom of the ``gsextract/gse_parser.py`` file as a starting model.\n\n#### Sample Data\nFor privacy reasons, I cannot provide sample recordings of real-world GSE streams. For testing purposes a small sanitized GSE recording is provided as ``sample.ts``. IP addresses and payloads have been overwritten. Running gsextract in normal mode should recover a pcap with two packets from this file. Running it with the ``--no-reliable`` flag should recover two additional packets.\n\n## Logistics\n### Authors\nThis tool was developed by James Pavur. It is part of a larger research initiative on satellite communications security conducted in partnership between the University of Oxford's [Systems Secuirty Lab](https://seclab.cs.ox.ac.uk/) and armasuisse's [Cyber-Defense Campus](https://www.ar.admin.ch/en/armasuisse-wissenschaft-und-technologie-w-t/cyber-defence_campus.html).\n\n### Contributing\nPull requests are always welcome. Some particularly desirable additions include:\n* Support for more GSE header extensions in the kaitai struct\n* Mod Code flexibility in the CLI tool\n* Support for multiple input streams in a single run\n\n### Citing This Tool\nIf you happen to use GSExtract for academic research, we would greatly appreciate a citation to the paper where it originally appeared:\n> J. Pavur, D. Moser, M. Strohmeier, V. Lenders and I. Martinovic,  \"A Tale of Sea and Sky On the Security of Maritime VSAT Communications,\" in 2020 IEEE Symposium on Security and Privacy (SP), San Francisco, CA, US, 2020 pp. 1384-1400. doi: 10.1109/SP40000.2020.00056\n\n### Acknowledgements\nThis tool would have been a million times more complex and difficult to build if not for the awesome Katiai Struct langauge. Check it out at [kaitai.io](https://kaitai.io/).\n\nThis tool also contains a modified version of Salah Gherdaoui's [pcaplib](https://pypi.org/project/pcaplib/#description). It makes it easy for GSExtract to dump IP packets to *.pcap files in real-time. For more deep (but slower) traffic parsing, we also use the venerable [scapy](https://scapy.net/).\n\n## License\n[MIT](https://choosealicense.com/licenses/mit/)\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/ssloxford/gsextract",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "gsextract",
    "package_url": "https://pypi.org/project/gsextract/",
    "platform": "",
    "project_url": "https://pypi.org/project/gsextract/",
    "project_urls": {
      "Homepage": "https://github.com/ssloxford/gsextract"
    },
    "release_url": "https://pypi.org/project/gsextract/1.0/",
    "requires_dist": [
      "kaitaistruct",
      "click",
      "scapy"
    ],
    "requires_python": "",
    "summary": "A tool to parse corrupted recordings of satellite internet traffic in the GSE over DVB-S format into .pcaps",
    "version": "1.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 8305760,
  "releases": {
    "1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "d7a53f6ef436e53447a55a23c04c05d4bf36af4a79b53c6642cb087e269ab81c",
          "md5": "cde01f4428bcff2072b165f186c1a175",
          "sha256": "bba4d71c73efb0b262798fae6ad353928909d530323ca6ff297651c7dd2aa7fe"
        },
        "downloads": -1,
        "filename": "gsextract-1.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "cde01f4428bcff2072b165f186c1a175",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": null,
        "size": 17961,
        "upload_time": "2020-09-30T10:20:46",
        "upload_time_iso_8601": "2020-09-30T10:20:46.733236Z",
        "url": "https://files.pythonhosted.org/packages/d7/a5/3f6ef436e53447a55a23c04c05d4bf36af4a79b53c6642cb087e269ab81c/gsextract-1.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "faaf534aeced43028139dcd45da8732d4d031441f0fb671e1ef777a4b56d1e48",
          "md5": "1859820b90332d4ea3a582142c81924d",
          "sha256": "ebce6477cf2a3ed3a774e2c85a06243ea2e480778f7b6e7ea6b65071577ef4a6"
        },
        "downloads": -1,
        "filename": "gsextract-1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "1859820b90332d4ea3a582142c81924d",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 15999,
        "upload_time": "2020-09-30T10:20:49",
        "upload_time_iso_8601": "2020-09-30T10:20:49.026499Z",
        "url": "https://files.pythonhosted.org/packages/fa/af/534aeced43028139dcd45da8732d4d031441f0fb671e1ef777a4b56d1e48/gsextract-1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "d7a53f6ef436e53447a55a23c04c05d4bf36af4a79b53c6642cb087e269ab81c",
        "md5": "cde01f4428bcff2072b165f186c1a175",
        "sha256": "bba4d71c73efb0b262798fae6ad353928909d530323ca6ff297651c7dd2aa7fe"
      },
      "downloads": -1,
      "filename": "gsextract-1.0-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "cde01f4428bcff2072b165f186c1a175",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": null,
      "size": 17961,
      "upload_time": "2020-09-30T10:20:46",
      "upload_time_iso_8601": "2020-09-30T10:20:46.733236Z",
      "url": "https://files.pythonhosted.org/packages/d7/a5/3f6ef436e53447a55a23c04c05d4bf36af4a79b53c6642cb087e269ab81c/gsextract-1.0-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "faaf534aeced43028139dcd45da8732d4d031441f0fb671e1ef777a4b56d1e48",
        "md5": "1859820b90332d4ea3a582142c81924d",
        "sha256": "ebce6477cf2a3ed3a774e2c85a06243ea2e480778f7b6e7ea6b65071577ef4a6"
      },
      "downloads": -1,
      "filename": "gsextract-1.0.tar.gz",
      "has_sig": false,
      "md5_digest": "1859820b90332d4ea3a582142c81924d",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 15999,
      "upload_time": "2020-09-30T10:20:49",
      "upload_time_iso_8601": "2020-09-30T10:20:49.026499Z",
      "url": "https://files.pythonhosted.org/packages/fa/af/534aeced43028139dcd45da8732d4d031441f0fb671e1ef777a4b56d1e48/gsextract-1.0.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}