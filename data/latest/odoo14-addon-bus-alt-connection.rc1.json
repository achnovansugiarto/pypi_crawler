{
  "info": {
    "author": "Trobz,Odoo Community Association (OCA)",
    "author_email": "support@odoo-community.org",
    "bugtrack_url": null,
    "classifiers": [
      "Framework :: Odoo",
      "Framework :: Odoo :: 14.0",
      "License :: OSI Approved :: GNU Affero General Public License v3",
      "Programming Language :: Python"
    ],
    "description": "==================\nBus Alt Connection\n==================\n\n.. !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n   !! This file is generated by oca-gen-addon-readme !!\n   !! changes will be overwritten.                   !!\n   !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n.. |badge1| image:: https://img.shields.io/badge/maturity-Beta-yellow.png\n    :target: https://odoo-community.org/page/development-status\n    :alt: Beta\n.. |badge2| image:: https://img.shields.io/badge/licence-AGPL--3-blue.png\n    :target: http://www.gnu.org/licenses/agpl-3.0-standalone.html\n    :alt: License: AGPL-3\n.. |badge3| image:: https://img.shields.io/badge/github-OCA%2Fserver--tools-lightgray.png?logo=github\n    :target: https://github.com/OCA/server-tools/tree/14.0/bus_alt_connection\n    :alt: OCA/server-tools\n.. |badge4| image:: https://img.shields.io/badge/weblate-Translate%20me-F47D42.png\n    :target: https://translation.odoo-community.org/projects/server-tools-14-0/server-tools-14-0-bus_alt_connection\n    :alt: Translate me on Weblate\n.. |badge5| image:: https://img.shields.io/badge/runbot-Try%20me-875A7B.png\n    :target: https://runbot.odoo-community.org/runbot/149/14.0\n    :alt: Try me on Runbot\n\n|badge1| |badge2| |badge3| |badge4| |badge5| \n\nThis module makes it possible to use PgBouncer_ as a connection pooler\nfor odoo.\n\n.. _PgBouncer: https://pgbouncer.github.io/\n\nWhy isn't odoo's connection pooling good enough?\n================================================\n\nOdoo's builtin connection pooling works at process level: each Odoo process\nhas its own ConnectionPool_, limited to ``db_maxconn``.\n\nIt does the job of re-using open connections available in the pool.\nBut it never closes these connections, `unless reaching db_maxconn`_.\n\n.. _ConnectionPool: https://github.com/odoo/odoo/blob/12.0/odoo/sql_db.py#L525\n.. _`unless reaching db_maxconn`: https://github.com/odoo/odoo/blob/12.0/odoo/sql_db.py#L593\n\nIn practice, we observe that each odoo worker will end up\nwith up to 3 open connection in its pool.\nWith 10 http workers, that's up to 30 connection continuously open just\nfor one single instance.\n\nHere comes PgBouncer\n====================\n\nPgBouncer will help to limit this number of open connections,\nby sharing a pool of connections at the instance level, between\nall workers. Odoo workers will still have up to 3 open connections,\nbut these will be connections to PgBouncer, that on its side will\nclose unnecessary connections to pg.\n\nThis has proven to help performances on Odoo deployments with\nmultiple instances.\n\nIt allows you to define how resources should be shared,\naccording to your priorities, e.g. :\n\n* key odoo instance on host A can open up to 30 connections\n* while odoo instance on host B, dedicated to reports,\n  can open up to 10 connections only\n\nAnd most importantly, it helps you to ensure that\n``max_connections`` will never be reached on pg server side.\n\n\nWhy is this module needed?\n==========================\n\nWhen configuring PgBouncer, you can choose between 2 transaction pooling modes:\n\n* `pool_mode = session`\n* `pool_mode = transaction`\n\nIf we choose `pool_mode = session`, then one server connection will be tied\nto a given odoo process until its death, which is exactly what we're trying\nto change. Thus, to release the server connection once the transaction is\ncomplete, we use `pool_mode = transaction`.\n\nThis works fine, except for Odoo's longpolling features that relies\non the `LISTEN/NOTIFY`_ mechanism from pg, which is `not compatible`_ with that\nmode.\n\n.. _`LISTEN/NOTIFY`: https://www.postgresql.org/docs/9.6/static/sql-notify.html\n.. _`not compatible`: https://wiki.postgresql.org/wiki/PgBouncer\n\n\nTo be more precise, `NOTIFY` statements are properly transfered by PgBouncer\nin that mode; only the `LISTEN` statement isn't (because it needs to keep the\nserver connection open).\n\nSo for the unique \"listening\" connection per instance that requires this\nstatement (here_), we need odoo to connect directly to the pg server, bypassing\nPgBouncer.\n\nThat's what this module implements, by overriding the relevant method\nof the Dispatcher_.\n\n.. _here: https://github.com/odoo/odoo/blob/12.0/addons/bus/models/bus.py#L166\n.. _Dispatcher: https://github.com/odoo/odoo/blob/12.0/addons/bus/models/bus.py#L105\n\n**Table of contents**\n\n.. contents::\n   :local:\n\nInstallation\n============\n\nYou don't need to install this module in the database(s) to enable it.\n\nBut you need to load it server-wide:\n\n* By starting Odoo with ``--load=web,bus_alt_connection``\n\n* Or by updating its configuration file:\n\n.. code-block:: ini\n\n  [options]\n  (...)\n  server_wide_modules = web,bus_alt_connection\n\nConfiguration\n=============\n\nYou need to define how to connect directly to the database:\n\n* Either by defining environment variables:\n\n    - ``IMDISPATCHER_DB_HOST=db-01``\n    - ``IMDISPATCHER_DB_PORT=5432``\n\n* Or in Odoo's configuration file:\n\n.. code-block:: ini\n\n  [options]\n  (...)\n  imdispatcher_db_host = db-01\n  imdispatcher_db_port = 5432\n\nBug Tracker\n===========\n\nBugs are tracked on `GitHub Issues <https://github.com/OCA/server-tools/issues>`_.\nIn case of trouble, please check there if your issue has already been reported.\nIf you spotted it first, help us smashing it by providing a detailed and welcomed\n`feedback <https://github.com/OCA/server-tools/issues/new?body=module:%20bus_alt_connection%0Aversion:%2014.0%0A%0A**Steps%20to%20reproduce**%0A-%20...%0A%0A**Current%20behavior**%0A%0A**Expected%20behavior**>`_.\n\nDo not contact contributors directly about support or help with technical issues.\n\nCredits\n=======\n\nAuthors\n~~~~~~~\n\n* Trobz\n\nContributors\n~~~~~~~~~~~~\n\n* Nils Hamerlinck <nils@trobz.com>\n\nMaintainers\n~~~~~~~~~~~\n\nThis module is maintained by the OCA.\n\n.. image:: https://odoo-community.org/logo.png\n   :alt: Odoo Community Association\n   :target: https://odoo-community.org\n\nOCA, or the Odoo Community Association, is a nonprofit organization whose\nmission is to support the collaborative development of Odoo features and\npromote its widespread use.\n\nThis module is part of the `OCA/server-tools <https://github.com/OCA/server-tools/tree/14.0/bus_alt_connection>`_ project on GitHub.\n\nYou are welcome to contribute. To learn how please visit https://odoo-community.org/page/Contribute.\n\n\n",
    "description_content_type": "",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/OCA/server-tools",
    "keywords": "",
    "license": "AGPL-3",
    "maintainer": "",
    "maintainer_email": "",
    "name": "odoo14-addon-bus-alt-connection",
    "package_url": "https://pypi.org/project/odoo14-addon-bus-alt-connection/",
    "platform": "",
    "project_url": "https://pypi.org/project/odoo14-addon-bus-alt-connection/",
    "project_urls": {
      "Homepage": "https://github.com/OCA/server-tools"
    },
    "release_url": "https://pypi.org/project/odoo14-addon-bus-alt-connection/14.0.1.0.1.dev1/",
    "requires_dist": [
      "odoo (<14.1dev,>=14.0a)"
    ],
    "requires_python": ">=3.6",
    "summary": "Needed when using PgBouncer as a connection pooler",
    "version": "14.0.1.0.1.dev1",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 12755867,
  "releases": {
    "14.0.1.0.1.dev1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "7c6de66416b6ed749bd5fbfd3f59ac5fb9052e59731f5ac4941d50b09cdc5937",
          "md5": "83aa97a07fcbc64e8ba41b69cf5628fe",
          "sha256": "e03dc55d99d7f949d37ee4c2cd21075f1a4a41049c129f3cc59694abfd55d142"
        },
        "downloads": -1,
        "filename": "odoo14_addon_bus_alt_connection-14.0.1.0.1.dev1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "83aa97a07fcbc64e8ba41b69cf5628fe",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6",
        "size": 27300,
        "upload_time": "2022-02-01T15:11:07",
        "upload_time_iso_8601": "2022-02-01T15:11:07.950256Z",
        "url": "https://files.pythonhosted.org/packages/7c/6d/e66416b6ed749bd5fbfd3f59ac5fb9052e59731f5ac4941d50b09cdc5937/odoo14_addon_bus_alt_connection-14.0.1.0.1.dev1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "7c6de66416b6ed749bd5fbfd3f59ac5fb9052e59731f5ac4941d50b09cdc5937",
        "md5": "83aa97a07fcbc64e8ba41b69cf5628fe",
        "sha256": "e03dc55d99d7f949d37ee4c2cd21075f1a4a41049c129f3cc59694abfd55d142"
      },
      "downloads": -1,
      "filename": "odoo14_addon_bus_alt_connection-14.0.1.0.1.dev1-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "83aa97a07fcbc64e8ba41b69cf5628fe",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.6",
      "size": 27300,
      "upload_time": "2022-02-01T15:11:07",
      "upload_time_iso_8601": "2022-02-01T15:11:07.950256Z",
      "url": "https://files.pythonhosted.org/packages/7c/6d/e66416b6ed749bd5fbfd3f59ac5fb9052e59731f5ac4941d50b09cdc5937/odoo14_addon_bus_alt_connection-14.0.1.0.1.dev1-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}