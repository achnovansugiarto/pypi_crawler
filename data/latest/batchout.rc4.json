{
  "info": {
    "author": "Ilia Khaustov",
    "author_email": "",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: MIT License",
      "Programming Language :: Python :: 3"
    ],
    "description": "# Batchout\n\nFramework for building data pipelines that: \n\n1. Extract batch of payloads of any structure like JSON, XML or just text/bytes;\n2. Transform batch of payloads to batch of rows for a table defined by columns;\n3. Load batch of table rows to persistent storage.\n\n## Install\n\n`pip install batchout` without dependencies except Python 3.9+\n\n`pip install batchout[cli]` with a basic CLI if you avoid coding in Python\n\n`pip install batchout[postgres]` for Postgres reading/writing\n\n`pip install batchout[jsonpath]` to extract data from JSON documents\n\n`pip install batchout[xpath]` to extract data from XML/HTML\n\n## Use in Python\n\nIt is better explained by example.\n\nLet's say we periodically fetch a JSON message from some REST API:\n\n```json\n{\n  \"user\": {\n    \"id\": \"someuserid\",\n    \"last_seen\": \"2019-11-01T00:00:00\"\n  },\n  \"sessions\": [\n     {\n        \"id\": \"somesessionid\",\n        \"created_at\": \"2019-10-01T00:00:00\",\n        \"device\": {\n           \"useragent\": \"chrome\"\n        }\n     },\n     {\n        \"id\": \"othersessionid\",\n        \"created_at\": \"2019-11-01T00:00:00\",\n        \"device\": {\n           \"useragent\": \"firefox\"\n        }\n     }\n  ]\n}\n```\n\nFetched data has to be put into database table `user_session` like this:\n\n```\nuser_id       user_last_seen        session_id      session_created_at    session_useragent\n-------------------------------------------------------------------------------------------\nsomeuserid    2019-11-01T00:00:00   somesessionid   2019-10-01T00:00:00   chrome\nsomeuserid    2019-11-01T00:00:00   othersessionid  2019-11-01T00:00:00   firefox\n```\n\nWith Batchout, you don't need to write boilerplate code.\n\nJust use `batchout.Batch` for configuring and running your pipeline.\n\n```python\nfrom batchout import Batch\n\nbatch = Batch.from_config(\n    dict(\n        inputs=dict(\n            some_api=dict(\n                type='http',\n                method='get',\n                uri='https://some.api/my/user/sessions',\n            ),\n        ),\n        extractors=dict(\n            first_match_in_json=dict(\n                type='jsonpath',\n            ),\n        ),\n        indexes=dict(\n            session_idx=dict(\n                type='for_list',\n                path='sessions',\n            )\n        ),\n        columns=dict(\n            user_id=dict(\n                type='string',\n                path='user.id',\n            ),\n            user_last_seen=dict(\n                type='string',\n                path='user.last_seen',\n            ),\n            session_id=dict(\n                type='string',\n                path='sessions[{session_idx}].id',  # notice usage of session_idx defined as index above\n            ),\n            session_created_at=dict(\n                type='datetime',\n                path='sessions[{session_idx}].created_at',\n            ),\n            session_useragent=dict(\n                type='datetime',\n                path='sessions[{session_idx}].device.useragent',\n            ),\n        ),\n        maps=dict(\n            some_api=[\n                'user_id',\n                'user_last_seen',\n                dict(\n                    session_idx=[\n                        'session_id',\n                        'session_created_at',\n                        'session_useragent',\n                    ]\n                ),\n            ],\n        ),\n        selectors=dict(\n            all_sessions=dict(\n                type='sql',\n                query='select * from some_api',\n                columns=[\n                    'user_id',\n                    'user_last_seen',\n                    'session_id',\n                    'session_created_at',\n                    'session_useragent',\n                ]\n            )\n        ),\n        outputs=dict(\n            local_db=dict(\n                type='postgres',\n                mode='upsert',\n                keys=['user_id', 'session_id'],\n                host='localhost',\n                port=5432,\n                dbname='somedb',\n                table='user_session',\n                from_env=dict(\n                    user='DB_USER',          # DB_USER and\n                    password='DB_PASSWORD',  # DB_PASSWORD are read from environment\n                ),\n            ),\n        ),\n        tasks=dict(\n            read_sessions=dict(\n                type='reader',\n                inputs=['some_api'],\n            ),\n            write_sessions_to_local_db=dict(\n                type='writer',\n                selector='all_sessions',\n                outputs=['local_db']\n            )\n        )\n    ),\n    defaults=dict(\n        columns=dict(\n            extractor='first_match_in_json',\n        ),\n        indexes=dict(\n            extractor='first_match_in_json',\n        ),\n    ),\n)\nbatch.run_once()\n```\n\n## Use in terminal\n\n> Requires `pip install batchout[cli]`\n\n    $ batchout --help\n    usage: batchout [-h] -c CONFIG [-n NUM_BATCHES] [-w MIN_WAIT_SEC] [-W MAX_WAIT_SEC] [-l LOG_LEVEL]\n    \n    Run Batchout from a config file (YAML)\n    \n    optional arguments:\n      -h, --help            show this help message and exit\n      -c CONFIG, --config CONFIG\n                            Path to YAML config file\n      -I [IMPORT_FROM ...], --import-from [IMPORT_FROM ...]\n                            Import Python modules containing custom Batchout components\n      -n NUM_BATCHES, --num-batches NUM_BATCHES\n                            Stop after N batches (never stop if -1 or less)\n      -w MIN_WAIT_SEC, --min-wait-sec MIN_WAIT_SEC\n                            Minimum seconds to wait between batches\n      -W MAX_WAIT_SEC, --max-wait-sec MAX_WAIT_SEC\n                            Maximum seconds to wait between batches\n      -l LOG_LEVEL, --log-level LOG_LEVEL\n                            Choose logging level between 10 (DEBUG) and 50 (FATAL)\n\n\n## Read documentation\n\nFirst time? Proceed to [Batchout documentation](docs/index.md).\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/ilia-khaustov/batchout",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "batchout",
    "package_url": "https://pypi.org/project/batchout/",
    "platform": null,
    "project_url": "https://pypi.org/project/batchout/",
    "project_urls": {
      "Homepage": "https://github.com/ilia-khaustov/batchout"
    },
    "release_url": "https://pypi.org/project/batchout/0.3.0/",
    "requires_dist": [
      "pyyaml (==6.0) ; extra == 'cli'",
      "jsonpath-rw (==1.4.0) ; extra == 'jsonpath'",
      "psycopg (==3.0.14) ; extra == 'postgres'",
      "lxml (==4.8.0) ; extra == 'xpath'"
    ],
    "requires_python": ">=3.9",
    "summary": "Framework for building data pipelines",
    "version": "0.3.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 14404180,
  "releases": {
    "0.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "605f27cc80c06aa40d08a7efd2ae8612a8112fcdcd5d7e2903ee0750e9807a28",
          "md5": "225a95d6372f0d71e6459c76a4d441dd",
          "sha256": "162aa632918763a7776daea8a0d3880ed71855647685040e2d60dc59b4fd2598"
        },
        "downloads": -1,
        "filename": "batchout-0.0.1-py3.6.egg",
        "has_sig": false,
        "md5_digest": "225a95d6372f0d71e6459c76a4d441dd",
        "packagetype": "bdist_egg",
        "python_version": "3.6",
        "requires_python": ">=3.6",
        "size": 39975,
        "upload_time": "2019-11-04T21:03:19",
        "upload_time_iso_8601": "2019-11-04T21:03:19.478781Z",
        "url": "https://files.pythonhosted.org/packages/60/5f/27cc80c06aa40d08a7efd2ae8612a8112fcdcd5d7e2903ee0750e9807a28/batchout-0.0.1-py3.6.egg",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "c0e4f2acbe4a3416ae0ce9194b78fe3ee7c716afbf1d568831541bc0ac61666a",
          "md5": "896b807ac22d0702261aacc7e66f0a7e",
          "sha256": "34ed7f08907eac57011ae1252a7840eb154fa5e948b856c85ddb7d1bffd4e7e9"
        },
        "downloads": -1,
        "filename": "batchout-0.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "896b807ac22d0702261aacc7e66f0a7e",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6",
        "size": 17024,
        "upload_time": "2019-11-04T21:03:16",
        "upload_time_iso_8601": "2019-11-04T21:03:16.873518Z",
        "url": "https://files.pythonhosted.org/packages/c0/e4/f2acbe4a3416ae0ce9194b78fe3ee7c716afbf1d568831541bc0ac61666a/batchout-0.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "df2c8d80ab0e0a084d35399795778534d8b2abc425e4457fac14f9581ca46952",
          "md5": "27139b3c73e51fad728baa9526426cec",
          "sha256": "9d4f1a2b29e73722c0c03d1c2f15aa96d80950efa3d5b39625004253f631e544"
        },
        "downloads": -1,
        "filename": "batchout-0.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "27139b3c73e51fad728baa9526426cec",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 10735,
        "upload_time": "2019-11-04T21:03:20",
        "upload_time_iso_8601": "2019-11-04T21:03:20.919089Z",
        "url": "https://files.pythonhosted.org/packages/df/2c/8d80ab0e0a084d35399795778534d8b2abc425e4457fac14f9581ca46952/batchout-0.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "9be3b12a25afec91d5a2d163316361bda8166721ca399a7a0f24645148aae1f8",
          "md5": "b23d0ec161c64b456a392c12ca5c433c",
          "sha256": "b81570cfc6e178bb8d1369c28877f5dfd6253c88f78265b42772ec9e865c1f0c"
        },
        "downloads": -1,
        "filename": "batchout-0.1.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "b23d0ec161c64b456a392c12ca5c433c",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6",
        "size": 19538,
        "upload_time": "2019-11-27T21:21:40",
        "upload_time_iso_8601": "2019-11-27T21:21:40.161868Z",
        "url": "https://files.pythonhosted.org/packages/9b/e3/b12a25afec91d5a2d163316361bda8166721ca399a7a0f24645148aae1f8/batchout-0.1.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "c1f96ca19af9d0fe05ba30b3a8cb512e593bbe1fb91fda3b90ef0b020c106151",
          "md5": "a90d2d3da33d99fa54b653f95ad64e5f",
          "sha256": "85dd1e305b0c350b72ab1a440a4a933abaa20805a5d74ae684afdcf7e54ad19b"
        },
        "downloads": -1,
        "filename": "batchout-0.1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "a90d2d3da33d99fa54b653f95ad64e5f",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 11060,
        "upload_time": "2019-11-27T21:21:41",
        "upload_time_iso_8601": "2019-11-27T21:21:41.890393Z",
        "url": "https://files.pythonhosted.org/packages/c1/f9/6ca19af9d0fe05ba30b3a8cb512e593bbe1fb91fda3b90ef0b020c106151/batchout-0.1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.2.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "5fc20cf92e3d3ea0c5f7f4df77d4f2990add9725b55057fcf05aed466e1c147d",
          "md5": "2735889bcd986ef41501fcb2bd98c160",
          "sha256": "fb35a0a4b5a188edbd6e78e74e82fab3f174e3a2a1511bd8a6897b2a89d2a8ae"
        },
        "downloads": -1,
        "filename": "batchout-0.2.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "2735889bcd986ef41501fcb2bd98c160",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6",
        "size": 30950,
        "upload_time": "2020-02-05T07:51:06",
        "upload_time_iso_8601": "2020-02-05T07:51:06.651004Z",
        "url": "https://files.pythonhosted.org/packages/5f/c2/0cf92e3d3ea0c5f7f4df77d4f2990add9725b55057fcf05aed466e1c147d/batchout-0.2.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "98028754ba4af5d9b1ffb2b04184d30e7a735c0ffe198f511377b0fb4c0d2c7f",
          "md5": "b84dc0bed9f995184cc40e2fd442c811",
          "sha256": "13be095c97be0d54e52531ff606e2fc70c877409979576201787c038253919a2"
        },
        "downloads": -1,
        "filename": "batchout-0.2.0.tar.gz",
        "has_sig": false,
        "md5_digest": "b84dc0bed9f995184cc40e2fd442c811",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 15489,
        "upload_time": "2020-02-05T07:51:08",
        "upload_time_iso_8601": "2020-02-05T07:51:08.541092Z",
        "url": "https://files.pythonhosted.org/packages/98/02/8754ba4af5d9b1ffb2b04184d30e7a735c0ffe198f511377b0fb4c0d2c7f/batchout-0.2.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.3.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "3f2bc94d58c029db686c6118a29220fe830b0a18f3ce11c0cac55a0a6339e89f",
          "md5": "ae07e01a4a9989250fb1371336bcb2c1",
          "sha256": "26c8db4ff70da2e1ff4c7720ea64525d716f120efb74f54f7bf2b76ad0b42d79"
        },
        "downloads": -1,
        "filename": "batchout-0.3.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "ae07e01a4a9989250fb1371336bcb2c1",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 35012,
        "upload_time": "2022-07-11T22:42:08",
        "upload_time_iso_8601": "2022-07-11T22:42:08.044696Z",
        "url": "https://files.pythonhosted.org/packages/3f/2b/c94d58c029db686c6118a29220fe830b0a18f3ce11c0cac55a0a6339e89f/batchout-0.3.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "795eb8da5271d5c32d8bd0ec08001b4c24fce2c776c5f930e6afcd8b19c72b5a",
          "md5": "862739c16bfd0ec12cbdd9a815ba56bf",
          "sha256": "c5217c511e943922d28a090f8ad852c7b202b0a73ba9c970902d4a83c56d50ba"
        },
        "downloads": -1,
        "filename": "batchout-0.3.0.tar.gz",
        "has_sig": false,
        "md5_digest": "862739c16bfd0ec12cbdd9a815ba56bf",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 24321,
        "upload_time": "2022-07-11T22:42:09",
        "upload_time_iso_8601": "2022-07-11T22:42:09.387196Z",
        "url": "https://files.pythonhosted.org/packages/79/5e/b8da5271d5c32d8bd0ec08001b4c24fce2c776c5f930e6afcd8b19c72b5a/batchout-0.3.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "3f2bc94d58c029db686c6118a29220fe830b0a18f3ce11c0cac55a0a6339e89f",
        "md5": "ae07e01a4a9989250fb1371336bcb2c1",
        "sha256": "26c8db4ff70da2e1ff4c7720ea64525d716f120efb74f54f7bf2b76ad0b42d79"
      },
      "downloads": -1,
      "filename": "batchout-0.3.0-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "ae07e01a4a9989250fb1371336bcb2c1",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.9",
      "size": 35012,
      "upload_time": "2022-07-11T22:42:08",
      "upload_time_iso_8601": "2022-07-11T22:42:08.044696Z",
      "url": "https://files.pythonhosted.org/packages/3f/2b/c94d58c029db686c6118a29220fe830b0a18f3ce11c0cac55a0a6339e89f/batchout-0.3.0-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "795eb8da5271d5c32d8bd0ec08001b4c24fce2c776c5f930e6afcd8b19c72b5a",
        "md5": "862739c16bfd0ec12cbdd9a815ba56bf",
        "sha256": "c5217c511e943922d28a090f8ad852c7b202b0a73ba9c970902d4a83c56d50ba"
      },
      "downloads": -1,
      "filename": "batchout-0.3.0.tar.gz",
      "has_sig": false,
      "md5_digest": "862739c16bfd0ec12cbdd9a815ba56bf",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.9",
      "size": 24321,
      "upload_time": "2022-07-11T22:42:09",
      "upload_time_iso_8601": "2022-07-11T22:42:09.387196Z",
      "url": "https://files.pythonhosted.org/packages/79/5e/b8da5271d5c32d8bd0ec08001b4c24fce2c776c5f930e6afcd8b19c72b5a/batchout-0.3.0.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}