{
  "info": {
    "author": "",
    "author_email": "\"Nicolas C. Rochette\" <nic.rochette@gmail.com>, \"Angel G. Rivera-Colon\" <angelgr2@illinois.edu>, \"Julian M. Catchen\" <jcatchen@illinois.edu>",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: GNU General Public License v3 or later (GPLv3+)",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3"
    ],
    "description": "\nNAME\n==========\n\n**decoratio** — estimate the DEpth-COmplexity RATIO and amplification noisiness\nof a sequencing experiment based on the PCR clone size histogram.\n\nINSTALLATION\n==========\n\n```sh\npython3 -m pip decoratio\n```\n\nDecoratio depends on `numpy`, `scipy`, and `matplotlib`.\n\nSYNOPSIS\n==========\n\n```sh\npython3 -m decoratio [--model=MODEL] [...] CLONE_SIZE_HISTOGRAM.tsv\n```\n\nAUTHORS & CITATION\n==========\n\nNicolas C. Rochette, Angel G. Rivera-Colón, Julian M. Catchen\n\nIf you use Decoratio, please cite:\n\nRochette NC, Rivera-Colón AG, Walsh J, Sanger TJ, Campbell-Staton SC, Catchen JM\n(2022). On the causes, consequences, and avoidance of PCR duplicates: towards a\ntheory of library complexity. bioRxiv. https://doi.org/10.1101/2022.10.10.511638\n\nDESCRIPTION\n==========\n\nPCR duplicates become prevalent in sequencing experiments when the sequencing\neffort exceeds the number of molecules the library was originally prepared from.\nThe precise duplicates rate that is observed depends primarily on the ratio\nbetween the sequencing depth and the complexity of the library, as well as\nsecondarily on the variance of the amplification factor among the original\ntemplate molecules the library.\n\nThis program leverages PCR duplicate patterns (namely, the relative occurrence\nof duplication clones of various sizes) in a sequencing dataset to jointly\nestimate (1) the depth-complexity ratio, and (2) a variance model for the PCR\namplification of the library. As the sequencing depth should be known to the\nexperimenter, the depth-complexity ratio is a library complexity estimate. This,\ntogether with the amplification variance model, informs on the quality of the\nlibrary, allowing to identify failed libraries and/or to compare the performance\nof a set of library preparation protocols.\n\nInput TSV histogram\n----------\n\nThe main input for the program is a TSV table giving the number of duplication\nclones of each size that were observed. A duplication clone is a set of\nindividual reads that are all descend from the same template, and are PCR\nduplicates of one another. Thus, clones of size 1 correspond to singleton reads\nthat do not have duplicates; clones of size 2 to pairs of duplicate reads;\nclones of size 3 to read triplets; etc.\n\nThe input file should look like this:\n\n```txt\nclone_size  n_clones\n1           9746142\n2           7320751\n3           4969106\n4           3023127\n5           1693158\n6            893344\n7            456659\n...\n# (Empty size classes may be omitted.)\n```\n\nFor instructions on how to obtain this histogram from sequencing data (e.g., BAM\nalignment files), see the EXAMPLES section below.\n\nOptions\n----------\n\n`--model`\n: an amplification model specifier such as \"logskewnormal\" (default),\n\"lognormal\", or \"inheffbeta:12\"; see AMPLIFICATION MODELS below\n\n`--output-prefix`\n: defaults to `CLONE_SIZE_HISTOGRAM.tsv.decoratio.*`\n\n`--ratio-min`, `--ratio-max`\n: constrains the optimization range for the depth-complexity ratio\n\n`--no-plots`, `--tsv-out`, `--log-level`\n: miscelaneous output control\n\nAmplification models\n----------\n\nDefault settings should work well in most cases.\n\nThree models are currently implemented for the amplification: log-skew-normal\n(`logskewnormal`, default), log-normal (`lognormal`), and the empirical\ninherited efficiency model (`inheff` and `inheffbeta` for the original and beta\ndistribution-based versions respectively). All models may be specified without\nparameters, in which case their parameters will be jointly optimized with the\ndepth-complexity ratio, or with user-specified parameters, in which case only\nthe depth-complexity ratio will be optimized.\n\n#### Log-skew-normal and log-normal models\n\nThe PCR duplicate rate is only sensitive to the variance in relative\namplification factors, and not to the mean amplification factor. As a result,\nthe log-normal model has only one parameter (a standard deviation) and\nlog-skew-normal two (a standard deviation and a skew). Thus, for these models\nthe possible values take the form:\n\n```txt\n--model=lognormal\n--model=lognormal:0.54\n--model=logskewnormal\n--model=logskewnormal:0.72:-3.4\n```\n\nAll numerical values are given in units of the natural logarithm (this is\nimportant as e.g., an amplification factor log-distribution with a standard\ndeviation of 0.54 in base *e* has a standard deviation of 0.78 in base 2).\n\n#### Inherited efficiency models\n\nThis is the empirical model of (Best et al., 2015). We provide two closely\nrelated versions, the normal distribution-based model and a stabilized model\nbased on the beta distribution, which we recommend.\n\nA number of PCR cycles (e.g., 12) must always be provided. The models then\ndepend on two additional parameters, the mean efficiency of the PCR process and\nits standard deviation across clones. Thus, possible values take the form:\n\n```txt\n--model=inheff:12\n--model=inheffbeta:12\n--model=inheffbeta:12:0.76:0.14\n```\n\nComputations based on this model are substantially slower. The default is to\nperform binned simulations, as this is more computationally efficient, and the\ndefault effort is to perform 1000 simulations for each of 1000\nefficiency bins. This should work well, but can be changed with\n`--inheff-n-efficiency-bins` and `--inheff-n-sims-per-bin`. Binning during\nsimulations can be deactivated with `--inheff-legacy-sims`. If optimizing the\nparameters, the default is to optimize in a one-dimentional space, but\n`--inheff-uncouple-beta-parameters` will cause the two parameters to be\noptimized independently (for the beta distribution version only). This may\nimpact the precise shape of the amplification factor distribution.\n\nEXAMPLES\n==========\n\n```sh\ncurl -O https://bitbucket.org/rochette/decoratio/raw/HEAD/examples/brown_alone.clone_sizes.tsv\n# Using the default logskewnormal amplification model:\npython3 -m decoratio ./brown_alone.clone_sizes.tsv\n# Using the lognormal amplification model (this is faster):\npython3 -m decoratio --model=lognormal ./brown_alone.clone_sizes.tsv\n# Using a user-specified amplification model:\npython3 -m decoratio --model=logskewnormal:0.72:-3.4 ./brown_alone.clone_sizes.tsv\n```\n\nSample output:\n\n```txt\ndecoratio-1.0.0 (python-3.8, scipy-1.5.2)\nCalled as: decoratio ./brown_alone.clone_sizes.tsv\nOutputing to: ./brown_alone.clone_sizes.tsv.decoratio.logskewnormal.*\nReading input file...\nInput data shows 60.8% PCR duplicates.\nOptimizing the depth-complexity ratio & amplification noise...\nOptimized:\n\n    depth_complexity_ratio = 1.93\n    model = logskewnormal:0.719:-3.4\n\nModel fit was 99.1%; the predicted duplicate was rate 60.7% and the saturation\n75.8%; the amplification model's noisiness was 0.719 and its skewness -0.72.\nWriting output files...\n    ./brown_alone.clone_sizes.tsv.decoratio.logskewnormal.png\n    ./brown_alone.clone_sizes.tsv.decoratio.logskewnormal.ampl_factors.png\nDone.\n```\n\nObtaining the input file\n----------\n\n### Using **gstacks**\n\nFor RAD-seq datasets analyzed using STACKS, the clone sizes histogram is present\nin one of the output files by default:\n\n```sh\nstacks-dist-extract ./gstacks.log.distribs pcr_clone_size_distrib > ./clone_sizes.tsv\npython3 -m decoratio ./clone_sizes.tsv\n# The program can actually be run directly on the distribs file:\npython3 -m decoratio ./gstacks.log.distribs\n```\n\n*n.b.*, for datasets that comprise several libraries, for PCR duplicates and\nlibrary complexity purposes gstacks should be run separately on each library/set\nof samples.\n\n### Using **samtools-markdup**\n\n```sh\nprefix=./my_sample\nsamtools view -b -f0x3 -F0x904 $prefix.bam | \n    samtools collate -O - |\n    samtools fixmate -m - - |\n    samtools sort |\n    samtools markdup -t - $prefix.markdup.bam\n# We then extract the `do:` (presumably \"duplicate of\") tags in the SAM records.\nsamtools view -f0x40 $prefix.markdup.bam |\n    sed -E 's/.*\\tdo:Z:([^\\t]+).*/\\1/; s/\\t.*//' |\n    gzip > $prefix.clones.txt.gz\ngzip -cd $prefix.clones.txt.gz |\n    sort | uniq -c | awk '{print $1}' |\n    sort -n | uniq -c |\n    awk 'BEGIN{print \"clone_size\\tn_clones\"} {print $2 \"\\t\" $1}' \\\n    > $prefix.clone_sizes.tsv\npython3 -m decoratio $prefix.clone_sizes.tsv\n```\n\n### Using **GATK/Picard**\n\n```sh\nprefix=./my_sample\npicard=/path/to/picard.jar\n# Filter for properly aligned read pairs.\nsamtools view -b -f0x3 -F0x904 $prefix.bam > $prefix.paired.bam\n# Sort by read name.\njava -jar $picard \\\n    SortSam \\\n    --SORT_ORDER queryname \\\n    -I $prefix.paired.bam -O $prefix.sortsam.bam \\\n    &> $prefix.sortsam.log\n# Annotate duplicates.\njava -jar $picard \\\n    MarkDuplicates \\\n    --TAG_DUPLICATE_SET_MEMBERS --READ_NAME_REGEX null \\\n    -I $prefix.sortsam.bam -O $prefix.markdups.bam -M $prefix.markdups.txt \\\n    &> $prefix.markdups.log\n# Then extract the `DS:` (duplicate set size, i.e., clone size) tags in the SAM records.\nsamtools view -f0x40 -F0x400 $prefix.markdups.bam |\n    sed -E '/\\tDS:/!s/.*/1/; s/.*\\tDS:i:([0-9]+).*/\\1/' |\n    sort -n | uniq -c |\n    awk 'BEGIN{print \"clone_size\\tn_clones\"} {print $2 \"\\t\" $1}' \\\n    > $prefix.clone_sizes.tsv\npython3 -m decoratio $prefix.clone_sizes.tsv\n```\n\n### Using **UMI-tools**\n\nHandling of duplicates with UMI-tools is appropriate for experiments that make\nuse of unique molecular identifers (e.g., single-cell RNA-seq datasets).\n\nUsers should use the `umi_tools group` command, exporting the information about\nthe size of \"read groups\" (i.e., PCR duplication clones) to a text file with the\n`--group-out` option.\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "decoratio",
    "package_url": "https://pypi.org/project/decoratio/",
    "platform": null,
    "project_url": "https://pypi.org/project/decoratio/",
    "project_urls": {
      "Bugs & Issues": "https://bitbucket.org/rochette/decoratio/issues",
      "Source": "https://bitbucket.org/rochette/decoratio/"
    },
    "release_url": "https://pypi.org/project/decoratio/1.0.5/",
    "requires_dist": [
      "numpy",
      "scipy",
      "matplotlib"
    ],
    "requires_python": ">=3.5",
    "summary": "A bioinformatics package to estimate the depth-complexity ratio and amplification noisiness of a sequencing experiment.",
    "version": "1.0.5",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 16541970,
  "releases": {
    "1.0.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "93246b3f97126d6357428898af24c0c823ec8a63e3b3bd7d63c68ef589485014",
          "md5": "1c7562e6955f03b27a012ee14c3df74c",
          "sha256": "9454ac11e23cea29001f989e605619cf07aa9c1b883d6ae1c451dad05cb8ab30"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.0.tar.gz",
        "has_sig": false,
        "md5_digest": "1c7562e6955f03b27a012ee14c3df74c",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.5",
        "size": 29730,
        "upload_time": "2022-10-07T04:09:49",
        "upload_time_iso_8601": "2022-10-07T04:09:49.327345Z",
        "url": "https://files.pythonhosted.org/packages/93/24/6b3f97126d6357428898af24c0c823ec8a63e3b3bd7d63c68ef589485014/decoratio-1.0.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "b952d9d337f50d9b5b25636cf68ed0bf39efa00c05229e5f2a96347ba6731ad5",
          "md5": "23e7d5b0823135cbd7655054bbd17ebd",
          "sha256": "36ebe6ebbbe8059b7b0344feb7e2726beace3354b994ceed2e6980b402e434cd"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "23e7d5b0823135cbd7655054bbd17ebd",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.5",
        "size": 26647,
        "upload_time": "2023-01-11T17:30:48",
        "upload_time_iso_8601": "2023-01-11T17:30:48.618485Z",
        "url": "https://files.pythonhosted.org/packages/b9/52/d9d337f50d9b5b25636cf68ed0bf39efa00c05229e5f2a96347ba6731ad5/decoratio-1.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "c56ba2cbc4ec53ac913ff3c0b0c65993afa1d8224ac1a62a5c58c8511598846f",
          "md5": "38b6e95329230ad52badd4835b5ef4a8",
          "sha256": "4c27273309de9237ea5fd7650b351d0cff643e25654e459d091b2c95ae23fba5"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "38b6e95329230ad52badd4835b5ef4a8",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.5",
        "size": 29816,
        "upload_time": "2022-10-07T06:09:12",
        "upload_time_iso_8601": "2022-10-07T06:09:12.477763Z",
        "url": "https://files.pythonhosted.org/packages/c5/6b/a2cbc4ec53ac913ff3c0b0c65993afa1d8224ac1a62a5c58c8511598846f/decoratio-1.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "3c41b57187c99e5d62c746a395604ef0af0a662ce0747c427a70fc6b8b3b0d74",
          "md5": "f126d6b49196c8cc40c5b69a661106d4",
          "sha256": "839fe535ce2b42ab8b039ef794a50402fe7d83d4cf2135e5aa6af0dcfa1b87e5"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "f126d6b49196c8cc40c5b69a661106d4",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.5",
        "size": 26650,
        "upload_time": "2023-01-11T17:30:50",
        "upload_time_iso_8601": "2023-01-11T17:30:50.163666Z",
        "url": "https://files.pythonhosted.org/packages/3c/41/b57187c99e5d62c746a395604ef0af0a662ce0747c427a70fc6b8b3b0d74/decoratio-1.0.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "3c738440303a035579156afd74a68ce25043c1eca2c1b7b490c386702b8632a0",
          "md5": "7b74078bdbebf73466a5b97d4f7417b1",
          "sha256": "8251870569fd63c4f85dc5fb63b40d45d7aff19800768a5f1b3b95fc96a0b631"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.2.tar.gz",
        "has_sig": false,
        "md5_digest": "7b74078bdbebf73466a5b97d4f7417b1",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.5",
        "size": 30095,
        "upload_time": "2022-10-17T22:23:31",
        "upload_time_iso_8601": "2022-10-17T22:23:31.085828Z",
        "url": "https://files.pythonhosted.org/packages/3c/73/8440303a035579156afd74a68ce25043c1eca2c1b7b490c386702b8632a0/decoratio-1.0.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "bed6c6273d6236c567c9728fcd815e0590748ace8b29dd3f2b09640ca2d6128d",
          "md5": "d18445520ec47f9f35069fd1b31dc98e",
          "sha256": "f6ec0440849c74ae35dd53ae14568035a43ab83a52f16b6614ad72a5944749b1"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.3-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "d18445520ec47f9f35069fd1b31dc98e",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.5",
        "size": 26647,
        "upload_time": "2023-01-11T17:30:51",
        "upload_time_iso_8601": "2023-01-11T17:30:51.406241Z",
        "url": "https://files.pythonhosted.org/packages/be/d6/c6273d6236c567c9728fcd815e0590748ace8b29dd3f2b09640ca2d6128d/decoratio-1.0.3-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.4": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "12c4fb25a70853a92ee22d5f2edd90410b3564a4d885035c34d0dc2bd6b65092",
          "md5": "a721d43f284993c3a56bb44e5ec39502",
          "sha256": "8f90e0942303629b5285214af1bdd6e5c85021653a948ce6c0c07808501afe12"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.4-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "a721d43f284993c3a56bb44e5ec39502",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.5",
        "size": 26673,
        "upload_time": "2023-01-24T03:25:51",
        "upload_time_iso_8601": "2023-01-24T03:25:51.267548Z",
        "url": "https://files.pythonhosted.org/packages/12/c4/fb25a70853a92ee22d5f2edd90410b3564a4d885035c34d0dc2bd6b65092/decoratio-1.0.4-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.5": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a7961697cc5de8b4f6fd631cbbfae417a0810da293655e8695c8c67ef0d77450",
          "md5": "91a43900d191d289d5cb5787dfd9565d",
          "sha256": "67cfbf74511e3f0770e1c3d147937a909badce4c310664187c6993e5bdc96ee0"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.5-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "91a43900d191d289d5cb5787dfd9565d",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.5",
        "size": 26778,
        "upload_time": "2023-01-24T04:01:25",
        "upload_time_iso_8601": "2023-01-24T04:01:25.843468Z",
        "url": "https://files.pythonhosted.org/packages/a7/96/1697cc5de8b4f6fd631cbbfae417a0810da293655e8695c8c67ef0d77450/decoratio-1.0.5-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "f133be96ae303f7f5e8a5554a88fcc9fd23e528ce072e6c597e2428c8276ea78",
          "md5": "d008a5f65c5bdbce42437b305842ca6e",
          "sha256": "18e45a63a817e68a5baabf1ea946c2a6da55f65783f9d7bd8adb158d9b172cc6"
        },
        "downloads": -1,
        "filename": "decoratio-1.0.5.tar.gz",
        "has_sig": false,
        "md5_digest": "d008a5f65c5bdbce42437b305842ca6e",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.5",
        "size": 30267,
        "upload_time": "2023-01-24T04:01:27",
        "upload_time_iso_8601": "2023-01-24T04:01:27.611858Z",
        "url": "https://files.pythonhosted.org/packages/f1/33/be96ae303f7f5e8a5554a88fcc9fd23e528ce072e6c597e2428c8276ea78/decoratio-1.0.5.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "a7961697cc5de8b4f6fd631cbbfae417a0810da293655e8695c8c67ef0d77450",
        "md5": "91a43900d191d289d5cb5787dfd9565d",
        "sha256": "67cfbf74511e3f0770e1c3d147937a909badce4c310664187c6993e5bdc96ee0"
      },
      "downloads": -1,
      "filename": "decoratio-1.0.5-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "91a43900d191d289d5cb5787dfd9565d",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.5",
      "size": 26778,
      "upload_time": "2023-01-24T04:01:25",
      "upload_time_iso_8601": "2023-01-24T04:01:25.843468Z",
      "url": "https://files.pythonhosted.org/packages/a7/96/1697cc5de8b4f6fd631cbbfae417a0810da293655e8695c8c67ef0d77450/decoratio-1.0.5-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "f133be96ae303f7f5e8a5554a88fcc9fd23e528ce072e6c597e2428c8276ea78",
        "md5": "d008a5f65c5bdbce42437b305842ca6e",
        "sha256": "18e45a63a817e68a5baabf1ea946c2a6da55f65783f9d7bd8adb158d9b172cc6"
      },
      "downloads": -1,
      "filename": "decoratio-1.0.5.tar.gz",
      "has_sig": false,
      "md5_digest": "d008a5f65c5bdbce42437b305842ca6e",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.5",
      "size": 30267,
      "upload_time": "2023-01-24T04:01:27",
      "upload_time_iso_8601": "2023-01-24T04:01:27.611858Z",
      "url": "https://files.pythonhosted.org/packages/f1/33/be96ae303f7f5e8a5554a88fcc9fd23e528ce072e6c597e2428c8276ea78/decoratio-1.0.5.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}