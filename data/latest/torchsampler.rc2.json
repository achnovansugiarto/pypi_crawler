{
  "info": {
    "author": "Ming, et al.",
    "author_email": "a@ufoym.com",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 4 - Beta",
      "Environment :: Console",
      "Intended Audience :: Developers",
      "License :: OSI Approved :: MIT License",
      "Natural Language :: English",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3"
    ],
    "description": "# Imbalanced Dataset Sampler\n\n![license](https://img.shields.io/github/license/ufoym/imbalanced-dataset-sampler.svg)\n\n<a name=\"Introduction\"/>\n\n## Introduction\n\nIn many machine learning applications, we often come across datasets where some types of data may be seen more than other types. Take identification of rare diseases for example, there are probably more normal samples than disease ones. In these cases, we need to make sure that the trained model is not biased towards the class that has more data. As an example, consider a dataset where there are 5 disease images and 20 normal images. If the model predicts all images to be normal, its accuracy is 80%, and F1-score of such a model is 0.88. Therefore, the model has high tendency to be biased toward the ‘normal’ class.\n\nTo solve this problem, a widely adopted technique is called resampling. It consists of removing samples from the majority class (under-sampling) and / or adding more examples from the minority class (over-sampling). Despite the advantage of balancing classes, these techniques also have their weaknesses (there is no free lunch). The simplest implementation of over-sampling is to duplicate random records from the minority class, which can cause overfitting. In under-sampling, the simplest technique involves removing random records from the majority class, which can cause loss of information.\n\n![resampling](https://user-images.githubusercontent.com/2270240/40656410-e0baa230-6376-11e8-8904-c092fb38fcdc.png)\n\nIn this repo, we implement an easy-to-use PyTorch sampler `ImbalancedDatasetSampler` that is able to\n- rebalance the class distributions when sampling from the imbalanced dataset\n- estimate the sampling weights automatically\n- avoid creating a new balanced dataset\n- mitigate overfitting when it is used in conjunction with data augmentation techniques\n\n<p align=\"center\">\n  <img src=\"https://user-images.githubusercontent.com/2270240/40677251-b08f504a-63af-11e8-9653-f28e973a5664.png\">\n</p>\n\n## Usage\n\nFor a simple start install the package via one of following ways:\n\n```bash\npip install torchsampler\n```\n\n\nSimply pass an `ImbalancedDatasetSampler` for the parameter `sampler` when creating a `DataLoader`.\nFor example:\n\n```python\nfrom torchsampler import ImbalancedDatasetSampler\n\ntrain_loader = torch.utils.data.DataLoader(\n    train_dataset,\n    sampler=ImbalancedDatasetSampler(train_dataset),\n    batch_size=args.batch_size,\n    **kwargs\n)\n```\n\nThen in each epoch, the loader will sample the entire dataset and weigh your samples inversely to your class appearing probability.\n\n## Example: Imbalanced MNIST Dataset\n\nDistribution of classes in the imbalanced dataset:\n<p align=\"center\">\n  <img src=\"https://user-images.githubusercontent.com/2270240/40678060-03c6eb9a-63b2-11e8-9a81-c61c665240e3.png\">\n</p>\n\nWith Imbalanced Dataset Sampler:\n<p align=\"center\">\n  <img src=\"https://user-images.githubusercontent.com/2270240/40678100-1e543f12-63b2-11e8-9c05-3b168c3fb39f.png\">\n  (left: test acc in each epoch; right: confusion matrix)\n</p>\n\nWithout Imbalanced Dataset Sampler:\n<p align=\"center\">\n  <img src=\"https://user-images.githubusercontent.com/2270240/40678099-1e0a481c-63b2-11e8-9ec8-f2ac4bf7a637.png\">\n  (left: test acc in each epoch; right: confusion matrix)\n</p>\n\nNote that there are significant improvements for minor classes such as `2` `6` `9`, while the accuracy of the other classes is preserved.\n\n## Contributing\n\nWe appreciate all contributions. If you are planning to contribute back bug-fixes, please do so without any further discussion. If you plan to contribute new features, utility functions or extensions, please first open an issue and discuss the feature with us.\n\n## Licensing\n\n[MIT licensed](https://github.com/ufoym/imbalanced-dataset-sampler/blob/master/LICENSE).\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/ufoym/imbalanced-dataset-sample",
    "keywords": "sampler,pytorch,dataloader",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "torchsampler",
    "package_url": "https://pypi.org/project/torchsampler/",
    "platform": null,
    "project_url": "https://pypi.org/project/torchsampler/",
    "project_urls": {
      "Homepage": "https://github.com/ufoym/imbalanced-dataset-sample"
    },
    "release_url": "https://pypi.org/project/torchsampler/0.1.2/",
    "requires_dist": [
      "torch (>=1.3)",
      "torchvision (>=0.5)",
      "pandas",
      "importlib-metadata ; python_version < \"3.8\""
    ],
    "requires_python": ">=3.6",
    "summary": "A (PyTorch) imbalanced dataset sampler for oversampling low classesand undersampling high frequent ones.",
    "version": "0.1.2",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 13902353,
  "releases": {
    "0.1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "b4997b3589aa17141dd9bc66c80d81511ad348afd0f7820bee0adce0a375cbd1",
          "md5": "6761436f8742d50a7a87bdca713e0348",
          "sha256": "de732e3378e2b7974b9b16d6fa5b398f9f6b382f0d5b36b82148d322e96647d0"
        },
        "downloads": -1,
        "filename": "torchsampler-0.1.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "6761436f8742d50a7a87bdca713e0348",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6",
        "size": 5426,
        "upload_time": "2022-05-18T08:14:05",
        "upload_time_iso_8601": "2022-05-18T08:14:05.054183Z",
        "url": "https://files.pythonhosted.org/packages/b4/99/7b3589aa17141dd9bc66c80d81511ad348afd0f7820bee0adce0a375cbd1/torchsampler-0.1.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "73c5ad6a7d5672ad2735a3f2ec7fe0a86ffda12c9b92a70627366cdbc2a23524",
          "md5": "cf6fb766009530c769377ee7be502766",
          "sha256": "bef693809f67029fdb65900f66d0423c6f7dad945a26d4101bb9f8ca7b845a20"
        },
        "downloads": -1,
        "filename": "torchsampler-0.1.1.tar.gz",
        "has_sig": false,
        "md5_digest": "cf6fb766009530c769377ee7be502766",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 5769,
        "upload_time": "2022-05-18T08:14:06",
        "upload_time_iso_8601": "2022-05-18T08:14:06.765552Z",
        "url": "https://files.pythonhosted.org/packages/73/c5/ad6a7d5672ad2735a3f2ec7fe0a86ffda12c9b92a70627366cdbc2a23524/torchsampler-0.1.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "152b74ff8086106f27dbe7eec0ce680476785d79fd6f934f5c474ce7b597d1fc",
          "md5": "2fb2ccdc31c4437244db838043df7fec",
          "sha256": "a77a1d4bb7d5f134b31ca4aff4de9647d9aa0f416a62e315a403f253ebaf244f"
        },
        "downloads": -1,
        "filename": "torchsampler-0.1.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "2fb2ccdc31c4437244db838043df7fec",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.6",
        "size": 5602,
        "upload_time": "2022-05-23T13:56:18",
        "upload_time_iso_8601": "2022-05-23T13:56:18.684893Z",
        "url": "https://files.pythonhosted.org/packages/15/2b/74ff8086106f27dbe7eec0ce680476785d79fd6f934f5c474ce7b597d1fc/torchsampler-0.1.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "12c0f4fd80e4a8ce5b698d85d037fb3259e1d7cb415d9d85c7f336a1c15a55fe",
          "md5": "85e3dba094bee795ea338cfaf7078156",
          "sha256": "6503acf0ff76888905595006a45c2a2fa017f7a13fffbfcddb3827ef8226ea78"
        },
        "downloads": -1,
        "filename": "torchsampler-0.1.2.tar.gz",
        "has_sig": false,
        "md5_digest": "85e3dba094bee795ea338cfaf7078156",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6",
        "size": 6603,
        "upload_time": "2022-05-23T13:56:19",
        "upload_time_iso_8601": "2022-05-23T13:56:19.921653Z",
        "url": "https://files.pythonhosted.org/packages/12/c0/f4fd80e4a8ce5b698d85d037fb3259e1d7cb415d9d85c7f336a1c15a55fe/torchsampler-0.1.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "152b74ff8086106f27dbe7eec0ce680476785d79fd6f934f5c474ce7b597d1fc",
        "md5": "2fb2ccdc31c4437244db838043df7fec",
        "sha256": "a77a1d4bb7d5f134b31ca4aff4de9647d9aa0f416a62e315a403f253ebaf244f"
      },
      "downloads": -1,
      "filename": "torchsampler-0.1.2-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "2fb2ccdc31c4437244db838043df7fec",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.6",
      "size": 5602,
      "upload_time": "2022-05-23T13:56:18",
      "upload_time_iso_8601": "2022-05-23T13:56:18.684893Z",
      "url": "https://files.pythonhosted.org/packages/15/2b/74ff8086106f27dbe7eec0ce680476785d79fd6f934f5c474ce7b597d1fc/torchsampler-0.1.2-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "12c0f4fd80e4a8ce5b698d85d037fb3259e1d7cb415d9d85c7f336a1c15a55fe",
        "md5": "85e3dba094bee795ea338cfaf7078156",
        "sha256": "6503acf0ff76888905595006a45c2a2fa017f7a13fffbfcddb3827ef8226ea78"
      },
      "downloads": -1,
      "filename": "torchsampler-0.1.2.tar.gz",
      "has_sig": false,
      "md5_digest": "85e3dba094bee795ea338cfaf7078156",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.6",
      "size": 6603,
      "upload_time": "2022-05-23T13:56:19",
      "upload_time_iso_8601": "2022-05-23T13:56:19.921653Z",
      "url": "https://files.pythonhosted.org/packages/12/c0/f4fd80e4a8ce5b698d85d037fb3259e1d7cb415d9d85c7f336a1c15a55fe/torchsampler-0.1.2.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}