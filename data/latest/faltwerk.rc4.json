{
  "info": {
    "author": "Adrian Viehweger",
    "author_email": "adrian.viehweger@medizin.uni-leipzig.de",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "[![Open In Colab](https://colab.research.google.com/assets/colab-badge.svg)](https://colab.research.google.com/github/phiweger/faltwerk/blob/master/examples/example_colab.ipynb)\n\n## Faltwerk\n\n`faltwerk` is a library for spatial exploratory data analysis of protein structures. It helps parse them, select items of interest, generate and visualise various protein annotations, and then provide convenient interfaces for downstream tools to run, for example, spatial regression. The most convenient way to run `faltwerk` is in a `jupyter notebook`. This REPL-like execution gives rapid feedback and can help form hypotheses. However, `faltwerk` also integrates nicely into workflows (no point and click required).\n\n<p align=\"center\">\n    <img src=\"img/cover.png\" alt=\"Antifreeze protein (PDB 3OTM)\" width=\"800\">\n</p>\n\nThe curious thing about proteins is that they come as linear strings of residues, but then fold up into 3D structures, that represent the functionally active form of the molecule (the thing that \"does stuff\"). Correspondingly, nature most often selects on structure. However, many analyses (positive selection etc.) require the linear sequence. `faltwerk` bridges this gap (see specific use cases below).\n\nPRs and suggestions welcome! The awesome `Anvio` has a [structure module](https://merenlab.org/2018/09/04/getting-started-with-anvio-structure/), should you be dissatisfied with `faltwerk`.\n\n\n### Usage\n\n```python\n# TL;DR: Quickly visualize a zinc-finger and annotate the zinc-binding residues\n\n# wget 'http://www.pdb.org/pdb/download/downloadFile.do?fileFormat=pdb&compression=NO&structureId=1MEY' -O 1mey.pdb\nfrom faltwerk import Fold, Binding, Layout\n\nmodel = Fold('1mey.pdb')\nhmms = 'path/to/pfam_v31/Pfam-A.hmm'\nb = Binding(model, option='confident')\nb.predict_binding_(hmms)  # inplace operation\nmodel.annotate_('binding', b.get_binding('PF13912.5', 'ZN'))\nLayout(model).geom_surface('binding').render()\n```\n\n![](img/zinc.png)\n\nWe assume that all protein structures contain a single structure, and if you are not analysing protein complexes, then you want the structures to only contain a single chain, also. A simple way to clean a query pdb file is through `pdb-tools` (http://www.bonvinlab.org/pdb-tools/). _AlphaFold2_ predictions as generated by _ColabFold_ are ideal.\n\nMore information can be found in the [documentation](https://faltwerk.readthedocs.io/en/latest). Additionally, we cover several use cases with `jupyter` notebooks:\n\n```bash\njupyter notebook examples/example_local.ipynb\n```\n\nBut let's step through a [real world example](https://www.science.org/doi/10.1126/science.1259329) of the amazing assymetric selection that can be observed in human transferrin as a consequence of bacterial iron piracy, arr!\n\n```python\n# Load data\nfrom faltwerk.models import Fold, AlphaFold\n# ... (for details see notebook)\n\nfp = 'data/alphafold2/transferrin/test_08df6_unrelaxed_rank_1_model_3.pdb'\nmodel = Fold(fp)\n\n# or\nfp = 'data/alphafold2/transferrin/'\naf = AlphaFold(fp)\nmodel = af.best\n\n# Visualise pLDDT (how good is AF2 the prediction)\nly = Layout(model).geom_ribbon('plddt', palette='rainbow_r')\n```\n\n<p align=\"center\">\n    <img src=\"img/pLDDT.png\" width=\"350\">\n</p>\n\n\n```python\n# Predict ligand binding sites using the \"InteracDome\" approach\nb = Binding(model, 'representable')\nb.predict_binding_(pfam)\nbinding = b.get_binding('PF00405.16', 'FE')\nfe = [i for i, j in enumerate(binding) if j > .5]\n\nly = Layout(model)\n# select\nfe_ = ly.select(residues=fe)\n# style\nly.geom_ribbon(color='#ffffff')\nly.geom_ribbon(selection=fe_, color='red')\nly.render().show()\n```\n\n<p align=\"center\">\n    <img src=\"img/active2.png\" width=\"350\">\n</p>\n\n```python\n# Test for spatial signal in residues that are e. g. mutated or under positive\n# natural selection. Here we use residues from Barber et al., Science, 2014\n# (https://www.science.org/doi/10.1126/science.1259329) that are under positive\n# selection.\noriginal = [153, 253, 382, 434, 435, 436, 439, 558, 574, 575, 576, 591, 592, 593, 614, 617, 619, 625]\n\n# -1 bc/ positions from manuscript are 1-based \nbarber2014 = [i-1 for i in original]\nselection = [1 if i in barber2014 else 0 for i in range(len(model))]\n\n# (1) Spatial autocorrelation, i. e. \"hotspots\" in selected features, here using\n# the Getis-Ord metric.\nFDR = 0.05\nhotspots = find_hotspots(\n    model,\n    selection,\n    method='getis_ord',\n    angstrom=8,\n    false_discovery_rate=FDR,\n    test_two_sided=False)\n\n# (2) Point density analysis, here using HDBSCAN.\nclusters = cluster(model, hotspots, min_cluster_size=5)\n\n# Annotate model\nmodel.annotate_many_({\n    'selection': selection,\n    'hotspots': hotspots,\n    'clusters': clusters})\n\n# Build figure like a layer cake\nly = Layout(model, panel_size=(200, 200), grid=(1, 3), linked=True)\n\npos = ly.select(residues=barber2014, elements=['CA'], chain='A')\n\nly.geom_ribbon(color='#ffffff')\nly.geom_sphere(selection=pos, color='black')\nly.geom_surface('hotspots', palette='binary', panel=(0, 1))\nly.geom_surface('clusters', palette='Set2_r', panel=(0, 2))\nly.render().show()\n```\n\n<p align=\"center\">\n    <img src=\"img/hotspots.png\" width=\"700\">\n</p>\n\nFrom here, `faltwerk` allows to easily interact with downstream tools like `altair` for visualisation of features or `pysal` for spatial regression (see notebook `example.ipynb`)\n\n```python\ndf = pd.DataFrame.from_dict(\n    flatten(model.annotation, expected_track_length=len(model)))\n```\n\n\n## Use cases\n\n- Annotate solvent access, active centers and more\n- Some regions in the amino acid sequence are more conserved than others across species. Which regions in the 3D structure do they correspond to?\n- Are there any significant spatial hotspots where residues experience positive selection?\n- Do observed mutations cluster in any part of the protein, for example in regions that interface other proteins (protein binding sites) or active sites of the protein?\n- A hotspot/ cluster has been identified; which protein features if any can explain this occurance. For example, is the cluster associated with known protein-binding sites?\n- What's the spatial relationship between mutations deemed pathogenic and the annotated functional domains of a protein?\n\n\n### Install\n\nIf you want to programmatically search for hotspots, the easiest way to get started is to use the image we provide through docker:\n\n```bash\ndocker pull nanozoo/faltwerk:3.8--08dc798\n```\n\nQuick start using the [colab notebook](https://colab.research.google.com/github/phiweger/faltwerk/blob/master/examples/example_colab.ipynb).\n\n```bash\n# Dependencies\n!pip install faltwerk==0.3\n# Install tools from upstream and downstream tasks\n!pip install -q pdb-tools altair vega_datasets spreg geopandas\n# More dependencies\n!mamba install -q -y -c conda-forge -c bioconda foldseek=3.915ef7d hmmer\n\n# For local execution in a jupyter notebook\npip install notebook\njupyter notebook examples/example_local.ipynb\n```\n\nIt might be necessary to install a `jupyter` extension to visualize the proteins (you notice if they don't render). Please refer to the `py3Dmol` [install documentation](https://pypi.org/project/py3Dmol/) and [repo](https://github.com/3dmol/3Dmol.js) in this case. A typical setup that renders correctly looks like this (Linux and Mac tested):\n\n```bash\n# ubuntu 20.04. LTS\n# Python 3.10.4\n\nnode --version\n# v10.19.0\n\njupyter --version\n# IPython          : 8.4.0\n# ipykernel        : 6.15.1\n# ipywidgets       : not installed\n# jupyter_client   : 7.3.4\n# jupyter_core     : 4.11.1\n# jupyter_server   : not installed\n# jupyterlab       : not installed\n# nbclient         : 0.6.6\n# nbconvert        : 6.5.3\n# nbformat         : 5.4.0\n# notebook         : 6.4.12\n# qtconsole        : not installed\n# traitlets        : 5.3.0\n```\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "",
    "license": "BSD 3-clause",
    "maintainer": "",
    "maintainer_email": "",
    "name": "faltwerk",
    "package_url": "https://pypi.org/project/faltwerk/",
    "platform": null,
    "project_url": "https://pypi.org/project/faltwerk/",
    "project_urls": null,
    "release_url": "https://pypi.org/project/faltwerk/0.5/",
    "requires_dist": [
      "biopython (==1.79)",
      "screed (==1.0.5)",
      "py3Dmol (==1.8.1)",
      "markov-clustering (==0.0.6.dev0)",
      "hdbscan (==0.8.28)",
      "networkx (==2.6.3)",
      "numpy (==1.21.6)",
      "pandas (==1.3.5)",
      "matplotlib (==3.5.3)",
      "pytest (==7.1.2)",
      "libpysal (==4.6.2)",
      "esda (==2.4.3)",
      "multiprocess (==0.70.13)",
      "nbsphinx",
      "myst-parser (==0.18.1)",
      "Jinja2 (==3.1.2)",
      "alabaster",
      "ipython",
      "sphinxcontrib-napoleon",
      "docutils (<0.20,>=0.17.1)"
    ],
    "requires_python": "",
    "summary": "Spatial analysis of protein structures",
    "version": "0.5",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 15855219,
  "releases": {
    "0.2.36": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "7371950e8da6990e7b69a23deadd5c3d81e4a2f2d2daddfbd9a32f953b8a6e04",
          "md5": "512ecf6318113a828fbb63288f02bcc8",
          "sha256": "9dfe014619486d17326239b05a426d4a9c0da6c680e56fb058726edeb5b3682f"
        },
        "downloads": -1,
        "filename": "faltwerk-0.2.36-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "512ecf6318113a828fbb63288f02bcc8",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": null,
        "size": 11495992,
        "upload_time": "2022-08-19T18:40:45",
        "upload_time_iso_8601": "2022-08-19T18:40:45.040341Z",
        "url": "https://files.pythonhosted.org/packages/73/71/950e8da6990e7b69a23deadd5c3d81e4a2f2d2daddfbd9a32f953b8a6e04/faltwerk-0.2.36-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "41ac906a1500f396c4aa8b8444e36d07db909d26395b48f9ab1f5ef26735d381",
          "md5": "dd0d0ef658ea40eff9f13dffc8c51165",
          "sha256": "8928a1faf7086d3a7d0b015411df417ad3b473e7c46eb4ff146007b8d4a3347f"
        },
        "downloads": -1,
        "filename": "faltwerk-0.2.36.tar.gz",
        "has_sig": false,
        "md5_digest": "dd0d0ef658ea40eff9f13dffc8c51165",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 11288076,
        "upload_time": "2022-08-19T18:40:49",
        "upload_time_iso_8601": "2022-08-19T18:40:49.308770Z",
        "url": "https://files.pythonhosted.org/packages/41/ac/906a1500f396c4aa8b8444e36d07db909d26395b48f9ab1f5ef26735d381/faltwerk-0.2.36.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "c973c027470b7b5ad740bf8c47bc2203a6c238978deea11046278fb73646a067",
          "md5": "dccb4f300c30a7c9b29a1deb3b32981c",
          "sha256": "2842261a46135e2e0b39dffc3de751bb6212df103012f8633b59b8c9406cf08b"
        },
        "downloads": -1,
        "filename": "faltwerk-0.3-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "dccb4f300c30a7c9b29a1deb3b32981c",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": null,
        "size": 11496328,
        "upload_time": "2022-08-20T06:00:28",
        "upload_time_iso_8601": "2022-08-20T06:00:28.376526Z",
        "url": "https://files.pythonhosted.org/packages/c9/73/c027470b7b5ad740bf8c47bc2203a6c238978deea11046278fb73646a067/faltwerk-0.3-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "196fa999b9c7710a45dc3564a921e6e41aed0bb8070ba39acc877eb894e044c3",
          "md5": "0ddf49c6c9b08cfc273585bb8a37ebbc",
          "sha256": "61bff0a5c57c8329a5f090273d39b235fd580ddc66c55b4497605d99bf8b1333"
        },
        "downloads": -1,
        "filename": "faltwerk-0.3.tar.gz",
        "has_sig": false,
        "md5_digest": "0ddf49c6c9b08cfc273585bb8a37ebbc",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 11288565,
        "upload_time": "2022-08-20T06:00:33",
        "upload_time_iso_8601": "2022-08-20T06:00:33.427474Z",
        "url": "https://files.pythonhosted.org/packages/19/6f/a999b9c7710a45dc3564a921e6e41aed0bb8070ba39acc877eb894e044c3/faltwerk-0.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.4": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "93261b01dc30aeec2abb5f92866e27d5b822584649416acce09755745f6b03d8",
          "md5": "df316d32b3e3a38952f4a9345744a0ba",
          "sha256": "5145e953892bea1cca2ff9fc567e5a43619281fe89aea03e3238f690ead87274"
        },
        "downloads": -1,
        "filename": "faltwerk-0.4-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "df316d32b3e3a38952f4a9345744a0ba",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": null,
        "size": 11500379,
        "upload_time": "2022-10-03T18:48:31",
        "upload_time_iso_8601": "2022-10-03T18:48:31.788376Z",
        "url": "https://files.pythonhosted.org/packages/93/26/1b01dc30aeec2abb5f92866e27d5b822584649416acce09755745f6b03d8/faltwerk-0.4-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "7ce945dbef0e6c5bb0e4b30e27bea6cfb3f20b9273af63950197ef76046a500d",
          "md5": "12e70d4a7f581ab6e72efea057048fc8",
          "sha256": "48669cb59f9243c05def682f7637733ab40bce64aa9ff9c445e2dfc0c3f8281a"
        },
        "downloads": -1,
        "filename": "faltwerk-0.4.tar.gz",
        "has_sig": false,
        "md5_digest": "12e70d4a7f581ab6e72efea057048fc8",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 11291918,
        "upload_time": "2022-10-03T18:48:36",
        "upload_time_iso_8601": "2022-10-03T18:48:36.564951Z",
        "url": "https://files.pythonhosted.org/packages/7c/e9/45dbef0e6c5bb0e4b30e27bea6cfb3f20b9273af63950197ef76046a500d/faltwerk-0.4.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.5": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "da8d5d2b07b7f621e6968c15196b721277202c7696926a182ea452ef48020af0",
          "md5": "a63b3b41db26cf6a3b23d454a6b67012",
          "sha256": "d42cd81a4ffa6aa18c7a9d6526d8ee12cabb900195e274a25331ae5e71a687a6"
        },
        "downloads": -1,
        "filename": "faltwerk-0.5-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "a63b3b41db26cf6a3b23d454a6b67012",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": null,
        "size": 11503087,
        "upload_time": "2022-11-22T15:07:34",
        "upload_time_iso_8601": "2022-11-22T15:07:34.845462Z",
        "url": "https://files.pythonhosted.org/packages/da/8d/5d2b07b7f621e6968c15196b721277202c7696926a182ea452ef48020af0/faltwerk-0.5-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "cd11cfcd302e88120960ce58e437e4a59b053834c45a24cfdcd4d5686f210f7a",
          "md5": "af57df31f63560e59161bdf3272d0972",
          "sha256": "69a2cb6706806e880d0fcc6fe5254357e9944030f1d1f04110d728efa1588060"
        },
        "downloads": -1,
        "filename": "faltwerk-0.5.tar.gz",
        "has_sig": false,
        "md5_digest": "af57df31f63560e59161bdf3272d0972",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": null,
        "size": 11294474,
        "upload_time": "2022-11-22T15:07:39",
        "upload_time_iso_8601": "2022-11-22T15:07:39.860754Z",
        "url": "https://files.pythonhosted.org/packages/cd/11/cfcd302e88120960ce58e437e4a59b053834c45a24cfdcd4d5686f210f7a/faltwerk-0.5.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "da8d5d2b07b7f621e6968c15196b721277202c7696926a182ea452ef48020af0",
        "md5": "a63b3b41db26cf6a3b23d454a6b67012",
        "sha256": "d42cd81a4ffa6aa18c7a9d6526d8ee12cabb900195e274a25331ae5e71a687a6"
      },
      "downloads": -1,
      "filename": "faltwerk-0.5-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "a63b3b41db26cf6a3b23d454a6b67012",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": null,
      "size": 11503087,
      "upload_time": "2022-11-22T15:07:34",
      "upload_time_iso_8601": "2022-11-22T15:07:34.845462Z",
      "url": "https://files.pythonhosted.org/packages/da/8d/5d2b07b7f621e6968c15196b721277202c7696926a182ea452ef48020af0/faltwerk-0.5-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "cd11cfcd302e88120960ce58e437e4a59b053834c45a24cfdcd4d5686f210f7a",
        "md5": "af57df31f63560e59161bdf3272d0972",
        "sha256": "69a2cb6706806e880d0fcc6fe5254357e9944030f1d1f04110d728efa1588060"
      },
      "downloads": -1,
      "filename": "faltwerk-0.5.tar.gz",
      "has_sig": false,
      "md5_digest": "af57df31f63560e59161bdf3272d0972",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": null,
      "size": 11294474,
      "upload_time": "2022-11-22T15:07:39",
      "upload_time_iso_8601": "2022-11-22T15:07:39.860754Z",
      "url": "https://files.pythonhosted.org/packages/cd/11/cfcd302e88120960ce58e437e4a59b053834c45a24cfdcd4d5686f210f7a/faltwerk-0.5.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}