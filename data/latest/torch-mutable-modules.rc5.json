{
  "info": {
    "author": "KentoNishi",
    "author_email": "kento24gs@outlook.com",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: MIT License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3"
    ],
    "description": "# Torch Mutable Modules\n\nUse in-place and assignment operations on PyTorch module parameters with support for autograd.\n\n[![Publish to PyPI](https://github.com/KentoNishi/torch-mutable-modules/actions/workflows/publish.yaml/badge.svg)](https://github.com/KentoNishi/torch-mutable-modules/actions/workflows/publish.yaml)\n[![Run tests](https://github.com/KentoNishi/torch-mutable-modules/actions/workflows/test.yaml/badge.svg)](https://github.com/KentoNishi/torch-mutable-modules/actions/workflows/test.yaml)\n[![PyPI version](https://img.shields.io/pypi/v/torch-mutable-modules.svg?style=flat)](https://pypi.org/project/torch-mutable-modules/)\n[![Number of downloads from PyPI per month](https://img.shields.io/pypi/dm/torch-mutable-modules.svg?style=flat)](https://pypi.org/project/torch-mutable-modules/)\n![Python version support](https://img.shields.io/pypi/pyversions/torch-mutable-modules)\n[![Code Style: Black](https://img.shields.io/badge/code%20style-black-black.svg)](https://github.com/ambv/black)\n\n## Why does this exist?\n\nPyTorch does not allow in-place operations on module parameters (usually desirable):\n\n```python\nlinear_layer = torch.nn.Linear(1, 1)\nlinear_layer.weight.data += 69\n# ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n# Valid, but will NOT store grad_fn=<AddBackward0>\nlinear_layer.weight += 420\n# ^^^^^^^^^^^^^^^^^^^^^^^^\n# RuntimeError: a leaf Variable that requires grad is being used in an in-place operation.\n```\n\nIn some cases, however, it is useful to be able to modify module parameters in-place. For example, if we have a neural network (`net_1`) that predicts the parameter values to another neural network (`net_2`), we need to be able to modify the weights of `net_2` in-place and backpropagate the gradients to `net_1`.\n\n```python\n# create a parameter predictor network (net_1)\nnet_1 = torch.nn.Linear(1, 2)\n# create an optimizer for net_1\noptimizer_1 = torch.optim.SGD(net_1.parameters(), lr=0.01)\n\n# predict the weights and biases of net_2 using net_1\np_weight_and_bias = net_1(input_0).unsqueeze(2)\np_weight, p_bias = p_weight_and_bias[:, 0], p_weight_and_bias[:, 1]\n\n# create a mutable network (net_2)\nnet_2 = to_mutable_module(torch.nn.Linear(1, 1))\n\n# hot-swap the weights and biases of net_2 with the predicted values\nnet_2.weight = p_weight\nnet_2.bias = p_bias\n\n# compute the output and backpropagate the gradients to net_1\noutput = net_2(input_1)\nloss = criterion(output, label)\nloss.backward()\noptimizer.step()\n```\n\nThis library provides a way to easily convert PyTorch modules into mutable modules with the `to_mutable_module` function.\n\n## Installation\nYou can install `torch-mutable-modules` from [PyPI](https://pypi.org/project/torch-mutable-modules/).\n\n```bash\npip install torch-mutable-modules\n```\n\nTo upgrade an existing installation of `torch-mutable-modules`, use the following command:\n\n```bash\npip install --upgrade --no-cache-dir torch-mutable-modules\n```\n\n## Importing\n\nYou can use wildcard imports or import specific functions directly:\n\n```python\n# import all functions\nfrom torch_mutable_modules import *\n\n# ... or import the function manually\nfrom torch_mutable_modules import to_mutable_module\n```\n\n## Usage\n\nTo convert an existing PyTorch module into a mutable module, use the `to_mutable_module` function:\n\n```python\nconverted_module = to_mutable_module(\n    torch.nn.Linear(1, 1)\n) # type of converted_module is still torch.nn.Linear\n\nconverted_module.weight *= 0\nconvreted_module.weight += 69\nconvreted_module.weight # tensor([[69.]], grad_fn=<AddBackward0>)\n```\n\nYou can also declare your own PyTorch module classes as mutable, and all child modules will be recursively converted into mutable modules:\n\n```python\nclass MyModule(nn.Module):\n    def __init__(self):\n        super().__init__()\n        self.linear = nn.Linear(1, 1)\n\n    def forward(self, x):\n        return self.linear(x)\n\nmy_module = to_mutable_module(MyModule())\nmy_module.linear.weight *= 0\nmy_module.linear.weight += 69\nmy_module.linear.weight # tensor([[69.]], grad_fn=<AddBackward0>)\n```\n\n### Usage with CUDA\n\nTo create a module on the GPU, simply pass a PyTorch module that is already on the GPU to the `to_mutable_module` function:\n\n```python\nconverted_module = to_mutable_module(\n    torch.nn.Linear(1, 1).cuda()\n) # converted_module is now a mutable module on the GPU\n```\n\nMoving a module to the GPU with `.to()` and `.cuda()` after instanciation is ***NOT*** supported. Instead, hot-swap the module parameter tensors with their CUDA counterparts.\n\n```python\n# both of these are valid\nconverted_module.weight = converted_module.weight.cuda()\nconverted_module.bias = converted_module.bias.to(\"cuda\")\n```\n\n\n### Detailed examples\n\nPlease check out [example.py](./example.py) to see more detailed example usages of the `to_mutable_module` function.\n\n## Contributing\nPlease feel free to submit issues or pull requests!\n\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/KentoNishi/torch-mutable-modules",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "torch-mutable-modules",
    "package_url": "https://pypi.org/project/torch-mutable-modules/",
    "platform": null,
    "project_url": "https://pypi.org/project/torch-mutable-modules/",
    "project_urls": {
      "Homepage": "https://github.com/KentoNishi/torch-mutable-modules"
    },
    "release_url": "https://pypi.org/project/torch-mutable-modules/1.1.2/",
    "requires_dist": [
      "torch (>=1.7.0)"
    ],
    "requires_python": ">=3.7",
    "summary": "",
    "version": "1.1.2",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 14047958,
  "releases": {
    "1.0.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "0a77e670dee17e63dafcaf6ef8cb885d8892cbfde1872d4a69b2c26725a9b857",
          "md5": "d9cc8206ccc0ef99bb62ed62099244fe",
          "sha256": "cd1c20d7b436c99ee055f3c27ecf2988fb18b13b2ef400a2ce1b930f105f4ca7"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.0.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "d9cc8206ccc0ef99bb62ed62099244fe",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.4",
        "size": 4677,
        "upload_time": "2022-02-01T03:26:00",
        "upload_time_iso_8601": "2022-02-01T03:26:00.693055Z",
        "url": "https://files.pythonhosted.org/packages/0a/77/e670dee17e63dafcaf6ef8cb885d8892cbfde1872d4a69b2c26725a9b857/torch_mutable_modules-1.0.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "64b8448c76d161ecde4d93e77fd62c522978150867caa873eb57d5fd80f8e8b8",
          "md5": "0cb21c1d56eaab0fab981fd49a771043",
          "sha256": "ef6391b72ea7aa1dbd0a693e7d9c49e1feedc02785f6df032556a9cd425d1630"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.0.0.tar.gz",
        "has_sig": false,
        "md5_digest": "0cb21c1d56eaab0fab981fd49a771043",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.4",
        "size": 4220,
        "upload_time": "2022-02-01T03:26:02",
        "upload_time_iso_8601": "2022-02-01T03:26:02.537657Z",
        "url": "https://files.pythonhosted.org/packages/64/b8/448c76d161ecde4d93e77fd62c522978150867caa873eb57d5fd80f8e8b8/torch_mutable_modules-1.0.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "0cd3cd01a7863e3fa0ad4cb217b172a41c92b29dc4107e16b6a25492cd612953",
          "md5": "082bc189a27590a0825462624879c479",
          "sha256": "646be60194f28e7e0b78483e08462255d92677601b3f73ff57d1f64b4f146a80"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "082bc189a27590a0825462624879c479",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.4",
        "size": 4744,
        "upload_time": "2022-02-01T03:41:42",
        "upload_time_iso_8601": "2022-02-01T03:41:42.813120Z",
        "url": "https://files.pythonhosted.org/packages/0c/d3/cd01a7863e3fa0ad4cb217b172a41c92b29dc4107e16b6a25492cd612953/torch_mutable_modules-1.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "eb39af2f6f531349488f36842265c1831121c08b57929d2d2e285023027fcc32",
          "md5": "d491977912fa73a7ee29fbf212645312",
          "sha256": "577c5a30be52a1523938b1cd2c0891a2987b57f42cabefc227882f78c22395f9"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "d491977912fa73a7ee29fbf212645312",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.4",
        "size": 4284,
        "upload_time": "2022-02-01T03:41:43",
        "upload_time_iso_8601": "2022-02-01T03:41:43.895497Z",
        "url": "https://files.pythonhosted.org/packages/eb/39/af2f6f531349488f36842265c1831121c08b57929d2d2e285023027fcc32/torch_mutable_modules-1.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "69ab2a0008e767cee9e884207f1164393c5792f8e5a68f6281059970dd1aafb4",
          "md5": "72663bbfa4b21e6024fca9853024dbee",
          "sha256": "84b74a43731f1382c25e8533bcde0b454940e7706d6f27bf87626c1470956b83"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.1.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "72663bbfa4b21e6024fca9853024dbee",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.4",
        "size": 4778,
        "upload_time": "2022-02-01T21:20:00",
        "upload_time_iso_8601": "2022-02-01T21:20:00.075476Z",
        "url": "https://files.pythonhosted.org/packages/69/ab/2a0008e767cee9e884207f1164393c5792f8e5a68f6281059970dd1aafb4/torch_mutable_modules-1.1.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "03962c4c3b4c7b8da9f5271e4c7f9aeb0fa845858285a9a4e9e1896bb9379596",
          "md5": "47535781e7295c5b12efcfba9bb7f489",
          "sha256": "0692510fdbc6064a3112b27b329b7d612121c7c08168aaba53840a50ef127a8f"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "47535781e7295c5b12efcfba9bb7f489",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.4",
        "size": 4343,
        "upload_time": "2022-02-01T21:20:02",
        "upload_time_iso_8601": "2022-02-01T21:20:02.083407Z",
        "url": "https://files.pythonhosted.org/packages/03/96/2c4c3b4c7b8da9f5271e4c7f9aeb0fa845858285a9a4e9e1896bb9379596/torch_mutable_modules-1.1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "c5fdb9828e43bb316f78c74854b96581ec03d216d334020d3ec01063e57fc74e",
          "md5": "1e7c425978cdf68b7d843fea9bad0c57",
          "sha256": "97d88b1bab510c3caf4226bbecb47c79557fbb563e53698b2601ff29deac7098"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.1.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "1e7c425978cdf68b7d843fea9bad0c57",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 4816,
        "upload_time": "2022-06-05T19:53:05",
        "upload_time_iso_8601": "2022-06-05T19:53:05.264372Z",
        "url": "https://files.pythonhosted.org/packages/c5/fd/b9828e43bb316f78c74854b96581ec03d216d334020d3ec01063e57fc74e/torch_mutable_modules-1.1.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "7ddeaa4bb98a26db949a39181ec3d2d9341f3a19aa12146bf0105d1186889020",
          "md5": "4f235015ff9fd1e5535d0ffa6600c7fa",
          "sha256": "6e750836734aef96ada6e07826188b026725e53f2a54076375fd15baa9ea1709"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.1.1.tar.gz",
        "has_sig": false,
        "md5_digest": "4f235015ff9fd1e5535d0ffa6600c7fa",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 4379,
        "upload_time": "2022-06-05T19:53:07",
        "upload_time_iso_8601": "2022-06-05T19:53:07.540400Z",
        "url": "https://files.pythonhosted.org/packages/7d/de/aa4bb98a26db949a39181ec3d2d9341f3a19aa12146bf0105d1186889020/torch_mutable_modules-1.1.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "1.1.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "0eae9b455c0bbc40e0c971bc96b8a94d4178ba4814d7a719b70d342c6f5a7845",
          "md5": "f168b9fcdbee8106be470d8c977ac0bd",
          "sha256": "114616174f1215c7bbb39c2f4e4bcf393d231e8dbba1e2719a7e70e8087f5606"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.1.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "f168b9fcdbee8106be470d8c977ac0bd",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 4843,
        "upload_time": "2022-06-06T18:11:15",
        "upload_time_iso_8601": "2022-06-06T18:11:15.964118Z",
        "url": "https://files.pythonhosted.org/packages/0e/ae/9b455c0bbc40e0c971bc96b8a94d4178ba4814d7a719b70d342c6f5a7845/torch_mutable_modules-1.1.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "2ceb4a4792986f0f7d688a46deefa34dbeb06dc6135e63c257978319386191ad",
          "md5": "e4078c5bdcae1467a7b5fa3864a6933d",
          "sha256": "01cd2d1f37f06489ab086cb1e4064cf16cec9ddc59968feb35c74b43aee23a18"
        },
        "downloads": -1,
        "filename": "torch_mutable_modules-1.1.2.tar.gz",
        "has_sig": false,
        "md5_digest": "e4078c5bdcae1467a7b5fa3864a6933d",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 4417,
        "upload_time": "2022-06-06T18:11:18",
        "upload_time_iso_8601": "2022-06-06T18:11:18.103911Z",
        "url": "https://files.pythonhosted.org/packages/2c/eb/4a4792986f0f7d688a46deefa34dbeb06dc6135e63c257978319386191ad/torch_mutable_modules-1.1.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "0eae9b455c0bbc40e0c971bc96b8a94d4178ba4814d7a719b70d342c6f5a7845",
        "md5": "f168b9fcdbee8106be470d8c977ac0bd",
        "sha256": "114616174f1215c7bbb39c2f4e4bcf393d231e8dbba1e2719a7e70e8087f5606"
      },
      "downloads": -1,
      "filename": "torch_mutable_modules-1.1.2-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "f168b9fcdbee8106be470d8c977ac0bd",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7",
      "size": 4843,
      "upload_time": "2022-06-06T18:11:15",
      "upload_time_iso_8601": "2022-06-06T18:11:15.964118Z",
      "url": "https://files.pythonhosted.org/packages/0e/ae/9b455c0bbc40e0c971bc96b8a94d4178ba4814d7a719b70d342c6f5a7845/torch_mutable_modules-1.1.2-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "2ceb4a4792986f0f7d688a46deefa34dbeb06dc6135e63c257978319386191ad",
        "md5": "e4078c5bdcae1467a7b5fa3864a6933d",
        "sha256": "01cd2d1f37f06489ab086cb1e4064cf16cec9ddc59968feb35c74b43aee23a18"
      },
      "downloads": -1,
      "filename": "torch_mutable_modules-1.1.2.tar.gz",
      "has_sig": false,
      "md5_digest": "e4078c5bdcae1467a7b5fa3864a6933d",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7",
      "size": 4417,
      "upload_time": "2022-06-06T18:11:18",
      "upload_time_iso_8601": "2022-06-06T18:11:18.103911Z",
      "url": "https://files.pythonhosted.org/packages/2c/eb/4a4792986f0f7d688a46deefa34dbeb06dc6135e63c257978319386191ad/torch_mutable_modules-1.1.2.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}