{
  "info": {
    "author": "perfectstorm88",
    "author_email": "perfectstorm88@163.com",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "![在这里插入图片描述](https://img-blog.csdnimg.cn/20210607195419420.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpY2hhbmd6aGVuMjAwOA==,size_16,color_FFFFFF,t_70)\n\n@[TOC]\n\n参考博文：\n\n[docker部署规范-目录结构与辅助工具](https://blog.csdn.net/lichangzhen2008/article/details/117672233?spm=1001.2014.3001.5501)\n\n本规范根据多个项目实践总结，通过**目录结构规范化，结合辅助工具**，可以降低在多节点、新环境部署中的重复工作与沟通工作量，大幅提供部署效率。\n\n## 规范部署目录结构\n\n目录结构的规划基于下面几点考虑：\n\n- 一个主机上可以部署多套系统\n- 一个系统应该是”自洽“的，具有完整的逻辑性，系统涉及的所有文件是自包含的\n- 目录结果尽量简单，便于管理(不再执行dockcer-compose up --build命令)，本地的配置修改通过volumes文件夹或文件挂载的方式进行容器内文件覆盖完成\n\n目录结构如下所示:\n\n- [产品]-deplopy:\n  - **docker-compose.yml**: 主文件\n  - **conf**： 配置文件，如nginx配置，mysql配置文件等\n    - `web/nginx.conf`: nginx的配置文件夹，例如路由配置，安全设置等。\n    - `web/ca/` :nginx的证书文件目录。\n    - `mysql/` :msql的配置文件等\n  - **data**: 运行过程中的数据，如数据库存储目录，程序的临时文件目录\n    - `mysql/` :msql的数据库文件目录\n    - `mongo/` :mongodb的数据库文件目录\n  - **jar**: 包含服务用的jar文件、或者其他格式的代码打包文件等\n  - **log**: 程序日志目标\n  - **back**: 程序备份目录\n\n## 辅助工具解决\n辅助工具参考：[github代码 dc-help](https://github.com/perfectstorm88/dc-help)\n工具安装\n\n```bash\ngit clone https://github.com/perfectstorm88/dc-help\ncd dc-help\npython setup.py install\n```\n\n在docker-compose.yml所在目录，执行`dc-help -h`\n\n```txt\nusage: dc-help COMMAND\n\ndocker-compose辅助工具,帮助管理镜像、版本文件\n\noptional arguments:\n  -h, --help           show this help message and exit\n\nCOMMAND:\n  {image,file,daemon}\n    image              管理docker-compose.yml中的镜像，打包、装载、清理、升级\n    file               对文件夹进行压缩和解压缩,默认是conf、data、jar等文件夹\n    daemon             daemon的状态、启动和停止\n```\n\n其中`dc-help image -h`\n\n```log\nusage: dc-help COMMAND image [-h] (--pack | --unpack | --clear | --upgrade)\n\noptional arguments:\n  -h, --help  show this help message and exit\n  --pack      对镜像进行自动打包\n  --unpack    对镜像进行自动装载\n  --clear     对镜像文件进行清理\n  --upgrade   对镜像文件进行自动装载，然后升级`\n```\n\n## 功能介绍\n\n*  [x] `dc-help image --pack`：对项目的镜像进行自动打包\n*  [x] `dc-help image --unpack`：对项目的镜像进行自动装载\n*  [x] `dc-help image --clear`：对项目的镜像进行清理\n*  [x] `dc-help image --upgrade`：扫描备份目录，判断是否有镜像更新，进行自动装载，更新集群服务\n*  [x] `dc-help file --pack`：对项目的配置和数据文件进行自动打包压缩\n*  [x] `dc-help file --unpack`：对项目的配置和数据文件进行自动解压缩\n*  [x] `dc-help daemon --status`：查看自动升级服务的状态，running 或 not running\n*  [x] `dc-help daemon --start`：启动自动升级服务\n*  [x] `dc-help daemon --stop`：停止自动升级服务\n\n# 安装部署\n## pip安装\n```\npip install dc-help\n```\n## 源代码安装\n```\ngit clone https://github.com/perfectstorm88/dc-help.git\ncd dc-help\npython setup.py install \n```\n## 离线安装(docker,推荐)\n如果部署在客户内网，离线建议采用docker方式，在容器内执行docker命令\n\n1. 首先下载源代码，构建docker镜像：\n```bash\ngit clone https://github.com/perfectstorm88/dc-help.git\ncd dc-help\ndocker build -t dc-help . # 构建docker\ndocker save dc-help >dc-help-docker-image.tar\ngzip dc-help-docker-image.tar\n```\n\n2. 在内网主机，把dc-help-docker-image.tar.gz上传到部署主机,还原镜像：\n```bash\ndocker  load -i dc-help-docker-image.tar\n```\n3. 配置alias,在~/.bashrc中增加alias：（通过 vim ~/.bashrc编辑后，执行 source ~/.bashrc后生效）\n```bash\nalias dc-help='docker run --rm -t -u root  -v $(which docker):/usr/bin/docker  -v $(which docker-compose):/usr/bin/docker-compose  -v /var/run/docker.sock:/var/run/docker.sock  -v /usr/lib64/libltdl.so.7:/usr/lib/x86_64-linux-gnu/libltdl.so.7 -v $(pwd):$(pwd)  -w $(pwd) dc-help dc-help'\n```\n\n\n## 离线源码安装dc-help工具(centos7)\n● (安装setuptools（若没有的话需要安装，视centos的版本，有的环境不需要这一步）\nhttps://pypi.org/project/setuptools/36.5.0/\n下载setuptools-36.5.0.tar.gz\n不能下过高版本，因为python2语法不支持\n\n```bash\ntar -zxvf setuptools-36.5.0.tar.gz \n#若外网下载zip格式，则 unzip setuptools-36.5.0.zip\ncd setuptools-36.5.0\npython setup.py install\n```\n源代码安装步骤同上\n\n## \t离线源码安装dc-help工具(centos8)\ncentos8已经默认不自带python版本，需要先安装python2，参见[VirtualBox CentOS8 挂载iso镜像](https://juejin.cn/post/6937962931212517406)\n\n源代码安装步骤同上\n\n## 参考\n\n- [How to get exact date for docker images?如何抽取镜像时间](https://stackoverflow.com/questions/32705176/how-to-get-exact-date-for-docker-images)\n- [Declare default environment variables in file 通过文件声明默认环境变量](https://docs.docker.com/compose/env-file/)\n- [COMPOSE_PROJECT_NAME](https://docs.docker.com/compose/reference/envvars/#compose_project_name)\n- [如何从容器内部执行宿主机的docker命令](https://www.jianshu.com/p/8b72eece7df8)",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/perfectstorm88/dchelp",
    "keywords": "pip,docker-compose,cli,docker,helper",
    "license": "MIT Licence",
    "maintainer": "",
    "maintainer_email": "",
    "name": "dc-help",
    "package_url": "https://pypi.org/project/dc-help/",
    "platform": "any",
    "project_url": "https://pypi.org/project/dc-help/",
    "project_urls": {
      "Homepage": "https://github.com/perfectstorm88/dchelp"
    },
    "release_url": "https://pypi.org/project/dc-help/0.1.1/",
    "requires_dist": null,
    "requires_python": ">=2.7",
    "summary": "docker-compose helper",
    "version": "0.1.1",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 12119611,
  "releases": {
    "0.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "adcbcdcf8969e329845a3c7308a83a40d542b81e0a67060d0fecc7c54faf40ba",
          "md5": "cd95205e03ec3f7d3fbdf71fabdfeb05",
          "sha256": "4cb1d36d63424414d6345c76129c2a1908c3c627a06611d2ccb1441ae793ea91"
        },
        "downloads": -1,
        "filename": "dc_help-0.0.1-py2.7.egg",
        "has_sig": false,
        "md5_digest": "cd95205e03ec3f7d3fbdf71fabdfeb05",
        "packagetype": "bdist_egg",
        "python_version": "0.0.1",
        "requires_python": ">=2.7",
        "size": 15384,
        "upload_time": "2021-06-17T23:48:28",
        "upload_time_iso_8601": "2021-06-17T23:48:28.075036Z",
        "url": "https://files.pythonhosted.org/packages/ad/cb/cdcf8969e329845a3c7308a83a40d542b81e0a67060d0fecc7c54faf40ba/dc_help-0.0.1-py2.7.egg",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "dbc4845513a582528b30ea860d62b2f0a1e88987fc77a061db2192be07ea4d85",
          "md5": "e644acf4eb48e5a49824b7648ff4e1ee",
          "sha256": "9f8757ef2318291f78b4056eee9481ce083711d78556b5fc167d8febfa44807e"
        },
        "downloads": -1,
        "filename": "dc_help-0.0.1-py2-none-any.whl",
        "has_sig": false,
        "md5_digest": "e644acf4eb48e5a49824b7648ff4e1ee",
        "packagetype": "bdist_wheel",
        "python_version": "py2",
        "requires_python": ">=2.7",
        "size": 11782,
        "upload_time": "2021-06-17T23:48:22",
        "upload_time_iso_8601": "2021-06-17T23:48:22.691262Z",
        "url": "https://files.pythonhosted.org/packages/db/c4/845513a582528b30ea860d62b2f0a1e88987fc77a061db2192be07ea4d85/dc_help-0.0.1-py2-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "5c5c346fec6df3335b0504d280f7beb95892937034ffceddd4648874f8c92524",
          "md5": "8dcbe87a52586f654775518afeb51afe",
          "sha256": "df0824f755c67ca10cb5e620e12ed966d4276e3b91d6e82ed17b488096cc2144"
        },
        "downloads": -1,
        "filename": "dc_help-0.0.1-py3.7.egg",
        "has_sig": false,
        "md5_digest": "8dcbe87a52586f654775518afeb51afe",
        "packagetype": "bdist_egg",
        "python_version": "0.0.1",
        "requires_python": ">=2.7",
        "size": 17921,
        "upload_time": "2021-06-17T23:48:29",
        "upload_time_iso_8601": "2021-06-17T23:48:29.844835Z",
        "url": "https://files.pythonhosted.org/packages/5c/5c/346fec6df3335b0504d280f7beb95892937034ffceddd4648874f8c92524/dc_help-0.0.1-py3.7.egg",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "84488fe63c2d7eb2b54367734d0c03004b5dd06ad389e524c342bd2c0bb04fb1",
          "md5": "352a7bcfad2622da3cfde1bd7993c6eb",
          "sha256": "f1e1016a555fb5436f4a7b3f5f59af5e66c182e7be120ffb746e19f62667981e"
        },
        "downloads": -1,
        "filename": "dc_help-0.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "352a7bcfad2622da3cfde1bd7993c6eb",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=2.7",
        "size": 11783,
        "upload_time": "2021-06-17T23:48:24",
        "upload_time_iso_8601": "2021-06-17T23:48:24.580348Z",
        "url": "https://files.pythonhosted.org/packages/84/48/8fe63c2d7eb2b54367734d0c03004b5dd06ad389e524c342bd2c0bb04fb1/dc_help-0.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "20fa4e17b3b4ae4f30aef469b61b3ea122bd88f12691f700c433731fbf04b05f",
          "md5": "44e439908a94150f84b3d921aae6f758",
          "sha256": "e076a67e0f4e0a66b147d46adfc9e68a4a6fd0b96d35bb834b5fc27e873ee6ce"
        },
        "downloads": -1,
        "filename": "dc-help-0.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "44e439908a94150f84b3d921aae6f758",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=2.7",
        "size": 8691,
        "upload_time": "2021-06-17T23:48:26",
        "upload_time_iso_8601": "2021-06-17T23:48:26.771440Z",
        "url": "https://files.pythonhosted.org/packages/20/fa/4e17b3b4ae4f30aef469b61b3ea122bd88f12691f700c433731fbf04b05f/dc-help-0.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "7df489e59b795a1ec6fa59a04e088afcdad228faa3aae6ab7624cef45f4a06d4",
          "md5": "a908286e05e7de50b4ab1df38c07e369",
          "sha256": "9fdde1a3aa46c06a3218435c2dfcab682b569ae235514efac6f0fb07c059d8e1"
        },
        "downloads": -1,
        "filename": "dc_help-0.0.2-py2-none-any.whl",
        "has_sig": false,
        "md5_digest": "a908286e05e7de50b4ab1df38c07e369",
        "packagetype": "bdist_wheel",
        "python_version": "py2",
        "requires_python": ">=2.7",
        "size": 11786,
        "upload_time": "2021-06-29T02:20:39",
        "upload_time_iso_8601": "2021-06-29T02:20:39.785101Z",
        "url": "https://files.pythonhosted.org/packages/7d/f4/89e59b795a1ec6fa59a04e088afcdad228faa3aae6ab7624cef45f4a06d4/dc_help-0.0.2-py2-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "71fd709a74983fa3aac4ddd8d4e415fa684413431f57751fd18304c9de0bc3cd",
          "md5": "dad0e0c8cbe0f79babb29d7f8f4dd5e9",
          "sha256": "3ba2c6944cdea9e2f769372db25d236c319159c2e3d758814069610ed5e3b21b"
        },
        "downloads": -1,
        "filename": "dc_help-0.0.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "dad0e0c8cbe0f79babb29d7f8f4dd5e9",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=2.7",
        "size": 11785,
        "upload_time": "2021-06-29T02:20:41",
        "upload_time_iso_8601": "2021-06-29T02:20:41.403282Z",
        "url": "https://files.pythonhosted.org/packages/71/fd/709a74983fa3aac4ddd8d4e415fa684413431f57751fd18304c9de0bc3cd/dc_help-0.0.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "cf22c028ccf4d66acef9fed17d300f675a0631ec5933558c6fbaca0174d487fc",
          "md5": "455942202556cf8459b3900f4c4a9559",
          "sha256": "00cb9d44745a7ff44c8a1b8c66704dc697a96e65e0d00c12196ab6b9f9ca57b7"
        },
        "downloads": -1,
        "filename": "dc-help-0.0.2.tar.gz",
        "has_sig": false,
        "md5_digest": "455942202556cf8459b3900f4c4a9559",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=2.7",
        "size": 9093,
        "upload_time": "2021-06-23T01:52:30",
        "upload_time_iso_8601": "2021-06-23T01:52:30.694384Z",
        "url": "https://files.pythonhosted.org/packages/cf/22/c028ccf4d66acef9fed17d300f675a0631ec5933558c6fbaca0174d487fc/dc-help-0.0.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "ee3b5c15675645c4c1c3bd43f1e48f63f66b1fb04cf14d3ac8c18a58c9096615",
          "md5": "05f25c98645ea4e8fc8738f7dc912811",
          "sha256": "5e7500a56b8a3f5e68fa4f07748ea12a2d89987333489c42b57d5efc8b5d97bf"
        },
        "downloads": -1,
        "filename": "dc-help-0.0.3.tar.gz",
        "has_sig": false,
        "md5_digest": "05f25c98645ea4e8fc8738f7dc912811",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=2.7",
        "size": 10868,
        "upload_time": "2021-06-30T10:21:50",
        "upload_time_iso_8601": "2021-06-30T10:21:50.128014Z",
        "url": "https://files.pythonhosted.org/packages/ee/3b/5c15675645c4c1c3bd43f1e48f63f66b1fb04cf14d3ac8c18a58c9096615/dc-help-0.0.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "454acc8391b3520bb8046a296ef9f24c5afb6858c8d20969e2d77570836c2f69",
          "md5": "4d7a1b142c6ce883c4c93f773e53008b",
          "sha256": "7c5651050dd0cd3dd82cc263434f313d2e7aed6fcfe967dde09210bd7fb7ca64"
        },
        "downloads": -1,
        "filename": "dc-help-0.1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "4d7a1b142c6ce883c4c93f773e53008b",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=2.7",
        "size": 10771,
        "upload_time": "2021-10-29T01:46:55",
        "upload_time_iso_8601": "2021-10-29T01:46:55.296248Z",
        "url": "https://files.pythonhosted.org/packages/45/4a/cc8391b3520bb8046a296ef9f24c5afb6858c8d20969e2d77570836c2f69/dc-help-0.1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "e86cb6fb1947bdc5e3d954284e37f642f436315eab59e2ddcc06b5cd13b96d11",
          "md5": "baa9b5eb88779cca8ce3b442102e8414",
          "sha256": "18ad4fb6c847d8570867d9477b28e7bf53d7a99c892f4944855b427d8d2c0cdf"
        },
        "downloads": -1,
        "filename": "dc-help-0.1.1.tar.gz",
        "has_sig": false,
        "md5_digest": "baa9b5eb88779cca8ce3b442102e8414",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=2.7",
        "size": 11750,
        "upload_time": "2021-11-25T05:33:05",
        "upload_time_iso_8601": "2021-11-25T05:33:05.162612Z",
        "url": "https://files.pythonhosted.org/packages/e8/6c/b6fb1947bdc5e3d954284e37f642f436315eab59e2ddcc06b5cd13b96d11/dc-help-0.1.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "e86cb6fb1947bdc5e3d954284e37f642f436315eab59e2ddcc06b5cd13b96d11",
        "md5": "baa9b5eb88779cca8ce3b442102e8414",
        "sha256": "18ad4fb6c847d8570867d9477b28e7bf53d7a99c892f4944855b427d8d2c0cdf"
      },
      "downloads": -1,
      "filename": "dc-help-0.1.1.tar.gz",
      "has_sig": false,
      "md5_digest": "baa9b5eb88779cca8ce3b442102e8414",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=2.7",
      "size": 11750,
      "upload_time": "2021-11-25T05:33:05",
      "upload_time_iso_8601": "2021-11-25T05:33:05.162612Z",
      "url": "https://files.pythonhosted.org/packages/e8/6c/b6fb1947bdc5e3d954284e37f642f436315eab59e2ddcc06b5cd13b96d11/dc-help-0.1.1.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}