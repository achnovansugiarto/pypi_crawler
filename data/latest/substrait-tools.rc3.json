{
  "info": {
    "author": "richtia",
    "author_email": "",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "Substrait Tools\n====================================\n\nTable of Contents\n=================\n* [Overview](#Overview)\n* [Setup](#Setup)\n* [Command Line Tools](#Command-Line-Tools)\n  * [Create TPC-H Data](#Create-TPC-H-Data)\n  * [Generate Substrait Plans](#Generate-Substrait-Plans)\n  * [Consume Substrait Plans](#Consume-Substrait-Plans)\n\n# Overview\nThis repository provides tools for substrait\n\n\n# Setup\nCreate and activate your conda environment with python3.9:\n```commandline\nconda create -y -n substrait_tools -c conda-forge python=3.9 openjdk\nconda activate substrait_tools\n\npip install substrait-tools\n```\n\n# Command Line Tools\n\n## Create TPC-H Data\n\n```commandline\nprepare_tpch_data                                                                                 \nParquet data written to /Users/richardtia/substrait-tools/tpch_data\n```\n\n## Generate Substrait Plans\n\nExample usage with SQL:\n```commandline\nproduce_substrait --producer IsthmusProducer --schema ./schema.sql --query \"select * from lineitem\" --validate --validator_overrides 1002\nValidating plan: True\nValidator override levels: [1002]\nsubstrait plan written to: Isthmus_substrait.json\n```\n\nExample usage with Ibis:\n```commandline\nproduce_substrait --producer IbisProducer --schema ./tables.py --query_type ibis --ibis_expr expr=./expr.py --validate --validator_overrides 1002 2001 1\nValidating plan: True\nValidator override levels: [1002, 2001, 1]\nsubstrait plan written to: Ibis_substrait.json\n```\n\nArguments:<br>\n--producer: Which substrait producer to generate the plan with.<br>\n--schema: SQL Schema.  Each create table command should be on its own line.<br>\n--query: SQL query.<br>\n--ibis_expr: Ibis expression.  Argument should passed as a key value pair with the ibis expression function name and the python file with the function definition (`--ibis_expr test_expr=./expression.py`)<br>\n--validate: Default is false.  If set, the plan will run against the substrait validator.<br>\n--validator_overrides: Bypass error codes found by the substrait validator.  One or more integers separates by spaces.<br>\n\nSample schemas:\n\nSQL: schema.sql\n```text\nCREATE TABLE lineitem(l_orderkey INTEGER NOT NULL, l_partkey INTEGER NOT NULL, l_suppkey INTEGER NOT NULL, l_linenumber INTEGER NOT NULL, l_quantity INTEGER NOT NULL, l_extendedprice DECIMAL(15,2) NOT NULL, l_discount DECIMAL(15,2) NOT NULL, l_tax DECIMAL(15,2) NOT NULL, l_returnflag VARCHAR NOT NULL, l_linestatus VARCHAR NOT NULL, l_shipdate DATE NOT NULL, l_commitdate DATE NOT NULL, l_receiptdate DATE NOT NULL, l_shipinstruct VARCHAR NOT NULL, l_shipmode VARCHAR NOT NULL, l_comment VARCHAR NOT NULL);\n```\n**Note: Each `CREATE TABLE` command should be on its own line.\n\nIbis: ibis_schema.py\n```python\nlineitem = ibis.table(\n        [\n            (\"l_orderkey\", dt.int64),\n            (\"l_partkey\", dt.int64),\n            (\"l_suppkey\", dt.int64),\n            (\"l_linenumber\", dt.int64),\n            (\"l_quantity\", dt.Decimal(15, 2)),\n            (\"l_extendedprice\", dt.Decimal(15, 2)),\n            (\"l_discount\", dt.Decimal(15, 2)),\n            (\"l_tax\", dt.Decimal(15, 2)),\n            (\"l_returnflag\", dt.string),\n            (\"l_linestatus\", dt.string),\n            (\"l_shipdate\", dt.date),\n            (\"l_commitdate\", dt.date),\n            (\"l_receiptdate\", dt.date),\n            (\"l_shipinstruct\", dt.string),\n            (\"l_shipmode\", dt.string),\n            (\"l_comment\", dt.string),\n        ],\n        name=\"lineitem\",\n    )\n```\n`--schema ./ibis_schema.py`\n\nSample ibis expression file:<br>\nexpression.py\n```python\ndef expr(lineitem):\n    new_col = lineitem.l_tax.acos().name(\"ACOS_TAX\")\n    return lineitem[new_col]\n```\n`--query_type ibis --ibis_expr expr=./expression.py`<br>\n**Note: The key name (`expr`) should be the same as the function.\n\n## Consume Substrait Plans\n\nExample usage\n```commandline\nconsume_substrait --consumer DuckDBConsumer --substrait_plan ./Isthmus_substrait.json --table_file_pair lineitem=./lineitem.parquet region=./region.parquet\n```\nArguments:<br>\n--consumer: Which substrait consumer to consume the plan with.<br>\n--substrait_plan: Json formatted substrait plan.<br>\n--table_file_pair: One or more table name and file pairings. Table name and file should be separated by an equal (=) sign.<br>\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "substrait-tools",
    "package_url": "https://pypi.org/project/substrait-tools/",
    "platform": null,
    "project_url": "https://pypi.org/project/substrait-tools/",
    "project_urls": {
      "Repository": "https://github.com/richtia/substrait-tools"
    },
    "release_url": "https://pypi.org/project/substrait-tools/0.0.3/",
    "requires_dist": [
      "duckdb (>=0.6.2.dev1766)",
      "filelock",
      "ibis-framework",
      "ibis-substrait",
      "JPype1",
      "protobuf",
      "pyarrow",
      "substrait-validator"
    ],
    "requires_python": ">=3.9, <4",
    "summary": "A Substrait command line tool",
    "version": "0.0.3",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 16982306,
  "releases": {
    "0.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "2a448712150b476d47e016694a997451a1e30d891c9f15b9f8cb5702a5fc27e5",
          "md5": "c8065c3208e40ef6a1f2c48b9ae72f99",
          "sha256": "b1d23d24704cbeb05295bbd1608d2b7b004ae03e89679127de62437e9d185242"
        },
        "downloads": -1,
        "filename": "substrait_tools-0.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "c8065c3208e40ef6a1f2c48b9ae72f99",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9, <4",
        "size": 43771210,
        "upload_time": "2023-02-16T19:58:06",
        "upload_time_iso_8601": "2023-02-16T19:58:06.442952Z",
        "url": "https://files.pythonhosted.org/packages/2a/44/8712150b476d47e016694a997451a1e30d891c9f15b9f8cb5702a5fc27e5/substrait_tools-0.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "31510bce071fb2a02e1c9c0eef1924ef666b8bff392d546b1527d67da751e7c6",
          "md5": "c02a9eec1241756574080bf9e525acb0",
          "sha256": "7432161389d019fe975ef8780040008d1603bb4be9ac2378d2a201128ba91f1c"
        },
        "downloads": -1,
        "filename": "substrait_tools-0.0.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "c02a9eec1241756574080bf9e525acb0",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9, <4",
        "size": 43772601,
        "upload_time": "2023-02-16T22:34:47",
        "upload_time_iso_8601": "2023-02-16T22:34:47.006797Z",
        "url": "https://files.pythonhosted.org/packages/31/51/0bce071fb2a02e1c9c0eef1924ef666b8bff392d546b1527d67da751e7c6/substrait_tools-0.0.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "f9b3f26e605ec2298ec6dd057c035cb3cf4b406f64ea1f38d945b4ca600208de",
          "md5": "b1b95c405aa89ed6e095c29c56e601a5",
          "sha256": "180295d18188d3fc8a5d9f63c311bb91ec956f915dd2c353ee7d9e2fd54c299f"
        },
        "downloads": -1,
        "filename": "substrait_tools-0.0.3-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "b1b95c405aa89ed6e095c29c56e601a5",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9, <4",
        "size": 43772631,
        "upload_time": "2023-02-22T20:17:43",
        "upload_time_iso_8601": "2023-02-22T20:17:43.300315Z",
        "url": "https://files.pythonhosted.org/packages/f9/b3/f26e605ec2298ec6dd057c035cb3cf4b406f64ea1f38d945b4ca600208de/substrait_tools-0.0.3-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "f9b3f26e605ec2298ec6dd057c035cb3cf4b406f64ea1f38d945b4ca600208de",
        "md5": "b1b95c405aa89ed6e095c29c56e601a5",
        "sha256": "180295d18188d3fc8a5d9f63c311bb91ec956f915dd2c353ee7d9e2fd54c299f"
      },
      "downloads": -1,
      "filename": "substrait_tools-0.0.3-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "b1b95c405aa89ed6e095c29c56e601a5",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.9, <4",
      "size": 43772631,
      "upload_time": "2023-02-22T20:17:43",
      "upload_time_iso_8601": "2023-02-22T20:17:43.300315Z",
      "url": "https://files.pythonhosted.org/packages/f9/b3/f26e605ec2298ec6dd057c035cb3cf4b406f64ea1f38d945b4ca600208de/substrait_tools-0.0.3-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}