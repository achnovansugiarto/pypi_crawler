{
  "info": {
    "author": "Davor Runje",
    "author_email": "davor@airt.ai",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 5 - Production/Stable",
      "Intended Audience :: Developers",
      "License :: Free for non-commercial use",
      "Natural Language :: English",
      "Programming Language :: Python :: 3.10",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Programming Language :: Python :: 3.9"
    ],
    "description": "Constrained Monotonic Neural Networks\n================\n\n<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->\n\nThis Python library implements Monotonic Dense Layer as described in\nDavor Runje, Sharath M. Shankaranarayana, “Constrained Monotonic Neural\nNetworks”, https://https://arxiv.org/abs/2205.11775.\n\nIf you use this library, please cite:\n\n        @misc{https://doi.org/10.48550/arxiv.2205.11775,\n          doi = {10.48550/ARXIV.2205.11775},\n          url = {https://arxiv.org/abs/2205.11775},\n          author = {Runje, Davor and Shankaranarayana, Sharath M.},\n          title = {Constrained Monotonic Neural Networks},\n          publisher = {arXiv},\n          year = {2022},\n          copyright = {Creative Commons Attribution Non Commercial Share Alike 4.0 International}\n        }\n\n## Install\n\n``` sh\npip install mono_dense_keras\n```\n\n## License\n\nThe full text of the license is available at:\n\nhttps://github.com/airtai/mono-dense-keras/blob/main/LICENSE\n\nYou are free to: - Share — copy and redistribute the material in any\nmedium or format\n\n- Adapt — remix, transform, and build upon the material\n\nThe licensor cannot revoke these freedoms as long as you follow the\nlicense terms.\n\nUnder the following terms: - Attribution — You must give appropriate\ncredit, provide a link to the license, and indicate if changes were\nmade. You may do so in any reasonable manner, but not in any way that\nsuggests the licensor endorses you or your use.\n\n- NonCommercial — You may not use the material for commercial purposes.\n\n- ShareAlike — If you remix, transform, or build upon the material, you\n  must distribute your contributions under the same license as the\n  original.\n\n- No additional restrictions — You may not apply legal terms or\n  technological measures that legally restrict others from doing\n  anything the license permits.\n\n## How to use\n\nFirst, we’ll create a simple dataset for testing using numpy. Inputs\nvalues $x_1$, $x_2$ and $x_3$ will be sampled from the normal\ndistribution, while the output value $y$ will be calculated according to\nthe following formula before adding noise to it:\n\n$y = x_1^3 + \\sin\\left(\\frac{x_2}{2 \\pi}\\right) + e^{-x_3}$\n\n``` python\nimport numpy as np\n\nrng = np.random.default_rng(42)\n\ndef generate_data(no_samples: int, noise: float):\n    x = rng.normal(size=(no_samples, 3))\n    y = x[:, 0] ** 3\n    y += np.sin(x[:, 1] / (2*np.pi))\n    y += np.exp(-x[:, 2])\n    y += noise * rng.normal(size=no_samples)\n    return x, y\n\nx_train, y_train = generate_data(10_000, noise=0.1)\nx_val, y_val = generate_data(10_000, noise=0.)\n```\n\nFirst, we’ll build a simple feedforward neural network using `Dense`\nlayer from Keras library.\n\n``` python\nimport tensorflow as tf\n\nfrom tensorflow.keras import Sequential\nfrom tensorflow.keras.layers import Dense, Input\nfrom tensorflow.keras.optimizers import Adam\nfrom tensorflow.keras.optimizers.schedules import ExponentialDecay\n\n# build a simple model with 3 hidden layer\nmodel = Sequential()\n\nmodel.add(Input(shape=(3,)))\nmodel.add(Dense(128, activation=\"elu\"))\nmodel.add(Dense(128, activation=\"elu\"))\nmodel.add(Dense(1))\n```\n\nWe’ll train the network using the `Adam` optimizer and the\n`ExponentialDecay` learning rate schedule:\n\n``` python\ndef train_model(model, initial_learning_rate):\n    # train the model\n    lr_schedule = ExponentialDecay(\n        initial_learning_rate=initial_learning_rate,\n        decay_steps=10_000,\n        decay_rate=0.9,\n    )\n    optimizer = Adam(learning_rate=lr_schedule)\n    model.compile(optimizer=\"adam\", loss=\"mse\")\n\n    model.fit(x=x_train, y=y_train, batch_size=32, validation_data=(x_val, y_val), epochs=10)\n    \ntrain_model(model, initial_learning_rate=.1)\n```\n\n    Epoch 1/10\n    313/313 [==============================] - 1s 2ms/step - loss: 9.1098 - val_loss: 9.2552\n    Epoch 2/10\n    313/313 [==============================] - 1s 2ms/step - loss: 7.7995 - val_loss: 8.3143\n    Epoch 3/10\n    313/313 [==============================] - 1s 2ms/step - loss: 7.5270 - val_loss: 8.0499\n    Epoch 4/10\n    313/313 [==============================] - 1s 2ms/step - loss: 7.2095 - val_loss: 7.5935\n    Epoch 5/10\n    313/313 [==============================] - 1s 2ms/step - loss: 6.0665 - val_loss: 6.7911\n    Epoch 6/10\n    313/313 [==============================] - 1s 2ms/step - loss: 3.1178 - val_loss: 1.5964\n    Epoch 7/10\n    313/313 [==============================] - 1s 2ms/step - loss: 1.1686 - val_loss: 0.8541\n    Epoch 8/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.7370 - val_loss: 1.5969\n    Epoch 9/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.6011 - val_loss: 0.3739\n    Epoch 10/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.4458 - val_loss: 0.3114\n\nNow, we’ll use the\n[`MonotonicDense`](https://airtai.github.io/mono-dense-keras/layers.html#monotonicdense)\nlayer instead of `Dense` layer. By default, the\n[`MonotonicDense`](https://airtai.github.io/mono-dense-keras/layers.html#monotonicdense)\nlayer assumes the output of the layer is monotonically increasing with\nall inputs. This assumtion is always true for all layers except possibly\nthe first one. For the first layer, we use `indicator_vector` to specify\nwhich input parameters are monotonic and to specify are they\nincreasingly or decreasingly monotonic: - set 1 for increasingly\nmonotonic parameter,\n\n- set -1 for decreasingly monotonic parameter, and\n\n- set 0 otherwise.\n\nIn our case, the `indicator_vector` is `[1, 0, -1]` because $y$ is: -\nmonotonically increasing w.r.t. $x_1$\n$\\left(\\frac{\\partial y}{x_1} = 3 {x_1}^2 \\geq 0\\right)$, and\n\n- monotonically decreasing w.r.t. $x_3$\n  $\\left(\\frac{\\partial y}{x_3} = - e^{-x_2} \\leq 0\\right)$.\n\n``` python\nfrom airt.keras.layers import MonotonicDense\n\n\n# build a simple model with 3 hidden layer, but this using MonotonicDense layer\nmono_model = Sequential()\n\nmono_model.add(Input(shape=(3,)))\nindicator_vector = [1, 0, -1]\nmono_model.add(MonotonicDense(128, activation=\"elu\", indicator_vector=indicator_vector))\nmono_model.add(MonotonicDense(128, activation=\"elu\"))\n\nmono_model.add(Dense(1))\n```\n\n``` python\ntrain_model(model, initial_learning_rate=.001)\n```\n\n    Epoch 1/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.3646 - val_loss: 0.2042\n    Epoch 2/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.2895 - val_loss: 0.1387\n    Epoch 3/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.2756 - val_loss: 0.1027\n    Epoch 4/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.2281 - val_loss: 0.0814\n    Epoch 5/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.1816 - val_loss: 0.0634\n    Epoch 6/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.1631 - val_loss: 0.1443\n    Epoch 7/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.1455 - val_loss: 0.1299\n    Epoch 8/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.1701 - val_loss: 0.0709\n    Epoch 9/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.1250 - val_loss: 0.0644\n    Epoch 10/10\n    313/313 [==============================] - 1s 2ms/step - loss: 0.1426 - val_loss: 0.0405\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/airtai/mono-dense-keras",
    "keywords": "monotonic neural networks,keras",
    "license": "Creative Commons License",
    "maintainer": "",
    "maintainer_email": "",
    "name": "mono-dense-keras",
    "package_url": "https://pypi.org/project/mono-dense-keras/",
    "platform": null,
    "project_url": "https://pypi.org/project/mono-dense-keras/",
    "project_urls": {
      "Homepage": "https://github.com/airtai/mono-dense-keras"
    },
    "release_url": "https://pypi.org/project/mono-dense-keras/0.0.3/",
    "requires_dist": [
      "fastcore",
      "tensorflow"
    ],
    "requires_python": ">=3.7",
    "summary": "Monotonic Dense Layer implemented in Keras",
    "version": "0.0.3",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 14983381,
  "releases": {
    "0.0.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "cf487f636166f204c7031e5eade56c0906a6d977a7d7f5cb8822dc72b41fb952",
          "md5": "797238f7924c82c280597fc4753dc904",
          "sha256": "3b16ec9352eddae51185388b07b00657c6a3b1cb3ed3db1c85a718f57096550a"
        },
        "downloads": -1,
        "filename": "mono_dense_keras-0.0.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "797238f7924c82c280597fc4753dc904",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 12892,
        "upload_time": "2022-09-03T16:59:11",
        "upload_time_iso_8601": "2022-09-03T16:59:11.725587Z",
        "url": "https://files.pythonhosted.org/packages/cf/48/7f636166f204c7031e5eade56c0906a6d977a7d7f5cb8822dc72b41fb952/mono_dense_keras-0.0.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "53afe79b874eeb3952b024b3c3b1547241478fef8eb2529d32df4596bfae1c84",
          "md5": "393344bc29e1e9187228cc7cfe9b72b8",
          "sha256": "455a01e216ae75ce1b9e90746cd7f4cc569f8205d36a4ebe5aaf36aaa101ae02"
        },
        "downloads": -1,
        "filename": "mono-dense-keras-0.0.1.tar.gz",
        "has_sig": false,
        "md5_digest": "393344bc29e1e9187228cc7cfe9b72b8",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 13526,
        "upload_time": "2022-09-03T16:59:15",
        "upload_time_iso_8601": "2022-09-03T16:59:15.013055Z",
        "url": "https://files.pythonhosted.org/packages/53/af/e79b874eeb3952b024b3c3b1547241478fef8eb2529d32df4596bfae1c84/mono-dense-keras-0.0.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "3d89aef4d83bc2bf880cd0857512cf925f568717e4bca597fe6b302acbfacace",
          "md5": "efd4ea9cf32a144ca8aaa5355b700e79",
          "sha256": "afdc112f98e3cb34f3f6e228085ef968441ab438f9a29e2e8670c36f8f3fed73"
        },
        "downloads": -1,
        "filename": "mono_dense_keras-0.0.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "efd4ea9cf32a144ca8aaa5355b700e79",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 12897,
        "upload_time": "2022-09-03T17:03:34",
        "upload_time_iso_8601": "2022-09-03T17:03:34.340148Z",
        "url": "https://files.pythonhosted.org/packages/3d/89/aef4d83bc2bf880cd0857512cf925f568717e4bca597fe6b302acbfacace/mono_dense_keras-0.0.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "2e4a3c2e6942b61348d52d9caf348d5fac338ce8a833a063462a994e7eb00148",
          "md5": "b068d6db88638f2bd609411ecbfd14fd",
          "sha256": "67a4def947a2e14229a8a6afc68baec35bb609b62620839c9e1aa84fd5154fad"
        },
        "downloads": -1,
        "filename": "mono-dense-keras-0.0.2.tar.gz",
        "has_sig": false,
        "md5_digest": "b068d6db88638f2bd609411ecbfd14fd",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 13544,
        "upload_time": "2022-09-03T17:03:36",
        "upload_time_iso_8601": "2022-09-03T17:03:36.805183Z",
        "url": "https://files.pythonhosted.org/packages/2e/4a/3c2e6942b61348d52d9caf348d5fac338ce8a833a063462a994e7eb00148/mono-dense-keras-0.0.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "830542fcc26b1dd87a64a1c8012a05ff5c2364f81229a98e27347744d0ab1c05",
          "md5": "9d579d69c6fee1b5383115f879ae56c2",
          "sha256": "13bc8d212db84be9778bfeeb8fe69ed8663afba5558ff768798a0063d8a20314"
        },
        "downloads": -1,
        "filename": "mono_dense_keras-0.0.3-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "9d579d69c6fee1b5383115f879ae56c2",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7",
        "size": 12897,
        "upload_time": "2022-09-03T17:12:35",
        "upload_time_iso_8601": "2022-09-03T17:12:35.565989Z",
        "url": "https://files.pythonhosted.org/packages/83/05/42fcc26b1dd87a64a1c8012a05ff5c2364f81229a98e27347744d0ab1c05/mono_dense_keras-0.0.3-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "cebba0e9766c445d4d472e3c364ad04deb507813c2bf24ac98e603d375619456",
          "md5": "df9883185ff7c889ff2a0360bbfc7e15",
          "sha256": "c040820d1460461d88bc08124063f9fe5c4c40e32a93a4a4c7859b778b5165a6"
        },
        "downloads": -1,
        "filename": "mono-dense-keras-0.0.3.tar.gz",
        "has_sig": false,
        "md5_digest": "df9883185ff7c889ff2a0360bbfc7e15",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 13466,
        "upload_time": "2022-09-03T17:12:37",
        "upload_time_iso_8601": "2022-09-03T17:12:37.280406Z",
        "url": "https://files.pythonhosted.org/packages/ce/bb/a0e9766c445d4d472e3c364ad04deb507813c2bf24ac98e603d375619456/mono-dense-keras-0.0.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "830542fcc26b1dd87a64a1c8012a05ff5c2364f81229a98e27347744d0ab1c05",
        "md5": "9d579d69c6fee1b5383115f879ae56c2",
        "sha256": "13bc8d212db84be9778bfeeb8fe69ed8663afba5558ff768798a0063d8a20314"
      },
      "downloads": -1,
      "filename": "mono_dense_keras-0.0.3-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "9d579d69c6fee1b5383115f879ae56c2",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7",
      "size": 12897,
      "upload_time": "2022-09-03T17:12:35",
      "upload_time_iso_8601": "2022-09-03T17:12:35.565989Z",
      "url": "https://files.pythonhosted.org/packages/83/05/42fcc26b1dd87a64a1c8012a05ff5c2364f81229a98e27347744d0ab1c05/mono_dense_keras-0.0.3-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "cebba0e9766c445d4d472e3c364ad04deb507813c2bf24ac98e603d375619456",
        "md5": "df9883185ff7c889ff2a0360bbfc7e15",
        "sha256": "c040820d1460461d88bc08124063f9fe5c4c40e32a93a4a4c7859b778b5165a6"
      },
      "downloads": -1,
      "filename": "mono-dense-keras-0.0.3.tar.gz",
      "has_sig": false,
      "md5_digest": "df9883185ff7c889ff2a0360bbfc7e15",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7",
      "size": 13466,
      "upload_time": "2022-09-03T17:12:37",
      "upload_time_iso_8601": "2022-09-03T17:12:37.280406Z",
      "url": "https://files.pythonhosted.org/packages/ce/bb/a0e9766c445d4d472e3c364ad04deb507813c2bf24ac98e603d375619456/mono-dense-keras-0.0.3.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}