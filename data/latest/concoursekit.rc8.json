{
  "info": {
    "author": "Anthony Hawkins",
    "author_email": "ahawkins.mail@gmail.com",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: MIT License",
      "Programming Language :: Python",
      "Programming Language :: Python :: 3",
      "Programming Language :: Python :: 3 :: Only",
      "Programming Language :: Python :: 3.9",
      "Topic :: Software Development :: Code Generators"
    ],
    "description": "![alt text](assets/cck-logo.jpg \"Concourse Kit\")\n# Concourse Kit - For Extreme Pipelining\nConcourse Kit is a highly opinionated approach to developing, generating, testing, validating, and setting, multiple, domain-specific, concourse pipelines within a single mono-repo.\n\nIt's primarily aimed at platform or infrastructure teams who maintain, build, and automate against specific platforms such as Cloud Foundry, Kubernetes or manage multiple, large, and complex platforms or workflows.\n\nThese automation workloads typically share a lot of common data, tasks, and deploy multiple instances of the same pipeline which target specific environments. \n\n## Opinions\n* **Generated - Not Declared:** Pipelines used to automate entire platforms typically end up in the thousands-of-lines of YAML and can get incredibly repetitive. Templating YAML can become incredibly tricky.  Concourse Kit specifies that pipelines are literally, *as code* and are generated into the required pipeline YAML.\n* **Python Focused:** Pipelines are written as Python 3.9 code, and all tasks are encouraged to use Python as well the reasons being are:\n  * Python is more readable than Bash scripting.\n  * Python is more testable than Bash scripting.\n  * Python is powerful enough to generate any required pipeline configuration.\n  * Python is more approachable to a wider audience vs languages such as Go.\n* **Mono Repo:** Automation which operates on the same domain should be contained within the same repo.  This makes sharing resources, tasks, environment data, and commonly used scripts easily recyclable. \n\n## Conventions\nConcourse Kit Specifies the following Conventions to be followed.\n\n* Code which generates into a pipeline config should be within `pipelines`\n* Code which tests a pipeline config should be within `pipeline_tests`\n* Environment data specific to concourse environments should be within `concourse-environments`\n* Environment data specific to automation targets should be within `target-environments`\n* Setting a pipeline is done using the `cc_kit.py` script. \n\n## Requirements\nTo getup and running with Concourse Kit, you will need the following.\n* **Python 3.9:** You will need Python 3.9+ installed as this cck makes use of the union operator for dictionaries.\n* **fly CLI:** You will need the fly CLI installed as concourse kit invokes it to validate, and set pipelines for you.\n* **An Open Mind:** Yes, this is a very unconventional approach to developing and managing pipelines but it might just be crazy enough to work.\n\n## Installing\n```\npip install concoursekit\n```\nConcoursekit is installed using pip.  This will install the module and make the `cck` CLI utility available. \n\nOnce installed you can run the following to initialize a new working directory for concoursekit to manage.\n```\ncck --init\n```\nThis will place a `.cck.yml` file in the directory which provides some basic configuration defaults for cck.\n```yaml\n# The default concourse target to use\nconcourse_target: concourse\n\n# These options are allowed.\n# fly_default_options:\n# - non-interactive | interactive\n# - hide-pipeline | expose-pipeline\n# - unpause-pipeline | pause-pipeline\n\n# When Setting a Pipeline Fly will use these options\nfly_default_options:\n- interactive\n- hide-pipeline\n- unpause-pipeline\n\n# The directory to import <pipeline_name>.py files from. \npipelines_dir: pipelines\n\n# The directory to look for <pipeline_name>_test.py files from.\npipelines_test_dir: pipeline_tests\n\n# The directory to use for target-environments\ntarget_environments_dir: target_environments\n```\n\n\n## cck CLI\n**The `cck` utility is the entry point into concourse kit. It has three primary commands.**\n\n```\ncck --gen-pipeline\n```\nGenerates a pipeline.yml file from a pipeline.py file.\n\n\n```\ncck --set-pipeline\n```\nInvokes fly to set one or more pipelines.\n\n\n```\ncck --test-pipeline\n```\nRuns PyTest for one or more pipelines. Useful for  testing pipeline configuration results.\n\n**Each of the commands above can take the following arguments.**\n\n```\ncck --set-pipeline --name <pipeline_name> --env <env>\n```\nSet a specific pipeline for a specific environment.\n\n```\ncck --set-pipeline --name <pipeline_name> --all\n```\nSet a specific pipeline for all target environments it's scoped to. \n\n\n```\ncck --set-pipeline --all\n```\nSet all pipelines for all target environments each pipeline is scoped to.\n\n\n```\ncck --gen-pipeline --name <pipeline_name> --env <env>\n\n```\nGenerate a single `pipeline.yml` file for a specific pipeline for a specific environment.\n\n```\ncck --test-pipeline --name <pipeline_name>\n```\nRun a PyTest test for a specific pipeline.\n\n```\ncck --test-pipeline --all\n```\nRun all PyTest tests for all pipelines.\n\n**The Set Command can also take a `--plan` flag.**\n```\ncck --set-pipeline --name <pipeline_name> --all  --plan\n```\n```\ncck --set-pipeline --name --all  --plan\n```\nDisplay pipeline names, their source `.py` file, the environments they will target and validates their configurations.\n\n## Environments\nConcourse Kit organizes pipeline automation around the concept of target environments. Target environments contain all the variables and file content specific to one or more target environments.  From the perspective of automation, the automation jobs are always targeting infrastructure, APIs, or resources in a specific environment, hence the name `target-environments`.\n\nIn order for the `cck` CLI to function and generate or set a pipeline, you must declare at least one environment directory under the `target-environments` directory.  An example of how to organize targets may look like such:\n```\ntarget-environments\n├───common\n├───dev\n│   ├───eu-dev\n│   └───us-dev\n├───prod\n├───sandbox\n└───stage\n```\n\nThe `concourse-environments` directory should contain data and file content related to deploying concourse itself and it's environments. This helps isolate automation data from the target data. \n\n## Generating Pipeline Configurations\nAll pipeline YAML configurations are *generated*, not declared or templated.  To configure a new pipeline, a new `pipelines/<pipeline_name>.py` must be created.\n\n### Hello World\nThis is the documented Hello World example on the concourse site. \n```yaml\n---\njobs:\n- name: job\n  public: true\n  plan:\n  - task: simple-task\n    config:\n      platform: linux\n      image_resource:\n        type: registry-image\n        source: { repository: busybox }\n      run:\n        path: echo\n        args: [\"Hello world!\"]\n```\nTo configure this pipeline using cck, a new `pipelines/hello_world.py` file would need to be created and contain the following.  It **must** have a top-level function defined as `pipeline_config` which returns a `dict`.\n\n```python\ndef pipeline_config():\n  return  {\n    \"jobs\": [\n        {\n          \"name\": \"hello-world-job\",\n          \"plan\": [\n            {\n              \"task\": \"hello-world-task\",\n              \"config\": {\n                \"platform\": \"linux\",\n                \"image_resource\": {\n                  \"type\": \"registry-image\",\n                  \"source\": {\n                    \"repository\": \"busybox\"\n                  }\n                },\n                \"run\": {\n                  \"path\": \"echo\",\n                  \"args\": [\"hello world!\"]\n                }\n              }\n            }\n          ]\n        }\n    ]  # end jobs\n}\n```\nTo Generate the pipeline the following is run.  Even though the environment isn't used in this example, the generate command still requires it.\n```bash\n> cck --generate-pipeline --name hello_world --env dev\nGenerating Pipeline to hello_world.yml\n```\nThis will generate the same yaml as shown above.\n### Using Environments\nTypically, if you are automating infrastructure or complex platforms, you will have one pipeline which targets one or more environments. For example, if you deploy and manage a Kubernetes cluster, you would want to install it exactly the same for dev, stage, and prod with the only difference being environmental specific values for variables, endpoints, certs etc. \n\nIf we think about our `pipeline.py` as a function, and the `target-environment` data as the input parameters, we can generate an environment specific pipeline per each environment. \n\nGiven the following target environments.\n```\ntarget-environments\n  ├───dev\n  │   └───vars.yml\n  ├───prod\n  |   └───vars.yml\n  └───stage\n      └───vars.yml\n```\nand within each vars.yml file a environment specific endpoint.\n```yaml\n# target-environments/dev/vars.yml\napi-endpoint: dev.api.some.target.foocorp.int\n```\n```yaml\n# target-environments/stage/vars.yml\napi-endpoint: stage.api.some.target.foocorp.int\n```\n```yaml\n# target-environments/prod/vars.yml\napi-endpoint: prod.api.some.target.foocorp.int\n```\n\nWithin the `pipelines/example.py` file our config looks like the below.  Note that Concourse Kit makes use of YAMLmaker to aid with YAML generation. You can read more on how to use YAMLmaker [here](https://github.com/Anthonyhawkins/yamlmaker).\n\nThe value for the `target-environment` is always under the os environment variable: `ENVIRONMENT`.  When using the `ENVIRONMENT` variable, we can source in the variables specific for the environment we are generating a configuration for. \n\n```python\nfrom yamlmaker import Sources\nfrom yamlmaker import env\n\ndef pipeline_config():\n\n  sources = Sources({\n    \"vars\": \"target-environments/\" + env(\"ENVIRONMENT\") + \"/vars.yml\"\n  })\n\n  return {\n    \"jobs\": [\n        {\n          \"name\": \"hello-world-job\",\n          \"plan\": [\n            {\n              \"task\": \"hello-world-task\",\n              \"config\": {\n                \"platform\": \"linux\",\n                \"image_resource\": {\n                  \"type\": \"registry-image\",\n                  \"source\": {\n                    \"repository\": \"busybox\"\n                  }\n                },\n                \"params\": {\n                  \"API_ENDPOINT\": sources.grab(\"vars\", \"api-endpoint\")\n                },\n                \"run\": {\n                  \"path\": \"echo\",\n                  \"args\": [\"hello world!\"]\n                }\n              }\n            }\n          ]\n        }\n    ]  # end jobs\n}\n```\nGenerate the pipeline.yml\n```bash\n> cck --generate-pipeline --name hello_world --env dev\nGenerating Pipeline to hello_world.yml\n```\nOur generated config now looks like this, as you can see the dev specific variable is used.\n```yaml\njobs:\n- name: hello-world-job\n  plan:\n  - task: hello-world-task\n    config:\n      platform: linux\n      image_resource:\n        type: registry-image\n        source:\n          repository: busybox\n      params:\n        API_ENDPOINT: dev.api.some.target.foocorp.int\n      run:\n        path: echo\n        args:\n        - hello world!\n\n```\n\nThe `--generate` command can only generate a config for one environment at a time.  You cannot specify the `--all` flag when generating a pipeline config.\n\n## Setting a Single Pipeline\nYou can set a pipeline two ways, the first being the normal `fly` method and passing in a generated yaml file as the pipeline config.  The second method is to have `cck` invoke `fly` for you to set a pipeline for one or more environments.\n\n### Setup a fly Target\nTo have `cck` set a pipeline first set a `fly` target of `concourse` like so:\n```bash\nfly -t concourse login -c http://localhost:8080 -u example -p example\n```\nYou can target a different team if you'd like, for this example it will just use the `main` team.\n\n### Setting the Pipeline\nWhen a pipeline is set, it will be generated and immediately set.  The name of the pipeline is the same as the `pipeline.py` file with underscores replaced with dashes.  In addition, the `target-environment` is prefixed to the name.\n```\n> cck --set-pipeline --name hello_world --env dev\nGenerating Pipeline to dev-hello-world.yml\nSetting pipeline: dev-hello-world\njobs:\n  job hello-world-job has been added:\n+ name: hello-world-job\n+ plan:\n+ - config:\n+     image_resource:\n+       source:\n+         repository: busybox\n+       type: registry-image\n+     params:\n+       API_ENDPOINT: dev.api.some.target.foocorp.int\n+     platform: linux\n+     run:\n+       args:\n+       - hello world!\n+       path: echo\n+   task: hello-world-task\n\napply configuration? [yN]: \n```\n### Setting a Pipeline for Multiple Environments.\nSpecifying the `--all` flag when using the `--set-pipeline` command will attempt to set the pipeline for all environments, except for defined within the `.cck.yml` under `ignore_environments: []`.  By default, the `common` environment has been added for you. \n\nFor this to work, every `target-environment` must have all the same var yaml files, content files etc. otherwise the pipeline will work for some environments, not others.  \n\n```\n> cck --set-pipeline --name hello_world --all\nGenerating Pipeline to dev-hello-world.yml\nSetting pipeline: dev-hello-world\njobs:\n  job hello-world-job has been added:\n+ name: hello-world-job\n+ plan:\n+ - config:\n...\n+       - hello world!\n+       path: echo\n+   task: hello-world-task\n\napply configuration? [yN]: y\npipeline created!\nyou can view your pipeline here: http://localhost:8080/teams/main/pipelines/dev-hello-world\n\nthe pipeline is currently paused. to unpause, either:\n  - run the unpause-pipeline command:\n    fly -t concourse unpause-pipeline -p dev-hello-world\n  - click play next to the pipeline in the web ui\nGenerating Pipeline to prod-hello-world.yml\nSetting pipeline: prod-hello-world\njobs:\n  job hello-world-job has been added:\n+ name: hello-world-job\n+ plan:\n...\n+       - hello world!\n+       path: echo\n+   task: hello-world-task\n\napply configuration? [yN]: y\npipeline created!\nyou can view your pipeline here: http://localhost:8080/teams/main/pipelines/prod-hello-world\n\nthe pipeline is currently paused. to unpause, either:\n  - run the unpause-pipeline command:\n    fly -t concourse unpause-pipeline -p prod-hello-world\n  - click play next to the pipeline in the web ui\nGenerating Pipeline to stage-hello-world.yml\nSetting pipeline: stage-hello-world\njobs:\n  job hello-world-job has been added:\n+ name: hello-world-job\n+ plan:\n...\n+       - hello world!\n+       path: echo\n+   task: hello-world-task\n\napply configuration? [yN]: y\npipeline created!\n```\n\n### Setting for All Environments, Except One or More Environments\nSometimes you may wish to set all environments, except one or more of them.  To accomplish this, you can negate specific environments by appending the target-environment name with a bang `!`.  \n```\n> cck --set-pipeline --name hello_world --all  --env !sandbox\n```\nThis will set for all environments, except the sandbox environment.\n\n\n### Scoping a Pipeline to Specific Environments.\nIt's rare that you will have a pipeline which needs to target *every* environment, however, it is fairly common that pipelines will need to target multiple *specific* environments.\n\nTo declare which `target-environments` a pipeline should target, you can declare the top-level variable, `pipeline_environments`, within the `pipelines/pipeline.py` file like so.\n```python\nfrom yamlmaker import Sources\nfrom yamlmaker import env\n\npipeline_environments = [\n  \"dev\",\n  \"stage\"\n]\n\ndef pipeline_config():\n  sources = Sources({\n    \"vars\": \"target-environments/\" + env(\"ENVIRONMENT\") + \"/vars.yml\"\n  })\n\n  return {\n      \"jobs\": [\n          {\n            \"name\": \"hello-world-job\",\n            \"plan\": [\n              {\n                \"task\": \"hello-world-task\",\n                \"config\": {\n                  \"platform\": \"linux\",\n                  \"image_resource\": {\n                    \"type\": \"registry-image\",\n                    \"source\": {\n                      \"repository\": \"busybox\"\n                    }\n                  },\n                  \"params\": {\n                    \"API_ENDPOINT\": sources.grab(\"vars\", \"api-endpoint\")\n                  },\n                  \"run\": {\n                    \"path\": \"echo\",\n                    \"args\": [\"hello world!\"]\n                  }\n                }\n              }\n            ]\n          }\n      ]  # end jobs\n  }\n\n```\nWhen you run `cck` with the `--all` flag again, it will only set the pipeline for the environments declared within the `pipeline_environments` list.\n```\n> cck --set-pipeline --name hello_world --all\nGenerating Pipeline to dev-hello-world.yml\nSetting pipeline: dev-hello-world\nno changes to apply\nGenerating Pipeline to stage-hello-world.yml\nSetting pipeline: stage-hello-world\nno changes to apply\n``` \n\n### Pipeline Suffix\nSometimes it's handy to label or append a suffix to the end of a pipeline name to give it some context when working with many pipelines.  For example, you may have a few pipelines which deal with operating a platform or a few pipelines which deal with just install or update specific tasks.  \n\nYou can provide a suffix to be applied to the pipeline name by declaring the following top level variable: `pipeline_suffix`. \n\n```python\npipeline_suffix = \"operations\"\n\ndef pipeline_config():\n  return {\n      \"jobs\": [\n          {\n            \"name\": \"hello-world-job\",\n            \"plan\": [\n              {\n                \"task\": \"hello-world-task\",\n                \"config\": {\n                  \"platform\": \"linux\",\n                  \"image_resource\": {\n                    \"type\": \"registry-image\",\n                    \"source\": {\n                      \"repository\": \"busybox\"\n                    }\n                  },\n                  \"run\": {\n                    \"path\": \"echo\",\n                    \"args\": [\"hello world!\"]\n                  }\n                }\n              }\n            ]\n          }\n      ]  # end jobs\n  }\n```\n\n```\n> cck --set-pipeline --name hello_world --env dev\n```\n\n```\nGenerating Pipeline to dev-hello-world-operations.yml\nSetting pipeline: dev-hello-world-operations\njobs:\n...\n+   task: hello-world-task\n\napply configuration? [yN]: y\npipeline created!\nyou can view your pipeline here: http://localhost:8080/teams/main/pipelines/dev-hello-world-operations\n\nthe pipeline is currently paused. to unpause, either:\n  - run the unpause-pipeline command:\n    fly -t concourse unpause-pipeline -p dev-hello-world-operations\n  - click play next to the pipeline in the web ui\n  ```\n\n### Fly Options\nWhen setting pipelines using `fly` it's often common to run it with the `non-interactive` option, or to immediately hide, expose, pause, or unpause a pipeline.  To make this easier and explicate, you can specify a top-level variable named `fly_options = []`\n\nFor example a pipeline would be configured as such, and when it's set it won't confirm with you, it will unpause it, and automatically hide it. \n```python\nfly_options = [\n  \"non-interactive\",\n  \"unpause-pipeline\",\n  \"hide-pipeline\"\n]\n\ndef pipeline_config():\n  ...\n```\n```\n> cck --set-pipeline --name foo_mgmt --end dev\nSetting pipeline: dev-foo-mgmt\nGenerating Pipeline to dev-foo-mgmt.yml\nno changes to apply\nhid 'dev-foo-mgmt'\nunpaused 'dev-foo-mgmt'\n```\n\n### Specifying a Concourse Target\nBy default, `cck` will use the target specified within the `.cck.yml` file when running the `fly` command.  If you want to set your pipeline to a different target, you can use the top-level variable `concourse_target = str`.\n```python\nconcourse_target = \"my-cool-team\"\n\ndef pipeline_config():\n  ...\n```\n## Setting All Pipelines\nIn the event you need to re-set ALL your pipelines for ALL environments (perhaps you have to re-deploy concourse, or restore them.)  It's possible to do this with one command.\n\nTake the following pipelines and environments.\n```\n├───concourse-environments\n├───pipelines\n│   ├───bar_mgmt.py\n│   └───foo_mgmt.py\n├───pipeline_tests\n├───resources\n├───target-environments\n│   ├───common\n│   ├───dev\n│   ├───prod\n│   └───stage\n└───tasks\n```\nand `bar_mgmt` is scoped to `dev` and `stage`, `foo_mgmt` is scoped to `dev`, `stage`, and `prod`. \n\nRunning the following command will set all pipelines for the environments they are scoped to.  `cck` will give you a 10 second window to abort the command if you ran it by mistake.\n```\n> cck --set-pipeline --all\n```\n```\nSetting all pipelines in 10 seconds... ctl+c to cancel.\nGenerating Pipeline to dev-bar-mgmt-operations.yml\nSetting pipeline: dev-bar-mgmt-operations\n...\nGenerating Pipeline to stage-bar-mgmt-operations.yml\nSetting pipeline: stage-bar-mgmt-operations\n...\nGenerating Pipeline to dev-foo-mgmt-install.yml\nSetting pipeline: dev-foo-mgmt-install\n...\nGenerating Pipeline to stage-foo-mgmt-install.yml\nSetting pipeline: stage-foo-mgmt-install\n...\nGenerating Pipeline to prod-foo-mgmt-install.yml\nSetting pipeline: prod-foo-mgmt-install\n...\n```\n```\n> fly -t concourse pipelines\nname                        paused  public  last updated\ndev-foo-mgmt-install        yes     no      2021-07-04 20:41:13 -0500 CDT\nstage-foo-mgmt-install      yes     no      2021-07-04 20:41:14 -0500 CDT\nprod-foo-mgmt-install       yes     no      2021-07-04 20:41:16 -0500 CDT\ndev-bar-mgmt-operations     yes     no      2021-07-04 20:41:10 -0500 CDT\nstage-bar-mgmt-operations   yes     no      2021-07-04 20:41:12 -0500 CDT\n```\n\n## Planning Pipelines\nBefore setting pipelines, it's a wise idea to preview how `cck` will name, set, and toggle all the various `fly` options before actually setting.  In addition, you may want to ensure your configuration is valid from a Concourse perspective, even though it's valid from a Python perspective. \n\n### Planning a Single Pipeline and Target Environment\nRunning the following command will display a plan for a single pipeline and environment.\n```\n> cck --set-pipeline --name foo_mgmt --env dev --plan\n```\n![alt text](assets/cck-plan-1.jpg \"Planning Single Pipeline and Environment\")\n### Planning a Single Pipeline and All Target Environments\n```\n> cck --set-pipeline --name foo_mgmt --all --plan\n```\n![alt text](assets/cck-plan-2.jpg \"Planning a Single Pipeline and All Target Environments\")\n### Planning All Pipelines and All Target Environments\nBelow is an example of an invalid configuration and also shows the various colors!\n```\n> cck --set-pipeline --all --plan\n```\n![alt text](assets/cck-plan-3.jpg \"Planning All Pipelines and All Target Environments\")\n\n### Python Exceptions During Plan\nSometimes if you are developing a configuration and validating it, you may run into a Python Exception which `cck` is unable to handle.  In this instance, `cck` will provide you with just the traceback for the `pipeline.py` config you are working on, like so, and provide you with the `ENVIRONMENT` it was trying to generate for. \n\n![alt text](assets/cck-plan-4.jpg \"Python Exceptions During Plan\")\n\n\n## Testing Pipelines\nBecause all of the pipelines `cck` manages are *generated*, it might be a good idea to have a companion test which can ensure the pipeline will be generated correctly.  \n\nLet's say you have a really complicated pipeline which has environment-specific jobs or other conditionals.  You can write a companion test to ensure that when the pipeline config is generated it has right number of jobs etc.  You can write a test as complex or as simple as you want, it's up to you.\n\n### Testing a Single Pipeline\nLet's write a test for `pipelines/foo_mgmt.py`.  To do this we create and write a test under `pipelines_tests/foo_mgmt_test.py`.\n```python\n#pipelines/foo_mgmt.py\nfrom yamlmaker import env\nfrom yamlmaker import Include\n\npipeline_suffix = \"install\"\n\npipeline_environments = [\n  \"dev\",\n  \"stage\",\n  \"prod\"\n]\n\ndef pipeline_config():\n  return {\n      \"jobs\": [\n          {\n            \"name\": \"foo-job-\" + env(\"ENVIRONMENT\"),\n            \"plan\": [\n              {\n                \"task\": \"foo-task\",\n                \"config\": {\n                  \"platform\": \"linux\",\n                  \"image_resource\": {\n                    \"type\": \"registry-image\",\n                    \"source\": {\n                      \"repository\": \"busybox\"\n                    }\n                  },\n                  \"run\": {\n                    \"path\": \"echo\",\n                    \"args\": [\"for all envs\"]\n                  }\n                }\n              }\n            ]\n          }\n      ] + Include.when(env(\"ENVIRONMENT\") == \"dev\", [\n        {\n          \"name\": \"bar-job-\" + env(\"ENVIRONMENT\"),\n          \"plan\": [\n            {\n              \"task\": \"bar-task\",\n              \"config\": {\n                \"platform\": \"linux\",\n                \"image_resource\": {\n                  \"type\": \"registry-image\",\n                  \"source\": {\n                    \"repository\": \"busybox\"\n                  }\n                },\n                \"run\": {\n                  \"path\": \"echo\",\n                  \"args\": [\"only in dev!\"]\n                }\n              }\n            }\n          ]\n        }\n    ]) # end jobs\n  }\n\n```\nThe following test will verify that when given a specific environment, the correct number of jobs are defined. This is a simple example, but what you want to test for or verify is up to you depending on the complexity of the pipeline being generated.\n```python\n#pipeline_tests/foo_mgmt_test.py\nimport os\nfrom pipelines.foo_mgmt import pipeline_config\n\ndef test_dev_has_two_jobs():\n  os.environ[\"ENVIRONMENT\"] = \"dev\"\n  config = pipeline_config()\n  assert len(config[\"jobs\"]) == 2\n  \ndef test_prod_has_one_job():\n  os.environ[\"ENVIRONMENT\"] = \"prod\"\n  config = pipeline_config()\n  assert len(config[\"jobs\"]) == 1\n```\nRunning the test.\n```\n> cck --test-pipeline --name foo_mgmt\n```\n```\nTesting Pipeline: foo_mgmt\n================================================================================================= test session starts =================================================================================================\nplatform win32 -- Python 3.9.1, pytest-6.2.4, py-1.10.0, pluggy-0.13.1\nrootdir: C:\\Users\\Anthony\\workspace\\concourse-kit\ncollected 2 items\n\npipeline_tests\\foo_mgmt_test.py ..\n\n======================================================================================================= PASSES ========================================================================================================\n=============================================================================================== short test summary info ===============================================================================================\nPASSED pipeline_tests/foo_mgmt_test.py::test_dev_has_two_jobs\nPASSED pipeline_tests/foo_mgmt_test.py::test_prod_has_one_job\n================================================================================================== 2 passed in 0.02s ==================================================================================================\n```\n### Testing all Pipelines\nIf you want to verify all pipelines are passing their tests, simply run the following\n```\n> cck --test-pipeline --all\n```\n```\nTesting All Pipelines\n================================================================================================= test session starts =================================================================================================\nplatform win32 -- Python 3.9.1, pytest-6.2.4, py-1.10.0, pluggy-0.13.1\nrootdir: C:\\Users\\Anthony\\workspace\\concourse-kit\ncollected 3 items\n\npipeline_tests\\bar_mgmt_test.py .\npipeline_tests\\foo_mgmt_test.py ..\n\n======================================================================================================= PASSES ========================================================================================================\n=============================================================================================== short test summary info ===============================================================================================\nPASSED pipeline_tests/bar_mgmt_test.py::test_dev_has_two_jobs\nPASSED pipeline_tests/foo_mgmt_test.py::test_dev_has_two_jobs\nPASSED pipeline_tests/foo_mgmt_test.py::test_prod_has_one_job\n================================================================================================== 3 passed in 0.03s ==================================================================================================\n\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/anthonyhawkins/concourse-kit",
    "keywords": "concourse,yaml generator,pipeline manager,ci,cd",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "concoursekit",
    "package_url": "https://pypi.org/project/concoursekit/",
    "platform": "",
    "project_url": "https://pypi.org/project/concoursekit/",
    "project_urls": {
      "Homepage": "https://github.com/anthonyhawkins/concourse-kit"
    },
    "release_url": "https://pypi.org/project/concoursekit/0.1.3/",
    "requires_dist": [
      "pytoml",
      "yamlmaker",
      "pytest",
      "pyyaml"
    ],
    "requires_python": ">=3.9",
    "summary": "A Concourse CI Pipeline Generator Utility.",
    "version": "0.1.3",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 10958739,
  "releases": {
    "0.0.5": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "40c37f2644f8185d986c71f1edc6fe96200dbea1278e2865d39b781ae5fb45a8",
          "md5": "3c613ed02f79ee0505090a6b0de4a919",
          "sha256": "9583096919f8c7a21db00e6debe8b285192a964e2a071bc59ffb0c964fbfbbb9"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.5-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "3c613ed02f79ee0505090a6b0de4a919",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 9139,
        "upload_time": "2021-07-17T01:37:08",
        "upload_time_iso_8601": "2021-07-17T01:37:08.396019Z",
        "url": "https://files.pythonhosted.org/packages/40/c3/7f2644f8185d986c71f1edc6fe96200dbea1278e2865d39b781ae5fb45a8/concoursekit-0.0.5-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "93caee2a03ba9b6d5e67d1d413c809294658bdb5657e30c466ff68e57f7a9f4b",
          "md5": "e4682a276e70ae43aa2414e232504fc3",
          "sha256": "eec2c9d46331899af1e48a33bc46ea84cd0e4c78d264bd11c67e6f8d741207fd"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.5.tar.gz",
        "has_sig": false,
        "md5_digest": "e4682a276e70ae43aa2414e232504fc3",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 15269,
        "upload_time": "2021-07-17T01:37:10",
        "upload_time_iso_8601": "2021-07-17T01:37:10.214938Z",
        "url": "https://files.pythonhosted.org/packages/93/ca/ee2a03ba9b6d5e67d1d413c809294658bdb5657e30c466ff68e57f7a9f4b/concoursekit-0.0.5.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.7": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "ad5e928719b78da8ff563289086830b60ffb4598469c0fe560a9cc7dd5b0d955",
          "md5": "d60d236ffc88373bebbd0bd486d27966",
          "sha256": "aebe82752b119132b4bf210667c1e93f5e97a1442cd8aca0d00dc79f5f79f00f"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.7-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "d60d236ffc88373bebbd0bd486d27966",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 9140,
        "upload_time": "2021-07-17T02:05:53",
        "upload_time_iso_8601": "2021-07-17T02:05:53.280239Z",
        "url": "https://files.pythonhosted.org/packages/ad/5e/928719b78da8ff563289086830b60ffb4598469c0fe560a9cc7dd5b0d955/concoursekit-0.0.7-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "2c6a6210b0f7edcdbe5b6508ab64b3f65354fed70d8c805998b5d1e29fca2cdc",
          "md5": "94ec8738fc1e3430684dca6da9dc61ea",
          "sha256": "96d7329fb463e33c4c7a89cb53d8929121d646c41608c230defc5d92e09506e7"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.7.tar.gz",
        "has_sig": false,
        "md5_digest": "94ec8738fc1e3430684dca6da9dc61ea",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 15276,
        "upload_time": "2021-07-17T02:05:54",
        "upload_time_iso_8601": "2021-07-17T02:05:54.685131Z",
        "url": "https://files.pythonhosted.org/packages/2c/6a/6210b0f7edcdbe5b6508ab64b3f65354fed70d8c805998b5d1e29fca2cdc/concoursekit-0.0.7.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.8": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "e04b69605c604dfbb2701ab428eae1cec29edafed8c25dbb1a0f8e8fb7159820",
          "md5": "bf9601bc2202e8a65a2ab05fa2826ecb",
          "sha256": "0eaa735d37c8661b4e3df77dd8646ca3bd8228ce2503cdb32a3fe9fc2d05b7fd"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.8-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "bf9601bc2202e8a65a2ab05fa2826ecb",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 13343,
        "upload_time": "2021-07-17T02:53:16",
        "upload_time_iso_8601": "2021-07-17T02:53:16.729496Z",
        "url": "https://files.pythonhosted.org/packages/e0/4b/69605c604dfbb2701ab428eae1cec29edafed8c25dbb1a0f8e8fb7159820/concoursekit-0.0.8-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "2c7285ed778fa0c9472cc30111809c2bca4f28956c7f6479a313dfa0c1f57e6e",
          "md5": "ef07c66c8771928d5f5156247277727f",
          "sha256": "a7310e5d248de7d6c410399b8c7958dc79625dc699cb30ffb6d9fc5ae005f559"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.8.tar.gz",
        "has_sig": false,
        "md5_digest": "ef07c66c8771928d5f5156247277727f",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 19359,
        "upload_time": "2021-07-17T02:53:18",
        "upload_time_iso_8601": "2021-07-17T02:53:18.400349Z",
        "url": "https://files.pythonhosted.org/packages/2c/72/85ed778fa0c9472cc30111809c2bca4f28956c7f6479a313dfa0c1f57e6e/concoursekit-0.0.8.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.0.9": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "ca917ef1ff3b339b0ba295bb7ace1c9b2662a6f92aed9c10b8860ec96997e2c7",
          "md5": "27262a1e34c720b78b80fb5e5c9e306d",
          "sha256": "aa813cc93f7caf0759358f40ba021c500db1b6a9c3cb0f4485c1e786c727bf02"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.9-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "27262a1e34c720b78b80fb5e5c9e306d",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 13353,
        "upload_time": "2021-07-17T03:10:47",
        "upload_time_iso_8601": "2021-07-17T03:10:47.077303Z",
        "url": "https://files.pythonhosted.org/packages/ca/91/7ef1ff3b339b0ba295bb7ace1c9b2662a6f92aed9c10b8860ec96997e2c7/concoursekit-0.0.9-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "cdfeb21c631b4619fb7aeeafbfe89aa0ed8ca9096f34fe02af4996bc690e6f67",
          "md5": "cc12c0ea4724a9bf3e06c2781d6707f3",
          "sha256": "c4722deb1751a48e6f4cd14f84becfb99870230b1de61fa02e2f911c0c5ec64d"
        },
        "downloads": -1,
        "filename": "concoursekit-0.0.9.tar.gz",
        "has_sig": false,
        "md5_digest": "cc12c0ea4724a9bf3e06c2781d6707f3",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 19380,
        "upload_time": "2021-07-17T03:10:48",
        "upload_time_iso_8601": "2021-07-17T03:10:48.462320Z",
        "url": "https://files.pythonhosted.org/packages/cd/fe/b21c631b4619fb7aeeafbfe89aa0ed8ca9096f34fe02af4996bc690e6f67/concoursekit-0.0.9.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "8ca348a5bdaa9b3b6b9533d77e73882dbcc6a14a80acd5cf7c9e653c923def5d",
          "md5": "6b2b6723973cfc571447c66cc8c815cd",
          "sha256": "860b8ce4585ec248a91489cf4cd69cd2ddd0eeeedb1fd468f9c0173728c940b0"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "6b2b6723973cfc571447c66cc8c815cd",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 13602,
        "upload_time": "2021-07-19T02:15:00",
        "upload_time_iso_8601": "2021-07-19T02:15:00.320953Z",
        "url": "https://files.pythonhosted.org/packages/8c/a3/48a5bdaa9b3b6b9533d77e73882dbcc6a14a80acd5cf7c9e653c923def5d/concoursekit-0.1.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "039eb44379b523cbba9a15237fcafabd8e764f6ed425ac02f61f349b0a282f81",
          "md5": "786e14831c0507ebbe2ac922c9ec5e86",
          "sha256": "92cec864befc81e80fd83eadc599b2496a4f1c3d4c42047fab67587771f326ea"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "786e14831c0507ebbe2ac922c9ec5e86",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 19835,
        "upload_time": "2021-07-19T02:15:02",
        "upload_time_iso_8601": "2021-07-19T02:15:02.758064Z",
        "url": "https://files.pythonhosted.org/packages/03/9e/b44379b523cbba9a15237fcafabd8e764f6ed425ac02f61f349b0a282f81/concoursekit-0.1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a6f97d028fd96971192b3156b0ef970e7a18ba06d9a465bbc8ef9a5a1c87a9de",
          "md5": "4350176b648d2b31c7a559a827d91df5",
          "sha256": "9dbd59967fe4ab03d1fb530bede6a0c62ec9ead63e61c1c41edfa44be32a1f71"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "4350176b648d2b31c7a559a827d91df5",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 13689,
        "upload_time": "2021-07-19T14:45:59",
        "upload_time_iso_8601": "2021-07-19T14:45:59.484591Z",
        "url": "https://files.pythonhosted.org/packages/a6/f9/7d028fd96971192b3156b0ef970e7a18ba06d9a465bbc8ef9a5a1c87a9de/concoursekit-0.1.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "7dcc2b1d4eef3a1cf12c48bd54ae775c7ea8a017027d3397f0b126e2ac94b8b5",
          "md5": "feedf4d2c1307f44bfd1f0c78872f85d",
          "sha256": "69fdf52f2984fba1e4017e265b464c13c1266f0c63733903106e97a28b0e16d2"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.1.tar.gz",
        "has_sig": false,
        "md5_digest": "feedf4d2c1307f44bfd1f0c78872f85d",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 20016,
        "upload_time": "2021-07-19T14:46:00",
        "upload_time_iso_8601": "2021-07-19T14:46:00.750799Z",
        "url": "https://files.pythonhosted.org/packages/7d/cc/2b1d4eef3a1cf12c48bd54ae775c7ea8a017027d3397f0b126e2ac94b8b5/concoursekit-0.1.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "54303a19cfaa89d9efafd01da8cca652f90e65f31112ed6321a9fad127168b5a",
          "md5": "98e00ea7a7d8033c5a92d39c7aebad9f",
          "sha256": "d2de87246add5b06d07bea07dde0725be5fb6ac05b9b7d009380f80206b0448a"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.2-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "98e00ea7a7d8033c5a92d39c7aebad9f",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 13683,
        "upload_time": "2021-07-20T02:44:40",
        "upload_time_iso_8601": "2021-07-20T02:44:40.399828Z",
        "url": "https://files.pythonhosted.org/packages/54/30/3a19cfaa89d9efafd01da8cca652f90e65f31112ed6321a9fad127168b5a/concoursekit-0.1.2-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "f4f052f35910773c306ddcc763e8f148b8c80040aced6b824851136b18b2809b",
          "md5": "1a830a8cf48e282e873ec327f3084cba",
          "sha256": "bbfac9a9e9f4296d64f6e68e39f0b0a5ab86e2cf582dde306f1b8f69a90195a2"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.2.tar.gz",
        "has_sig": false,
        "md5_digest": "1a830a8cf48e282e873ec327f3084cba",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 20017,
        "upload_time": "2021-07-20T02:44:41",
        "upload_time_iso_8601": "2021-07-20T02:44:41.714546Z",
        "url": "https://files.pythonhosted.org/packages/f4/f0/52f35910773c306ddcc763e8f148b8c80040aced6b824851136b18b2809b/concoursekit-0.1.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a2f649922d81ddd0d4141e6aacf6100d430f63ede1ae7dc085c4df9dec99dc09",
          "md5": "e92c42b287308e095f2c5d41c28191dc",
          "sha256": "adef403f3be437ec375a12b5e3238b6bbcdda38912933c20889a87cf58f8bbd9"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.3-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "e92c42b287308e095f2c5d41c28191dc",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.9",
        "size": 13754,
        "upload_time": "2021-07-20T18:05:01",
        "upload_time_iso_8601": "2021-07-20T18:05:01.774863Z",
        "url": "https://files.pythonhosted.org/packages/a2/f6/49922d81ddd0d4141e6aacf6100d430f63ede1ae7dc085c4df9dec99dc09/concoursekit-0.1.3-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "b51e431bf9e3a4ae5c9dc423219b28a3879e75f34e93fdc4538b9727fb395024",
          "md5": "c31a7f628a99f46f9b647822d889128e",
          "sha256": "b90047ad578bc6d3629c4c9f75a448e60b42e99bddd9bff387a3dc53afa528e4"
        },
        "downloads": -1,
        "filename": "concoursekit-0.1.3.tar.gz",
        "has_sig": false,
        "md5_digest": "c31a7f628a99f46f9b647822d889128e",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.9",
        "size": 20118,
        "upload_time": "2021-07-20T18:05:03",
        "upload_time_iso_8601": "2021-07-20T18:05:03.688019Z",
        "url": "https://files.pythonhosted.org/packages/b5/1e/431bf9e3a4ae5c9dc423219b28a3879e75f34e93fdc4538b9727fb395024/concoursekit-0.1.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "a2f649922d81ddd0d4141e6aacf6100d430f63ede1ae7dc085c4df9dec99dc09",
        "md5": "e92c42b287308e095f2c5d41c28191dc",
        "sha256": "adef403f3be437ec375a12b5e3238b6bbcdda38912933c20889a87cf58f8bbd9"
      },
      "downloads": -1,
      "filename": "concoursekit-0.1.3-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "e92c42b287308e095f2c5d41c28191dc",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.9",
      "size": 13754,
      "upload_time": "2021-07-20T18:05:01",
      "upload_time_iso_8601": "2021-07-20T18:05:01.774863Z",
      "url": "https://files.pythonhosted.org/packages/a2/f6/49922d81ddd0d4141e6aacf6100d430f63ede1ae7dc085c4df9dec99dc09/concoursekit-0.1.3-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "b51e431bf9e3a4ae5c9dc423219b28a3879e75f34e93fdc4538b9727fb395024",
        "md5": "c31a7f628a99f46f9b647822d889128e",
        "sha256": "b90047ad578bc6d3629c4c9f75a448e60b42e99bddd9bff387a3dc53afa528e4"
      },
      "downloads": -1,
      "filename": "concoursekit-0.1.3.tar.gz",
      "has_sig": false,
      "md5_digest": "c31a7f628a99f46f9b647822d889128e",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.9",
      "size": 20118,
      "upload_time": "2021-07-20T18:05:03",
      "upload_time_iso_8601": "2021-07-20T18:05:03.688019Z",
      "url": "https://files.pythonhosted.org/packages/b5/1e/431bf9e3a4ae5c9dc423219b28a3879e75f34e93fdc4538b9727fb395024/concoursekit-0.1.3.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}