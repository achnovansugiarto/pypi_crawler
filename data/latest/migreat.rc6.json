{
  "info": {
    "author": "Jo√£o Sampaio",
    "author_email": "jpmelos@gmail.com",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 4 - Beta",
      "Environment :: Console",
      "Intended Audience :: Developers",
      "Intended Audience :: System Administrators",
      "License :: OSI Approved :: MIT License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Programming Language :: Python :: 3.9",
      "Topic :: Database"
    ],
    "description": "# migreat\n\nA flexible SQL migration runner.\n\nRight now, supports only PostgreSQL via `psycopg2`, as it's still an experiment. Support for any database with a DBAPI implementation is planned.\n\n## Install\n\n`migreat` supports Python 3.7, 3.8, and 3.9. Since it currently only supports PostgreSQL via `psycopg2`, it will also be installed.\n\n```\npip install migreat\n```\n\n## Mental Model\n\n`migreat` runs SQL migrations with a DB cursor provided by your code via a function, and stores migration metadata in a table with the datetime it was run, the ID of the user who ran it, the name of the migration, and a hash of its contents at the time it was run. The hash of a migration will be checked against if it is ever rolled back, to make sure we are rolling back the same migration that was once run.\n\n## Usage\n\nMigrations are simple SQL files placed inside a directory and following a name pattern. The name pattern is `YEAR-MONTH-DAY-SEQNUM-arbitrary-name.sql`. `YEAR-MONTH-DAY` is the day's date following ISO 8601. The `SEQNUM` is a 2-digit sequential number for migrations released in the same day. Some valid names:\n\n```\n2020-01-10-03-create-users-table.sql\n2020-03-18-01-remove-foreign-keys-from-audit-tables.sql\n```\n\n`migreat` will run the migrations in sequence of date and sequence number.\n\nCreate the migrations table:\n\n```\n$ migreat create-migrations-table \\\n    --cursor-factory yourapp.db.atomic\n```\n\nRun migrations:\n\n```\n$ migreat run \\\n    --migrations-dir migrations \\\n    --user-id 42 \\\n    --last-migration 2020-01-01-01 \\\n    --cursor-factory yourapp.db.atomic \\\n    --rollback\n```\n\nThis will:\n\n- Look for the migrations in directory `migrations` relative to the current working directory;\n  - If this is not supplied, the default value will be `migrations`;\n- Run the migrations as user with ID 42;\n- Run migrations rolling them back, only back up to migration `2020-01-01-01`;\n- Run the function `yourapp.db.atomic` with no arguments expecting it to return a DBAPI cursor (see tests for an example).\n\n`migreat` allows you to constrain the user ID to real user IDs you might have in some table in your database. To enable it:\n\n```\n$ migreat create-user-id-foreign-key users id \\\n    --cursor-factory yourapp.db.atomic\n```\n\nThis will constrain user IDs to values in the column `id` of table `users`.\n\nFinally, you can drop the user ID foreign key constraint:\n\n```\n$ migreat drop-user-id-foreign-key \\\n    --cursor-factory yourapp.db.atomic\n```\n\nAnd drop the migrations table:\n\n```\n$ migreat drop-migrations-table \\\n    --cursor-factory yourapp.db.atomic\n```\n\nAll above commands also accept:\n\n```\n--cursor-factory-args=value1,value2\n--cursor-factory-kwargs=key1,value1,key2,value2\n```\n\nValues are valid CSV strings and can contain nested commas inside proper delimiters.\n\n## Development\n\nClone the source code from GitHub, have a Docker Engine reachable, have all supported Python interpreters in your `PATH` (we recommend that you use `pyenv` to manage different Python interpreters and environments) and create a new virtual environment with `poetry install`.\n\nRun the tests with:\n\n```\n./run test-db\n# Wait for the database to be ready\n./run all-tests\n```\n\nTo run a specific test:\n\n```\n./run test-db\n# Wait for the database to be ready\n./run test <test-address>\n```\n\nTo make sure your code abides to our quality standards, run:\n\n```\n./run quality\n```\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/jpmelos/migreat",
    "keywords": "database,postgresql,sql,migrations",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "migreat",
    "package_url": "https://pypi.org/project/migreat/",
    "platform": "",
    "project_url": "https://pypi.org/project/migreat/",
    "project_urls": {
      "Documentation": "https://github.com/jpmelos/migreat",
      "Homepage": "https://github.com/jpmelos/migreat",
      "Repository": "https://github.com/jpmelos/migreat"
    },
    "release_url": "https://pypi.org/project/migreat/0.1.5/",
    "requires_dist": [
      "click (>=8,<9)",
      "psycopg2 (>=2.8,<3)"
    ],
    "requires_python": ">=3.7,<3.10",
    "summary": "A flexible SQL migration runner.",
    "version": "0.1.5",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 11123055,
  "releases": {
    "0.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "9f45d1e33c8df316373d85d630f5a9908f2443774edbb6f59c48c3b26fdd65f8",
          "md5": "8be429890d8405fd4df7948ad23b77ed",
          "sha256": "4678b98f47aa495aca4d8e2003dc484e1e5e6f88f8fdfb14baf09323d56403d0"
        },
        "downloads": -1,
        "filename": "migreat-0.1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "8be429890d8405fd4df7948ad23b77ed",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6,<3.9",
        "size": 8739,
        "upload_time": "2020-08-08T20:25:19",
        "upload_time_iso_8601": "2020-08-08T20:25:19.201563Z",
        "url": "https://files.pythonhosted.org/packages/9f/45/d1e33c8df316373d85d630f5a9908f2443774edbb6f59c48c3b26fdd65f8/migreat-0.1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "c9451086bf3628453f7ad1ef4250d511d4ab4896998ff80c1ebe4bf6eaf4ff13",
          "md5": "a6d0affdf74552a7050df0a377f85651",
          "sha256": "adeb3eebe24576db80a6b26d699dcaec75a5f27ff93c4bf5e44b412f69f758f5"
        },
        "downloads": -1,
        "filename": "migreat-0.1.1.tar.gz",
        "has_sig": false,
        "md5_digest": "a6d0affdf74552a7050df0a377f85651",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6,<3.9",
        "size": 8818,
        "upload_time": "2020-08-08T21:19:22",
        "upload_time_iso_8601": "2020-08-08T21:19:22.633238Z",
        "url": "https://files.pythonhosted.org/packages/c9/45/1086bf3628453f7ad1ef4250d511d4ab4896998ff80c1ebe4bf6eaf4ff13/migreat-0.1.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "26654e73b31d4a40546871be148bb6f8cf59e9bcce913a2a44c6f2b9a21a1905",
          "md5": "0cb3be97eda122e9ccbf17e186adbca8",
          "sha256": "f88e1dbc9f11b47c51112687c6f71dbc8ad29d724721a462b984b1dbb188b815"
        },
        "downloads": -1,
        "filename": "migreat-0.1.2.tar.gz",
        "has_sig": false,
        "md5_digest": "0cb3be97eda122e9ccbf17e186adbca8",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.6,<3.9",
        "size": 9194,
        "upload_time": "2021-01-26T12:42:45",
        "upload_time_iso_8601": "2021-01-26T12:42:45.436405Z",
        "url": "https://files.pythonhosted.org/packages/26/65/4e73b31d4a40546871be148bb6f8cf59e9bcce913a2a44c6f2b9a21a1905/migreat-0.1.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "097edffd266ae809f2bc5236549e15e7148b4b54463ab5af6e4001aa5c86ed47",
          "md5": "f094c4b24ab076752979b4698d218052",
          "sha256": "aaee2e9f413a2a2f8efa548188a944dc789c4194192097cb7c87913989bb54a1"
        },
        "downloads": -1,
        "filename": "migreat-0.1.3.tar.gz",
        "has_sig": false,
        "md5_digest": "f094c4b24ab076752979b4698d218052",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<3.10",
        "size": 9197,
        "upload_time": "2021-01-30T19:03:49",
        "upload_time_iso_8601": "2021-01-30T19:03:49.789092Z",
        "url": "https://files.pythonhosted.org/packages/09/7e/dffd266ae809f2bc5236549e15e7148b4b54463ab5af6e4001aa5c86ed47/migreat-0.1.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.4": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "23fd54c9e8b9e62159db050b1ef2f5272bcbd7691175d3a0bba5b33c393262b9",
          "md5": "4168d5651b62bf74739e6ea15111f5e6",
          "sha256": "6e7bcc5d8b4c14823c9f14f6d6f08694a0a14814717ae2efb19984ae5e7f3ca5"
        },
        "downloads": -1,
        "filename": "migreat-0.1.4-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "4168d5651b62bf74739e6ea15111f5e6",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<3.10",
        "size": 8724,
        "upload_time": "2021-08-07T19:33:26",
        "upload_time_iso_8601": "2021-08-07T19:33:26.071061Z",
        "url": "https://files.pythonhosted.org/packages/23/fd/54c9e8b9e62159db050b1ef2f5272bcbd7691175d3a0bba5b33c393262b9/migreat-0.1.4-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a415f61625fc4364e3f0f28d24426e736084d4acace09986e726d138ab8abbfe",
          "md5": "0ee4cf5af736612f5c17b591cedf1e35",
          "sha256": "1e5784fd148941f71b143f0a6dec38f6424c49d52c570b783c2320eaeb78b31a"
        },
        "downloads": -1,
        "filename": "migreat-0.1.4.tar.gz",
        "has_sig": false,
        "md5_digest": "0ee4cf5af736612f5c17b591cedf1e35",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<3.10",
        "size": 9784,
        "upload_time": "2021-08-07T19:33:27",
        "upload_time_iso_8601": "2021-08-07T19:33:27.770788Z",
        "url": "https://files.pythonhosted.org/packages/a4/15/f61625fc4364e3f0f28d24426e736084d4acace09986e726d138ab8abbfe/migreat-0.1.4.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.5": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "6843da2655c44b3a6f5918d730b87be17ef882f31abaefff3c63785a39554f65",
          "md5": "ac48b0177b3bc0c3d6d68db7c31ed1d8",
          "sha256": "a877cf8b76c9fe9f27c789c95b2173c61b49ba6c57eb4ef20baade97ae271c62"
        },
        "downloads": -1,
        "filename": "migreat-0.1.5-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "ac48b0177b3bc0c3d6d68db7c31ed1d8",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<3.10",
        "size": 9030,
        "upload_time": "2021-08-08T15:16:00",
        "upload_time_iso_8601": "2021-08-08T15:16:00.229936Z",
        "url": "https://files.pythonhosted.org/packages/68/43/da2655c44b3a6f5918d730b87be17ef882f31abaefff3c63785a39554f65/migreat-0.1.5-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "dbe71e855b82c7c705f73e546d3aec8ede9e5a8608142351f9dddf34c2914251",
          "md5": "05d5492e0c766b39889c6950c43ac097",
          "sha256": "8108b83c464d6694c4343aade9cb3f4ee3f39b1b89d8780687b6b683e9a61153"
        },
        "downloads": -1,
        "filename": "migreat-0.1.5.tar.gz",
        "has_sig": false,
        "md5_digest": "05d5492e0c766b39889c6950c43ac097",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<3.10",
        "size": 10425,
        "upload_time": "2021-08-08T15:16:01",
        "upload_time_iso_8601": "2021-08-08T15:16:01.918816Z",
        "url": "https://files.pythonhosted.org/packages/db/e7/1e855b82c7c705f73e546d3aec8ede9e5a8608142351f9dddf34c2914251/migreat-0.1.5.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "6843da2655c44b3a6f5918d730b87be17ef882f31abaefff3c63785a39554f65",
        "md5": "ac48b0177b3bc0c3d6d68db7c31ed1d8",
        "sha256": "a877cf8b76c9fe9f27c789c95b2173c61b49ba6c57eb4ef20baade97ae271c62"
      },
      "downloads": -1,
      "filename": "migreat-0.1.5-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "ac48b0177b3bc0c3d6d68db7c31ed1d8",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7,<3.10",
      "size": 9030,
      "upload_time": "2021-08-08T15:16:00",
      "upload_time_iso_8601": "2021-08-08T15:16:00.229936Z",
      "url": "https://files.pythonhosted.org/packages/68/43/da2655c44b3a6f5918d730b87be17ef882f31abaefff3c63785a39554f65/migreat-0.1.5-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "dbe71e855b82c7c705f73e546d3aec8ede9e5a8608142351f9dddf34c2914251",
        "md5": "05d5492e0c766b39889c6950c43ac097",
        "sha256": "8108b83c464d6694c4343aade9cb3f4ee3f39b1b89d8780687b6b683e9a61153"
      },
      "downloads": -1,
      "filename": "migreat-0.1.5.tar.gz",
      "has_sig": false,
      "md5_digest": "05d5492e0c766b39889c6950c43ac097",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7,<3.10",
      "size": 10425,
      "upload_time": "2021-08-08T15:16:01",
      "upload_time_iso_8601": "2021-08-08T15:16:01.918816Z",
      "url": "https://files.pythonhosted.org/packages/db/e7/1e855b82c7c705f73e546d3aec8ede9e5a8608142351f9dddf34c2914251/migreat-0.1.5.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}