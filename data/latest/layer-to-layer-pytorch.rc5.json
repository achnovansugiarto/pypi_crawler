{
  "info": {
    "author": "Roman Tezikov",
    "author_email": "tez.romach@gmail.com",
    "bugtrack_url": null,
    "classifiers": [
      "Development Status :: 3 - Alpha",
      "Intended Audience :: Developers",
      "License :: OSI Approved :: MIT License",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3",
      "Programming Language :: Python :: 3.7",
      "Programming Language :: Python :: 3.8",
      "Topic :: Software Development :: Libraries :: Python Modules"
    ],
    "description": "# L2L execution algorithm PyTorch\n\n<div align=\"center\">\n\n[![Build status](https://github.com/TezRomacH/layer-to-layer-pytorch/workflows/build/badge.svg?branch=master&event=push)](https://github.com/TezRomacH/layer-to-layer-pytorch/actions?query=workflow%3Abuild)\n[![Python Version](https://img.shields.io/pypi/pyversions/layer-to-layer-pytorch.svg)](https://pypi.org/project/layer-to-layer-pytorch/)\n[![Dependencies Status](https://img.shields.io/badge/dependencies-up%20to%20date-brightgreen.svg)](https://github.com/TezRomacH/layer-to-layer-pytorch/pulls?utf8=%E2%9C%93&q=is%3Apr%20author%3Aapp%2Fdependabot)\n\n[![Code style: black](https://img.shields.io/badge/code%20style-black-000000.svg)](https://github.com/psf/black)\n[![Security: bandit](https://img.shields.io/badge/security-bandit-green.svg)](https://github.com/PyCQA/bandit)\n[![Pre-commit](https://img.shields.io/badge/pre--commit-enabled-brightgreen?logo=pre-commit&logoColor=white)](https://github.com/TezRomacH/layer-to-layer-pytorch/blob/master/.pre-commit-config.yaml)\n[![Semantic Versions](https://img.shields.io/badge/%F0%9F%9A%80-semantic%20versions-informational.svg)](https://github.com/TezRomacH/layer-to-layer-pytorch/releases)\n[![License](https://img.shields.io/github/license/TezRomacH/layer-to-layer-pytorch)](https://github.com/TezRomacH/layer-to-layer-pytorch/blob/master/LICENSE)\n\nPyTorch implementation of L2L execution algorithm from paper [Training Large Neural Networks with Constant Memory using a New Execution Algorithm](https://arxiv.org/abs/2002.05645)\n</div>\n\n## ðŸš€ Example\n\nYou need to define a torch model where all layers are specified in ModuleList.\n\nSee [examples folder](examples)\n\n### Basic usage\n\n```python\nimport torch\nfrom torch import nn, optim\n\nclass M(nn.Module):\n    def __init__(self, depth: int, dim: int, hidden_dim: Optional[int] = None):\n        super().__init__()\n        hidden_dim = hidden_dim or dim\n        self.layers = nn.ModuleList(\n            [\n                nn.Sequential(\n                    nn.Linear(dim, hidden_dim),\n                    nn.BatchNorm1d(hidden_dim),\n                    nn.LeakyReLU(),\n                )\n            ]\n            + [\n                nn.Sequential(\n                    nn.Linear(hidden_dim, hidden_dim),\n                    nn.BatchNorm1d(hidden_dim),\n                    nn.LeakyReLU(),\n                )\n                for i in range(depth)\n            ]\n            + [nn.Linear(hidden_dim, dim), nn.Sigmoid()]\n        )\n\n    def forward(self, batch: torch.Tensor) -> torch.Tensor:\n        x = batch\n        for l in self.layers:\n            x = l(x)\n\n        return x\n\n\nmodel = M(depth=5, dim=40).train() # on CPU\n```\n\nThen, you can use the L2L wrapper over this model.\n\n```python\nfrom layer_to_layer_pytorch.l2l import Layer2Layer\n\nl2l_model = Layer2Layer(\n    model,\n    layers_attr=\"layers\", # attribute with ModuleList\n    microbatch_size=100,  # size of a microbatch in a minibatch :) from original paper\n    verbose=False  # enable tqdm\n)\n```\n\nAnd train it, like torch model (almost):\n\n```python\nfrom tqdm.auto import tqdm, trange\n\nx = torch.rand(1_000, 40) # on CPU\ny = torch.rand(1_000, 40) # on CPU\n\nlosses = []\ncriterion = nn.MSELoss()\n\noptimizer = optim.AdamW(l2l_model.main_params) # optimizer works with the main model on CPU\n\nfor i in trange(2000):\n    l2l_model.zero_grad()\n    _ = l2l_model.forward(x)\n\n    loss_value: float = l2l_model.compute_loss(y, criterion)\n\n    if i % 50 == 0:\n        tqdm.write(f\"[{i}] loss = {loss_value}\")\n    losses.append(loss_value)\n\n\n    l2l_model.backward()\n    optimizer.step()\n    l2l_model.update_main_model_params() # Sync params with CPU\n```\n\n### FP-16 usage\n\nCross-mixes-precision available in init params\n\n```python\nfrom layer_to_layer_pytorch.l2l import Layer2Layer\n\nl2l_model = Layer2Layer(\n    model,\n    layers_attr=\"layers\",\n    microbatch_size=100,\n\n    # fp-16\n    mixed_precision=True,\n    loss_scale = 128.0\n)\n```\n\nAnd then train the same way ðŸ˜‰\n\n## Installation\n\n```bash\npip install layer-to-layer-pytorch\n```\n\nor install with `Poetry`\n\n```bash\npoetry add layer-to-layer-pytorch\n```\n\n## ðŸ“ˆ Releases\n\nYou can see the list of available releases on the [GitHub Releases](https://github.com/TezRomacH/layer-to-layer-pytorch/releases) page.\n\nWe follow [Semantic Versions](https://semver.org/) specification.\n\n## ðŸ›¡ License\n\n[![License](https://img.shields.io/github/license/TezRomacH/layer-to-layer-pytorch)](https://github.com/TezRomacH/layer-to-layer-pytorch/blob/master/LICENSE)\n\nThis project is licensed under the terms of the `MIT` license. See [LICENSE](https://github.com/TezRomacH/layer-to-layer-pytorch/blob/master/LICENSE) for more details.\n\n## ðŸ“ƒ Citation\n\n### This library\n\n```\n@misc{layer-to-layer-pytorch,\n  author = {Roman Tezikov},\n  title = {PyTorch implementation of L2L execution algorithm},\n  year = {2020},\n  publisher = {GitHub},\n  journal = {GitHub repository},\n  howpublished = {\\url{https://github.com/TezRomacH/layer-to-layer-pytorch}}\n}\n```\n\n### Original paper\n\n```\n@article{Pudipeddi2020TrainingLN,\n  title={Training Large Neural Networks with Constant Memory using a New Execution Algorithm},\n  author={Bharadwaj Pudipeddi and Maral Mesmakhosroshahi and J. Xi and S. Bharadwaj},\n  journal={ArXiv},\n  year={2020},\n  volume={abs/2002.05645}\n}\n```\n\n## Credits\n\nThis project was generated with [`python-package-template`](https://github.com/TezRomacH/python-package-template).\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/TezRomacH/layer-to-layer-pytorch",
    "keywords": "",
    "license": "MIT",
    "maintainer": "",
    "maintainer_email": "",
    "name": "layer-to-layer-pytorch",
    "package_url": "https://pypi.org/project/layer-to-layer-pytorch/",
    "platform": "",
    "project_url": "https://pypi.org/project/layer-to-layer-pytorch/",
    "project_urls": {
      "Homepage": "https://github.com/TezRomacH/layer-to-layer-pytorch",
      "Repository": "https://github.com/TezRomacH/layer-to-layer-pytorch"
    },
    "release_url": "https://pypi.org/project/layer-to-layer-pytorch/0.3.0/",
    "requires_dist": [
      "importlib_metadata (>=1.6.0,<2.0.0); python_version < \"3.8\"",
      "typer[all] (>=0.3.2,<0.4.0)",
      "torch (>=1.6.0,<2.0.0)",
      "tqdm (>=4.48.2,<5.0.0)",
      "numpy (>=1.19.1,<2.0.0)"
    ],
    "requires_python": ">=3.7,<4.0",
    "summary": "PyTorch implementation of L2L execution algorithm",
    "version": "0.3.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 8209823,
  "releases": {
    "0.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "83eaf106ed1f7308cfd5ab20c585186861d3ac57f6bc0911c4d40dc8865f32c9",
          "md5": "0bbeb6e81ec5115c7b4e962831a00ca0",
          "sha256": "51cc389d16936b6e868474a8cfcf1b5ebbb028bc497ca477a19c034a91767827"
        },
        "downloads": -1,
        "filename": "layer_to_layer_pytorch-0.1.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "0bbeb6e81ec5115c7b4e962831a00ca0",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<4.0",
        "size": 6389,
        "upload_time": "2020-09-08T20:00:09",
        "upload_time_iso_8601": "2020-09-08T20:00:09.992007Z",
        "url": "https://files.pythonhosted.org/packages/83/ea/f106ed1f7308cfd5ab20c585186861d3ac57f6bc0911c4d40dc8865f32c9/layer_to_layer_pytorch-0.1.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "cdc1f62742e03141d4dd27dc2568ad73902d45b57a2f405bea590510bf4481a3",
          "md5": "57f4c9dac03ce9018470f7fc1f8ae838",
          "sha256": "81e9e2c88c2db7e8e8affdae2fd836a2ced51a4af45daa7866d2d5ed028b2d7c"
        },
        "downloads": -1,
        "filename": "layer-to-layer-pytorch-0.1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "57f4c9dac03ce9018470f7fc1f8ae838",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<4.0",
        "size": 5820,
        "upload_time": "2020-09-08T20:00:07",
        "upload_time_iso_8601": "2020-09-08T20:00:07.454670Z",
        "url": "https://files.pythonhosted.org/packages/cd/c1/f62742e03141d4dd27dc2568ad73902d45b57a2f405bea590510bf4481a3/layer-to-layer-pytorch-0.1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.1.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "1aa74a750ab9ef6e36aa4482281ac958c60d7cad59b5cdd82b9c62bcd35960dc",
          "md5": "190abc83d5b6bf419b10c186e0955c09",
          "sha256": "fbb90aeb412b07848af1af159c231000f0811b42a93757d2893d321713472d64"
        },
        "downloads": -1,
        "filename": "layer_to_layer_pytorch-0.1.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "190abc83d5b6bf419b10c186e0955c09",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<4.0",
        "size": 9166,
        "upload_time": "2020-09-13T05:29:25",
        "upload_time_iso_8601": "2020-09-13T05:29:25.922311Z",
        "url": "https://files.pythonhosted.org/packages/1a/a7/4a750ab9ef6e36aa4482281ac958c60d7cad59b5cdd82b9c62bcd35960dc/layer_to_layer_pytorch-0.1.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "fe2764ef9609e13919899d2d45876d0c527fb4bc312a04f291eb169ec1f7791a",
          "md5": "485d54c746a1eab50fb975f9d4c62137",
          "sha256": "306d8e060f4825aaa0b46650ac0fbfece26e433519bf6728860487423e8a0b05"
        },
        "downloads": -1,
        "filename": "layer-to-layer-pytorch-0.1.1.tar.gz",
        "has_sig": false,
        "md5_digest": "485d54c746a1eab50fb975f9d4c62137",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<4.0",
        "size": 9605,
        "upload_time": "2020-09-13T05:29:24",
        "upload_time_iso_8601": "2020-09-13T05:29:24.574711Z",
        "url": "https://files.pythonhosted.org/packages/fe/27/64ef9609e13919899d2d45876d0c527fb4bc312a04f291eb169ec1f7791a/layer-to-layer-pytorch-0.1.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.2.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "c180d066fd21c214ad6ae90ac677225a8a315ba7f229c1d951404ab5fb450524",
          "md5": "f171d839c9314bb151b47265b52c111c",
          "sha256": "92b90f5f22f67a3e679e7cc5fe2a345a2f9c7589cfa96c759098977b91e10250"
        },
        "downloads": -1,
        "filename": "layer_to_layer_pytorch-0.2.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "f171d839c9314bb151b47265b52c111c",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<4.0",
        "size": 9160,
        "upload_time": "2020-09-14T20:42:34",
        "upload_time_iso_8601": "2020-09-14T20:42:34.851587Z",
        "url": "https://files.pythonhosted.org/packages/c1/80/d066fd21c214ad6ae90ac677225a8a315ba7f229c1d951404ab5fb450524/layer_to_layer_pytorch-0.2.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "16de4ed07709c2fa9ea627ba37223781e5703780b7ff39517a5a66eff38f6e5e",
          "md5": "9c32cfc621e688f1888eb4f3b5079f90",
          "sha256": "e5eae57eba88e76520885873fec54f7052c1055225bd05f184ce1037d714cd2e"
        },
        "downloads": -1,
        "filename": "layer-to-layer-pytorch-0.2.0.tar.gz",
        "has_sig": false,
        "md5_digest": "9c32cfc621e688f1888eb4f3b5079f90",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<4.0",
        "size": 9392,
        "upload_time": "2020-09-14T20:42:33",
        "upload_time_iso_8601": "2020-09-14T20:42:33.426207Z",
        "url": "https://files.pythonhosted.org/packages/16/de/4ed07709c2fa9ea627ba37223781e5703780b7ff39517a5a66eff38f6e5e/layer-to-layer-pytorch-0.2.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.2.1": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "ad5895e9d89a5695d3f5adcde06767f72c0aacdd385740281b944dc280f4ef08",
          "md5": "7d28bb73b5904dc1c8c1f87a03ec0bb0",
          "sha256": "8a5ece2b4d89b42180d113f4331a28a6f07627ce80ea481ee066e5ab80f1b0ce"
        },
        "downloads": -1,
        "filename": "layer_to_layer_pytorch-0.2.1-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "7d28bb73b5904dc1c8c1f87a03ec0bb0",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<4.0",
        "size": 9190,
        "upload_time": "2020-09-15T14:15:04",
        "upload_time_iso_8601": "2020-09-15T14:15:04.097208Z",
        "url": "https://files.pythonhosted.org/packages/ad/58/95e9d89a5695d3f5adcde06767f72c0aacdd385740281b944dc280f4ef08/layer_to_layer_pytorch-0.2.1-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "74707ea732a3396b689113eda57052c0ecd7c447f263e137a875cf1606c34eca",
          "md5": "0723a226fd9abb86a8db92cee520df1d",
          "sha256": "00cbcbdc6a8d9d7017696a00b9e2344598e3b95f281b5b7510847e6d96b5ebd4"
        },
        "downloads": -1,
        "filename": "layer-to-layer-pytorch-0.2.1.tar.gz",
        "has_sig": false,
        "md5_digest": "0723a226fd9abb86a8db92cee520df1d",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<4.0",
        "size": 9574,
        "upload_time": "2020-09-15T14:15:02",
        "upload_time_iso_8601": "2020-09-15T14:15:02.359193Z",
        "url": "https://files.pythonhosted.org/packages/74/70/7ea732a3396b689113eda57052c0ecd7c447f263e137a875cf1606c34eca/layer-to-layer-pytorch-0.2.1.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.3.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "1e9ba371dc39f83046a5d779bc5d4a2fb84ea1f148d6540e53379e850bec4163",
          "md5": "7acde36142bdab34be8cefa8e08517c0",
          "sha256": "9e193ff1b64d48c15d0e70f1248160fe12e9fc32bb7ce8ade212f2fb2dc3fa95"
        },
        "downloads": -1,
        "filename": "layer_to_layer_pytorch-0.3.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "7acde36142bdab34be8cefa8e08517c0",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.7,<4.0",
        "size": 8109,
        "upload_time": "2020-09-17T16:44:09",
        "upload_time_iso_8601": "2020-09-17T16:44:09.164792Z",
        "url": "https://files.pythonhosted.org/packages/1e/9b/a371dc39f83046a5d779bc5d4a2fb84ea1f148d6540e53379e850bec4163/layer_to_layer_pytorch-0.3.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "21a693c53ef94e64f592725a5f2d677acb1f2838f21ff651fe8ee508a367ab0b",
          "md5": "2c8f42c537e6cbad761ad851b9741534",
          "sha256": "9f0ef78dfba153b608a082a9d05ca043007e6637c63ddc6472ff0bf07f639211"
        },
        "downloads": -1,
        "filename": "layer-to-layer-pytorch-0.3.0.tar.gz",
        "has_sig": false,
        "md5_digest": "2c8f42c537e6cbad761ad851b9741534",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7,<4.0",
        "size": 7804,
        "upload_time": "2020-09-17T16:44:07",
        "upload_time_iso_8601": "2020-09-17T16:44:07.963705Z",
        "url": "https://files.pythonhosted.org/packages/21/a6/93c53ef94e64f592725a5f2d677acb1f2838f21ff651fe8ee508a367ab0b/layer-to-layer-pytorch-0.3.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "1e9ba371dc39f83046a5d779bc5d4a2fb84ea1f148d6540e53379e850bec4163",
        "md5": "7acde36142bdab34be8cefa8e08517c0",
        "sha256": "9e193ff1b64d48c15d0e70f1248160fe12e9fc32bb7ce8ade212f2fb2dc3fa95"
      },
      "downloads": -1,
      "filename": "layer_to_layer_pytorch-0.3.0-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "7acde36142bdab34be8cefa8e08517c0",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.7,<4.0",
      "size": 8109,
      "upload_time": "2020-09-17T16:44:09",
      "upload_time_iso_8601": "2020-09-17T16:44:09.164792Z",
      "url": "https://files.pythonhosted.org/packages/1e/9b/a371dc39f83046a5d779bc5d4a2fb84ea1f148d6540e53379e850bec4163/layer_to_layer_pytorch-0.3.0-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "21a693c53ef94e64f592725a5f2d677acb1f2838f21ff651fe8ee508a367ab0b",
        "md5": "2c8f42c537e6cbad761ad851b9741534",
        "sha256": "9f0ef78dfba153b608a082a9d05ca043007e6637c63ddc6472ff0bf07f639211"
      },
      "downloads": -1,
      "filename": "layer-to-layer-pytorch-0.3.0.tar.gz",
      "has_sig": false,
      "md5_digest": "2c8f42c537e6cbad761ad851b9741534",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7,<4.0",
      "size": 7804,
      "upload_time": "2020-09-17T16:44:07",
      "upload_time_iso_8601": "2020-09-17T16:44:07.963705Z",
      "url": "https://files.pythonhosted.org/packages/21/a6/93c53ef94e64f592725a5f2d677acb1f2838f21ff651fe8ee508a367ab0b/layer-to-layer-pytorch-0.3.0.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}