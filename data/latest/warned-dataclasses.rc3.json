{
  "info": {
    "author": "",
    "author_email": "Angus L'Herrou <contact@lru.dev>",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: Apache Software License",
      "Programming Language :: Python :: 3",
      "Programming Language :: Python :: 3.10",
      "Programming Language :: Python :: 3.11",
      "Programming Language :: Python :: 3.8",
      "Programming Language :: Python :: 3.9"
    ],
    "description": "# warned-dataclasses\n\n[![pypi](https://img.shields.io/pypi/v/warned-dataclasses)](https://pypi.org/project/warned-dataclasses) [![codecov](https://img.shields.io/codecov/c/github/lru-dev/warned-dataclasses)](https://app.codecov.io/gh/lru-dev/warned-dataclasses)\n\nThis package adds functionality to Python's `dataclasses` feature to \nemit a warning or raise an exception if an explicit value for an \nattribute was used to initialize a dataclass but some user-specified \ncondition that that attribute logically relies on was not met.\n\n## Motivation\n\nThe primary use case for this package is for tools (such as ðŸ¤— \nTransformers) that use `dataclasses` for command-line parsing, where \ndifferent command-line parameters make sense in different scenarios.\n\nIn the simple case, a programmer can just emit a warning or raise an \nexception if an explicit value was passed to one of these parameters in \na context where it is not appropriate. However, the programmer may also \nwant to set sensible defaults for such parameters when they are \nappropriate.\n\nOne approach to this problem is to compare the runtime value against the \ndefault value, and assume an explicit value was passed if they do not \nmatch. However, this approach presents two concerns: \n\n1. complex and\ndifficult-to-introspect `default_factory` objects may be used in the\ndataclass's fields\n2. the programmer may want to warn the user even if they explicitly pass \nthe default value\n\nThis package presents a solution to both of these problems.\n\n## Installation\n\nThis package is on PyPI for Python >=3.8:\n\n```sh\npip install warned-dataclasses\n```\n\n## Usage\n\nThere are two simple usage paradigms for this package.\nThe following (contrived) examples should illustrate them.\n\n### 1. `warn_for_condition`\n\nWith this approach, warnings are emitted as unmet conditions are \ndiscovered. This could be useful for emitting relevant warnings amidst\nother logging statements describing program flow, or (when using error=True)\nif an unmet condition in a critical point in the program should terminate\nthe program immediately.\n\n```python\nimport json\n\nfrom dataclasses import dataclass, field\n\nfrom warned_dataclasses import Warned, warned, warn_for_condition\n\n\n@warned\n@dataclass\nclass User:\n    id: int\n    admin_level: Warned[int, 'admin_only'] = field(default=1)\n\n\ndef check_admin(user: User):\n    with open('admins.json', 'r') as admins_fd:\n        admins = json.load(admins_fd)\n\n    if user.id not in admins:\n        # uh-oh, user is not an admin\n        warn_for_condition(user, 'admin_only')\n\n\nif __name__ == '__main__':\n    user = User(123, admin_level=2)\n    check_admin(user)\n```\n\n### 2. `satisfy` and `warn_all`\n\nWith this approach, warnings are suppressed as conditions are judged to\nbe met and marked as satisfied, and all warnings for a dataclass are\nemitted at once when `warn_all` is called.\n\n```python\nimport json\n\nfrom dataclasses import dataclass, field\n\nfrom warned_dataclasses import Warned, warned, warn_all, satisfy\n\n\n@warned\n@dataclass\nclass User:\n    id: int\n    admin_level: Warned[int, 'admin_only'] = field(default=1)\n    fileshare_home_dir: Warned[str, 'db_access'] = field(default='~')\n\n\ndef check_admin(user: User):\n    with open('admins.json', 'r') as admins_fd:\n        admins = json.load(admins_fd)\n\n    if user.id in admins:\n        # user is an admin; no warning\n        satisfy(user, 'admin_only')\n\n\ndef check_db_access(user: User):\n    with open('db_users.json', 'r') as db_users_fd:\n        db_users = json.load(db_users_fd)\n\n    if user.id in db_users:\n        # user is a db user; no warning\n        satisfy(user, 'db_access')\n\n\nif __name__ == '__main__':\n    user = User(123, admin_level=2, fileshare_home_dir='/')\n    check_admin(user)\n    check_db_access(user)\n\n    # now emit all unsatisfied errors\n    warn_all(user)\n```\n\n## Advanced Usage\n\n### 1. Decorator options\n\n* By default, a warned dataclass will emit a warning to the current `logging` \n  logger. To raise an exception instead, use `@warned(error=True)`.\n\n* By default, a warned dataclass will only emit a warning once for each\n  condition; future calls to `warn_for_condition` or `warn_all` will\n  treat that condition as satisfied. To disable this behavior and emit\n  a warning every time it is invoked, use `@warned(satisfy_on_warn=False)`\n\n* A plain `@warned` can be used with or without parentheses.\n\n\n### 2. Multiple warned dataclasses and `ConditionSet`\n\nIf your code uses multiple warned dataclasses that share some conditions,\nthe methods illustrated above become clunky, as you end up having to call\n`warn_for_condition(obj, condition)` for every warned dataclass object\nthat uses `condition`. Instead, you can collect conditions immediately\nafter instantiation using `ConditionSet`, then call any of the usual functions,\neither with the `ConditionSet` object as the first parameter or as a\nmethod on `ConditionSet`:\n\n```python\nfrom dataclasses import dataclass, field\n\nfrom warned_dataclasses import warned, Warned, ConditionSet, warn_for_condition, warn_all, satisfy\n\n\n@warned\n@dataclass\nclass One:\n    ...\n    some_attr: Warned[int, 'abc'] = field(default=32)\n    other_attr: Warned[str, 'shared_condition'] = field(default='')\n    ...\n\n\n@warned\n@dataclass\nclass Two:\n    ...\n    some_attr: Warned[int, 'shared_condition'] = field(default=5)\n    other_attr: Warned[float, '123'] = field(default=0.0)\n    ...\n\n\ndef main():\n    ...\n    one = One(...)\n    two = Two(...)\n    \n    conditions = ConditionSet(one, two)\n    \n    ...\n    \n    conditions.warn_for_condition(\"shared_condition\")\n    conditions.satisfy(\"123\")\n    conditions.warn_all()\n    \n    # or:\n    \n    warn_for_condition(conditions, \"shared_condition\")\n    satisfy(conditions, \"123\")\n    warn_all(conditions)\n\n```\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "",
    "license": "",
    "maintainer": "",
    "maintainer_email": "",
    "name": "warned-dataclasses",
    "package_url": "https://pypi.org/project/warned-dataclasses/",
    "platform": null,
    "project_url": "https://pypi.org/project/warned-dataclasses/",
    "project_urls": null,
    "release_url": "https://pypi.org/project/warned-dataclasses/0.3.0/",
    "requires_dist": [
      "typing-extensions ; python_version < \"3.10\""
    ],
    "requires_python": ">=3.8",
    "summary": "",
    "version": "0.3.0",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 17426518,
  "releases": {
    "0.1.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "52406b45f5412bf2524c1c7eb222a7e2e72845906af9b3c5afafab64fa3badb0",
          "md5": "b907cc64b15006758479f822a8017c43",
          "sha256": "acd0837abd383aa80ee96ca90532842ca2b1345d8ca16f1096a9f6facd6aa79c"
        },
        "downloads": -1,
        "filename": "warned_dataclasses-0.1.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "b907cc64b15006758479f822a8017c43",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.8",
        "size": 8389,
        "upload_time": "2022-12-08T03:02:39",
        "upload_time_iso_8601": "2022-12-08T03:02:39.118903Z",
        "url": "https://files.pythonhosted.org/packages/52/40/6b45f5412bf2524c1c7eb222a7e2e72845906af9b3c5afafab64fa3badb0/warned_dataclasses-0.1.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "88c9d592ee39501fa5269f25e88766843d27edba3f9f4dafb4e8278565409204",
          "md5": "ff9eed1696de3503c86a847cdee04543",
          "sha256": "0584d41c4666dad0ab9f3484121ce572685c95a1ad6dfddf3dc70b82f8f02a10"
        },
        "downloads": -1,
        "filename": "warned-dataclasses-0.1.0.tar.gz",
        "has_sig": false,
        "md5_digest": "ff9eed1696de3503c86a847cdee04543",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.8",
        "size": 8154,
        "upload_time": "2022-12-08T03:02:40",
        "upload_time_iso_8601": "2022-12-08T03:02:40.851844Z",
        "url": "https://files.pythonhosted.org/packages/88/c9/d592ee39501fa5269f25e88766843d27edba3f9f4dafb4e8278565409204/warned-dataclasses-0.1.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.2.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "0ed86b9e60b198c361219d9ae5801ef5dd998b4fd4651fdd793fe887f55e8908",
          "md5": "bd6cbd1774d16da4fec361c1116dba6d",
          "sha256": "417ec52cc6d34026f1d2a22951bcecd60625a638df32eae87c3c7a2dcdcf331a"
        },
        "downloads": -1,
        "filename": "warned_dataclasses-0.2.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "bd6cbd1774d16da4fec361c1116dba6d",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.8",
        "size": 12373,
        "upload_time": "2023-03-23T23:01:55",
        "upload_time_iso_8601": "2023-03-23T23:01:55.738781Z",
        "url": "https://files.pythonhosted.org/packages/0e/d8/6b9e60b198c361219d9ae5801ef5dd998b4fd4651fdd793fe887f55e8908/warned_dataclasses-0.2.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "94cc57a9a04cdc1fc82eab36c2eff25edc1718c1e0801e8aea857a95decb63a4",
          "md5": "51c4f0cfb012b38d3104180d62b4c8e4",
          "sha256": "0234e9f79c5168270d3a4b98c5f2cd0b6cc3dd80e672058e722ae0a273472fa2"
        },
        "downloads": -1,
        "filename": "warned-dataclasses-0.2.0.tar.gz",
        "has_sig": false,
        "md5_digest": "51c4f0cfb012b38d3104180d62b4c8e4",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.8",
        "size": 12800,
        "upload_time": "2023-03-23T23:01:57",
        "upload_time_iso_8601": "2023-03-23T23:01:57.039444Z",
        "url": "https://files.pythonhosted.org/packages/94/cc/57a9a04cdc1fc82eab36c2eff25edc1718c1e0801e8aea857a95decb63a4/warned-dataclasses-0.2.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.3.0": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a9879e0ff459027d016be61ddec800313448739d1d5c1957298c717130c39b3c",
          "md5": "72f94fb0de1ca74c8f9046d33a038be2",
          "sha256": "be72648c8fd0f136463c0490587b868015331acc05d00b4e7a0d87becf7ce9af"
        },
        "downloads": -1,
        "filename": "warned_dataclasses-0.3.0-py3-none-any.whl",
        "has_sig": false,
        "md5_digest": "72f94fb0de1ca74c8f9046d33a038be2",
        "packagetype": "bdist_wheel",
        "python_version": "py3",
        "requires_python": ">=3.8",
        "size": 12408,
        "upload_time": "2023-03-24T04:41:49",
        "upload_time_iso_8601": "2023-03-24T04:41:49.219968Z",
        "url": "https://files.pythonhosted.org/packages/a9/87/9e0ff459027d016be61ddec800313448739d1d5c1957298c717130c39b3c/warned_dataclasses-0.3.0-py3-none-any.whl",
        "yanked": false,
        "yanked_reason": null
      },
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "a7904c0ff1a672baea4feb56a1bb5237e184f805581c56e69195cd39c624360f",
          "md5": "350e9be610c5fe0df58622e6a2c2345d",
          "sha256": "2b2a19630bf58ee26cbf9cd29de8ac305d802c4ff87e73459627f9119bec526c"
        },
        "downloads": -1,
        "filename": "warned-dataclasses-0.3.0.tar.gz",
        "has_sig": false,
        "md5_digest": "350e9be610c5fe0df58622e6a2c2345d",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.8",
        "size": 13074,
        "upload_time": "2023-03-24T04:41:50",
        "upload_time_iso_8601": "2023-03-24T04:41:50.798570Z",
        "url": "https://files.pythonhosted.org/packages/a7/90/4c0ff1a672baea4feb56a1bb5237e184f805581c56e69195cd39c624360f/warned-dataclasses-0.3.0.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "a9879e0ff459027d016be61ddec800313448739d1d5c1957298c717130c39b3c",
        "md5": "72f94fb0de1ca74c8f9046d33a038be2",
        "sha256": "be72648c8fd0f136463c0490587b868015331acc05d00b4e7a0d87becf7ce9af"
      },
      "downloads": -1,
      "filename": "warned_dataclasses-0.3.0-py3-none-any.whl",
      "has_sig": false,
      "md5_digest": "72f94fb0de1ca74c8f9046d33a038be2",
      "packagetype": "bdist_wheel",
      "python_version": "py3",
      "requires_python": ">=3.8",
      "size": 12408,
      "upload_time": "2023-03-24T04:41:49",
      "upload_time_iso_8601": "2023-03-24T04:41:49.219968Z",
      "url": "https://files.pythonhosted.org/packages/a9/87/9e0ff459027d016be61ddec800313448739d1d5c1957298c717130c39b3c/warned_dataclasses-0.3.0-py3-none-any.whl",
      "yanked": false,
      "yanked_reason": null
    },
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "a7904c0ff1a672baea4feb56a1bb5237e184f805581c56e69195cd39c624360f",
        "md5": "350e9be610c5fe0df58622e6a2c2345d",
        "sha256": "2b2a19630bf58ee26cbf9cd29de8ac305d802c4ff87e73459627f9119bec526c"
      },
      "downloads": -1,
      "filename": "warned-dataclasses-0.3.0.tar.gz",
      "has_sig": false,
      "md5_digest": "350e9be610c5fe0df58622e6a2c2345d",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.8",
      "size": 13074,
      "upload_time": "2023-03-24T04:41:50",
      "upload_time_iso_8601": "2023-03-24T04:41:50.798570Z",
      "url": "https://files.pythonhosted.org/packages/a7/90/4c0ff1a672baea4feb56a1bb5237e184f805581c56e69195cd39c624360f/warned-dataclasses-0.3.0.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}