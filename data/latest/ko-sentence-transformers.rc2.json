{
  "info": {
    "author": "Junghyun Gan",
    "author_email": "jhgan00@yonsei.ac.kr",
    "bugtrack_url": null,
    "classifiers": [],
    "description": "# ko-sentence-transformers\n\n이 프로젝트는 KoBERT 모델을 `sentence-transformers` 에서 보다 쉽게 사용하기 위해 만들어졌습니다.\n[`Ko-Sentence-BERT-SKTBERT`](https://github.com/BM-K/KoSentenceBERT-SKT) 프로젝트에서는 KoBERT 모델을 `sentence-transformers` 에서 활용할 수 있도록 하였습니다. \n하지만 설치 과정에 약간의 번거로움이 있었고, 라이브러리 코드를 직접 수정하기 때문에 허깅페이스 허브를 활용하기 어려웠습니다.\n`ko-sentence-transformers` 는 간단한 설치만으로 한국어 사전학습 모델을 문장 임베딩에 활용할 수 있도록 합니다. \n\n## Installation\n\n`pip install` 을 통해 설치할 수 있습니다.\n\n```bash\npip install ko-sentence-transformers\n```\n\n## Examples\n\n사전학습된 KoBERT 모델을 가져와 `sentence-transformers`  API 에서 활용할 수 있습니다.\n`training_nli_v2.py`, `training_sts.py` 파일에서 모델 파인튜닝 예시를 확인할 수 있습니다.\n\n```python\nfrom sentence_transformers import SentenceTransformer, models\nfrom ko_sentence_transformers.models import KoBertTransformer\nword_embedding_model = KoBertTransformer(\"monologg/kobert\", max_seq_length=75)\npooling_model = models.Pooling(word_embedding_model.get_word_embedding_dimension(), pooling_mode='mean')\nmodel = SentenceTransformer(modules=[word_embedding_model, pooling_model])\n```\n\n허깅페이스 허브에 업로드된 모델 역시 간단히 불러와 활용할 수 있습니다. \n\n```python\nfrom sentence_transformers import SentenceTransformer, util\nimport numpy as np\n\nembedder = SentenceTransformer(\"jhgan/ko-sbert-sts\")\n\n# Corpus with example sentences\ncorpus = ['한 남자가 음식을 먹는다.',\n          '한 남자가 빵 한 조각을 먹는다.',\n          '그 여자가 아이를 돌본다.',\n          '한 남자가 말을 탄다.',\n          '한 여자가 바이올린을 연주한다.',\n          '두 남자가 수레를 숲 속으로 밀었다.',\n          '한 남자가 담으로 싸인 땅에서 백마를 타고 있다.',\n          '원숭이 한 마리가 드럼을 연주한다.',\n          '치타 한 마리가 먹이 뒤에서 달리고 있다.']\n\ncorpus_embeddings = embedder.encode(corpus, convert_to_tensor=True)\n\n# Query sentences:\nqueries = ['한 남자가 파스타를 먹는다.',\n           '고릴라 의상을 입은 누군가가 드럼을 연주하고 있다.',\n           '치타가 들판을 가로 질러 먹이를 쫓는다.']\n\n# Find the closest 5 sentences of the corpus for each query sentence based on cosine similarity\ntop_k = 5\nfor query in queries:\n    query_embedding = embedder.encode(query, convert_to_tensor=True)\n    cos_scores = util.pytorch_cos_sim(query_embedding, corpus_embeddings)[0]\n    cos_scores = cos_scores.cpu()\n\n    #We use np.argpartition, to only partially sort the top_k results\n    top_results = np.argpartition(-cos_scores, range(top_k))[0:top_k]\n\n    print(\"\\n\\n======================\\n\\n\")\n    print(\"Query:\", query)\n    print(\"\\nTop 5 most similar sentences in corpus:\")\n\n    for idx in top_results[0:top_k]:\n        print(corpus[idx].strip(), \"(Score: %.4f)\" % (cos_scores[idx]))\n```\n\n```\n======================\n\n\nQuery: 한 남자가 파스타를 먹는다.\n\nTop 5 most similar sentences in corpus:\n한 남자가 음식을 먹는다. (Score: 0.7417)\n한 남자가 빵 한 조각을 먹는다. (Score: 0.6684)\n한 남자가 말을 탄다. (Score: 0.1089)\n한 남자가 담으로 싸인 땅에서 백마를 타고 있다. (Score: 0.0717)\n두 남자가 수레를 숲 속으로 밀었다. (Score: 0.0244)\n\n\n======================\n\n\nQuery: 고릴라 의상을 입은 누군가가 드럼을 연주하고 있다.\n\nTop 5 most similar sentences in corpus:\n원숭이 한 마리가 드럼을 연주한다. (Score: 0.7057)\n한 여자가 바이올린을 연주한다. (Score: 0.3154)\n치타 한 마리가 먹이 뒤에서 달리고 있다. (Score: 0.2171)\n두 남자가 수레를 숲 속으로 밀었다. (Score: 0.1294)\n그 여자가 아이를 돌본다. (Score: 0.0979)\n\n\n======================\n\n\nQuery: 치타가 들판을 가로 질러 먹이를 쫓는다.\n\nTop 5 most similar sentences in corpus:\n치타 한 마리가 먹이 뒤에서 달리고 있다. (Score: 0.7986)\n두 남자가 수레를 숲 속으로 밀었다. (Score: 0.3255)\n한 남자가 담으로 싸인 땅에서 백마를 타고 있다. (Score: 0.2688)\n한 남자가 말을 탄다. (Score: 0.1530)\n원숭이 한 마리가 드럼을 연주한다. (Score: 0.0913)\n```\n\n## KorSTS Benchmarks\n\n카카오브레인의 KorNLI 데이터셋을 활용하여 `sentence-BERT` 모델을 학습시킨 결과입니다.\nNLI 데이터셋 학습에는 `MultipleNegativesRankingLoss` 를 사용하였습니다.\n학습된 모델은 허깅페이스 모델 허브에 공개되어있습니다.\n\n- [ko-sbert-sts](https://huggingface.co/jhgan/ko-sbert-sts)\n- [ko-sbert-nli](https://huggingface.co/jhgan/ko-sbert-nli) \n\n모델|학습 데이터|Cosine Pearson|Cosine Spearman|Euclidean Pearson|Euclidean Spearman|Manhattan Pearson|Manhattan Spearman|Dot Pearson|Dot Spearman|\n|:----:|:------------------------:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|\nSKT-KoBERT|NLI|**82.03**|**82.36**|**80.06**|**79.85**|**80.08**|**79.91**|75.76|74.72\nSKT-KoBERT|STS|80.79|79.91|78.03|77.31|78.08|77.35|**75.96**|**75.20**\n\n\n## References\n\n- Ham, J., Choe, Y. J., Park, K., Choi, I., & Soh, H. (2020). Kornli and korsts: New benchmark datasets for korean natural language understanding. arXiv\npreprint arXiv:2004.03289\n- Reimers, Nils and Iryna Gurevych. “Sentence-BERT: Sentence Embeddings using Siamese BERT-Networks.” ArXiv abs/1908.10084 (2019)\n- [Ko-Sentence-BERT-SKTBERT](https://github.com/BM-K/KoSentenceBERT-SKT)\n- [KoBERT](https://github.com/SKTBrain/KoBERT)",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "",
    "keywords": "",
    "license": "Apache2",
    "maintainer": "",
    "maintainer_email": "",
    "name": "ko-sentence-transformers",
    "package_url": "https://pypi.org/project/ko-sentence-transformers/",
    "platform": "",
    "project_url": "https://pypi.org/project/ko-sentence-transformers/",
    "project_urls": null,
    "release_url": "https://pypi.org/project/ko-sentence-transformers/0.3/",
    "requires_dist": null,
    "requires_python": ">=3",
    "summary": "",
    "version": "0.3",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 12389424,
  "releases": {
    "0.2": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "18545f552cf28294df2adac0b8df733cf5cf84980b1d661a56352cc55273e3c8",
          "md5": "2b9912a779fef193ffe520217e110a2a",
          "sha256": "9747ffacabcebacbce9742902cd7fd934f36f60b00b65a1ea351e179545268e4"
        },
        "downloads": -1,
        "filename": "ko_sentence_transformers-0.2.tar.gz",
        "has_sig": false,
        "md5_digest": "2b9912a779fef193ffe520217e110a2a",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3",
        "size": 8826,
        "upload_time": "2021-12-23T12:08:47",
        "upload_time_iso_8601": "2021-12-23T12:08:47.142341Z",
        "url": "https://files.pythonhosted.org/packages/18/54/5f552cf28294df2adac0b8df733cf5cf84980b1d661a56352cc55273e3c8/ko_sentence_transformers-0.2.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ],
    "0.3": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "f2a87dbd819a5aa71c0afd54c0c7764d78106aa222a2601f9011e63e228dd2d5",
          "md5": "971ef9d9266b73602311c9c9f33ed989",
          "sha256": "fe22504d6bf54634bea6c418ceb7e7572b33caf2f73e92a595ccab456e1bc8f4"
        },
        "downloads": -1,
        "filename": "ko_sentence_transformers-0.3.tar.gz",
        "has_sig": false,
        "md5_digest": "971ef9d9266b73602311c9c9f33ed989",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3",
        "size": 11504,
        "upload_time": "2021-12-23T12:10:44",
        "upload_time_iso_8601": "2021-12-23T12:10:44.027983Z",
        "url": "https://files.pythonhosted.org/packages/f2/a8/7dbd819a5aa71c0afd54c0c7764d78106aa222a2601f9011e63e228dd2d5/ko_sentence_transformers-0.3.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "f2a87dbd819a5aa71c0afd54c0c7764d78106aa222a2601f9011e63e228dd2d5",
        "md5": "971ef9d9266b73602311c9c9f33ed989",
        "sha256": "fe22504d6bf54634bea6c418ceb7e7572b33caf2f73e92a595ccab456e1bc8f4"
      },
      "downloads": -1,
      "filename": "ko_sentence_transformers-0.3.tar.gz",
      "has_sig": false,
      "md5_digest": "971ef9d9266b73602311c9c9f33ed989",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3",
      "size": 11504,
      "upload_time": "2021-12-23T12:10:44",
      "upload_time_iso_8601": "2021-12-23T12:10:44.027983Z",
      "url": "https://files.pythonhosted.org/packages/f2/a8/7dbd819a5aa71c0afd54c0c7764d78106aa222a2601f9011e63e228dd2d5/ko_sentence_transformers-0.3.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}