{
  "info": {
    "author": "p0intR",
    "author_email": "",
    "bugtrack_url": null,
    "classifiers": [
      "License :: OSI Approved :: GNU General Public License v3 (GPLv3)",
      "Operating System :: OS Independent",
      "Programming Language :: Python :: 3"
    ],
    "description": "# git-repeat\r\nRemove repetitive tasks from your development workflow by using diffs between git commits to replicate work already done\r\n\r\n![XKCD Automation Image](https://imgs.xkcd.com/comics/automation.png) \\\r\n[XKCD Automation https://xkcd.com/1319](https://xkcd.com/1319/)\r\n\r\n## Motivation\r\nI started a new web project with ASP.NET core. After creating all required entities, \r\nI was confronted with the tedious task of creating CRUD application services, DTOs, auto-mapping \r\nconfiguration, configuration for the site navigation, resource entries for i18n, controllers, view models, \r\ncshtml pages with tables, create/edit modals, and JavaScript files to make all of that work - and that for each entity.\r\n\r\nWhy not do it once and automatically repeat all of that for each entity?\r\n\r\nThe idea is simple: \r\n* Create all of these things once manually for one of the entities e.g. Entity1 \r\n* Commit these changes\r\n* Get the diff between this and the previous commit\r\n* Replace all occurrences of Entity1 with Entity2 in files and filenames\r\n* Append all changes and add all new files automatically to the repository\r\n* Rinse and repeat for Entity3\r\n\r\nAll that's left then is updating the automatically generated DTOs and the html tables and create/edit modals. As each entity has \r\ndifferent fields and since this is requirement specific and everything else is automated I see no inconvenience. With auto-mapping \r\nand jQuery's serialize() this falls more under customization than implementation at this point.\r\n\r\n## How does it work\r\n* Looks at the diff between two commits and processes newly added files and changes made to existing files\r\n* Searches and replaces all replacements supplied inside copies of added files and inside diffs of changed files \r\n* For changes, the text inside the diff is replaced by replacements and then inserted at the same position\r\n* For newly added files, the file is copied and the target filename is computed by replacements on the source filename\r\n* *Should* work with any language as long as the files are inside a git repository\r\n* Doesn't generate code for you, it is simply copying files and repeating all changes made\r\n* Take care when committing your changes which are later used with git-replace\r\n  * e.g. you may include changes where you reformat a whole file, however this would make the recipe unnecessary large\r\n* git-repeat can be run multiple times with the same recipe\r\n  * Each recipe includes the contents of changed files, therefore untracked changes made to files are taken into account\r\n  * Positions are updated with offsets based on untracked changes made (includes previous runs of git-repeat) - this is done at runtime, the recipe remains unchanged\r\n\r\n## Usage\r\nDepending on your installation method git-repeat is available as:\r\n```\r\nuser@host:~$ git-repeat \r\nuser@host:~$ python -m git-repeat \r\nuser@host:~/git-repeat/src$ python -m git_repeat.main \r\n```\r\nInitial help page and supported parameters:\r\n```\r\ngit-repeat v0.0.1\r\nsupported recipes up to v1.0\r\n\r\nusage: git-repeat [-h] [-v] {run,recipe,apply} ...\r\n\r\nremove repetitive tasks from your development workflow\r\n\r\nfor detailed information visit https://github.com/p0intR/git-repeat\r\n\r\ntip: to easily revert changes made by this tool,\r\ncommit your pending changes on the repository\r\n\r\noptional arguments:\r\n  -h, --help          show this help message and exit\r\n  -v, --version       version information (default: False)\r\n\r\nactions:\r\n  {run,recipe,apply}  choose one of these actions\r\n    run               generates recipe on the fly and applies it to repository\r\n    recipe            generate recipe from repository (to file or stdout)\r\n    apply             apply recipe to repository (from file or stdin)\r\n```\r\n### Run\r\nRun generates recipe on the fly and applies it to repository:\r\n```\r\naction: run\r\nusage: git-repeat run [-h] [-f REV_FROM] [-t REV_TO] [-r REPLACEMENTS] [-e ENCODING] [-d] [repo]\r\n\r\npositional arguments:\r\n  repo                                          path to source code, if using 'run' or 'recipe' path must point to a git repository, if using 'apply' folder structure must match recipe's folder structure (default: .)\r\n\r\noptional arguments:\r\n  -h, --help                                    show this help message and exit\r\n  -f REV_FROM, --from REV_FROM                  difference calculation from this commit, should have occurred before --to commit (default: HEAD~1)\r\n  -t REV_TO, --to REV_TO                        difference calculation to this commit, should have occurred should after --from commit (default: HEAD)\r\n  --exclude EXCLUDE                             list of excludes in json format as regex, matching relative file paths are excluded (default: [\"logs\\\\.txt\", \"Logs\\\\.txt\", \"\\\\.md\"])\r\n  --include INCLUDE                             list of includes in json format as regex, ONLY matching relative file paths are included (default: [])\r\n  -r REPLACEMENTS, --replacements REPLACEMENTS  text replacements when repeating commit, for example replacing all foo with bar and all Foo with Bar: {'foo':'bar','Foo','Bar'}. if this is an array of replacements, the recipe is run multiple times, for example foo with bar and foo with fu:\r\n                                                [{'foo':'bar','Foo','Bar'}, {'foo':'fu','Foo','Fu'}]. this has the same effect as running git-repeat twice with {'foo':'bar','Foo','Bar'} and {'foo':'fu','Foo','Fu'} respectively. if parameter does not start with an { or [ treated as path to json file\r\n                                                (default: {})\r\n  --dry                                         dry run, only print changes made but don't persist changes or add any files (default: False)\r\n  -e ENCODING, --encoding ENCODING              encoding used for reading and storing files (default: utf-8-sig)\r\n  -d, --debug                                   enable verbose output (default: 20)\r\n```\r\n### Recipe\r\nRecipe generates recipe from repository:\r\n```\r\naction: recipe\r\nusage: git-repeat recipe [-h] [-f REV_FROM] [-t REV_TO] [-e ENCODING] [-d] [-k KEYS] [-o OUT_PATH] [repo]\r\n\r\npositional arguments:\r\n  repo                              path to source code, if using 'run' or 'recipe' path must point to a git repository, if using 'apply' folder structure must match recipe's folder structure (default: .)\r\n\r\noptional arguments:\r\n  -h, --help                        show this help message and exit\r\n  -f REV_FROM, --from REV_FROM      difference calculation from this commit, should have occurred before --to commit (default: HEAD~1)\r\n  -t REV_TO, --to REV_TO            difference calculation to this commit, should have occurred should after --from commit (default: HEAD)\r\n  --exclude EXCLUDE                 list of excludes in json format as regex, matching relative file paths are excluded (default: [\"logs\\\\.txt\", \"Logs\\\\.txt\", \"\\\\.md\"])\r\n  --include INCLUDE                 list of includes in json format as regex, ONLY matching relative file paths are included (default: [])\r\n  -e ENCODING, --encoding ENCODING  encoding used for reading and storing files (default: utf-8-sig)\r\n  -d, --debug                       enable verbose output (default: 20)\r\n  -k KEYS, --keys KEYS              text replacements keys when applying commit, for example replacing all foo and Foo: ['foo', 'Foo']. if parameter does not start with an [ treated as path to json file (default: [])\r\n  -o OUT_PATH, --out OUT_PATH       output recipe to file, - means stdout (default: -)\r\n```\r\n### Apply\r\nApply applies recipe to repository\r\n```\r\naction: apply\r\nusage: git-repeat apply [-h] [-r REPLACEMENTS] [-e ENCODING] [-d] [-i IN_PATH] [repo]\r\n\r\npositional arguments:\r\n  repo                                          path to source code, if using 'run' or 'recipe' path must point to a git repository, if using 'apply' folder structure must match recipe's folder structure (default: .)\r\n\r\noptional arguments:\r\n  -h, --help                                    show this help message and exit\r\n  -r REPLACEMENTS, --replacements REPLACEMENTS  text replacements when repeating commit, for example replacing all foo with bar and all Foo with Bar: {'foo':'bar','Foo','Bar'}. if this is an array of replacements, the recipe is run multiple times, for example foo with bar and foo with fu:\r\n                                                [{'foo':'bar','Foo','Bar'}, {'foo':'fu','Foo','Fu'}]. this has the same effect as running git-repeat twice with {'foo':'bar','Foo','Bar'} and {'foo':'fu','Foo','Fu'} respectively. if parameter does not start with an { or [ treated as path to json file\r\n                                                (default: {})\r\n  --dry                                         dry run, only print changes made but don't persist changes or add any files (default: False)\r\n  -e ENCODING, --encoding ENCODING              encoding used for reading and storing files (default: utf-8-sig)\r\n  -d, --debug                                   enable verbose output (default: 20)\r\n  -i IN_PATH, --in IN_PATH                      input recipe file to apply, - means stdin (default: -)\r\n```\r\n\r\n## Requirements\r\n* Python >= 3.7\r\n* GitPython >= 3.1.27, < 4.0\r\n\r\nI have tested git-repeat Python 3.7 and 3.9 and on GitPython 3.1.27.\\\r\nPlease let me know if there are problems.\r\n\r\n## Installation\r\n### Install git-repeat with pip:\r\n```\r\npip install git-repeat\r\n```\r\n\r\n### Install git-repeat from source with setuptools:\r\nClone the git-repeat repository\r\n```\r\ngit clone https://github.com/p0intR/git-repeat\r\n```\r\nNavigate to git-repeat\r\n```\r\ncd git-repeat\r\n```\r\nBuild git-repeat and install\r\n```\r\npython setup.py build\r\npython setup.py install\r\n```\r\n\r\n### Run without installation:\r\nClone the git-repeat repository\r\n```\r\ngit clone https://github.com/p0intR/git-repeat\r\n```\r\nNavigate to git-repeat src folder\r\n```\r\ncd git-repeat/src\r\n```\r\nInstall required packages\r\n```\r\npython -m pip install GitPython>=3.1.27\r\n```\r\nRun git-repeat\r\n```\r\npython -m git_repeat.main\r\n```\r\n\r\n## Step-by-step example \r\n### Create git-repeat recipe\r\nRecipes are used to store diff-information for later use with git-repeat.\\\r\nCreate a simple recipe from last commit:\r\n```\r\nuser@host:~/some-git-repository$ git-repeat recipe -o my-first.recipe .\r\n```\r\nOr create a more complex recipe and remember your replacement keys for later use:\r\n```\r\nuser@host:~/some-git-repository$ git-repeat recipe -f HEAD~2 -t HEAD~1 -k \"[\\\"Entity1\\\", \\\"entity1\\\"]\" -o my-second.recipe .\r\n```\r\n\r\n### Define replacements\r\nReplacements are key->value pairs to replace text inside diffs.\r\n#### Single replacement\r\n```\r\nuser@host:~/some-git-repository$ cat my-replacements.json\r\n{\r\n    \"Entity1\": \"Entity2\",\r\n    \"entity1\": \"entity2\"\r\n}\r\n```\r\n#### Multiple replacements\r\n```\r\nuser@host:~/some-git-repository$ cat my-multi-replacements.json\r\n[\r\n    {\r\n        \"Entity1\": \"Entity2\",\r\n        \"entity1\": \"entity2\"\r\n    },\r\n    {\r\n        \"Entity1\": \"Entity3\",\r\n        \"entity1\": \"entity3\"\r\n    }\r\n]\r\n```\r\n\r\n### Apply git-repeat recipe\r\nApply applies a recipe with the specified replacements.\r\n```\r\nuser@host:~/some-git-repository$ git-repeat apply -r my-replacements.json -i my-first.recipe .\r\n```\r\nIf multiple replacements are present in json file, apply is run once for each single replacement.\r\n```\r\nuser@host:~/some-git-repository$ git-repeat apply -r my-multi-replacements.json -i my-second.recipe .\r\n```\r\n\r\n### Using pipes stdout / stdin\r\nIf no input or output is specified, recipe uses stdout and apply uses stdin.\r\n```\r\nuser@host:~/some-git-repository$ git-repeat recipe -f HEAD~2 -t HEAD~1 -k \"[\\\"Entity1\\\", \\\"entity1\\\"]\" . | git-repeat apply -r my-multi-replacements.json .\r\n```\r\n\r\n### Do it all in one line\r\nWith run both actions recipe and apply are run in one go without outputting the recipe.\r\n```\r\nuser@host:~/some-git-repository$ git-repeat run -r my-replacements.json .\r\n```\r\n```\r\nuser@host:~/some-git-repository$ git-repeat run -f HEAD~2 -t HEAD~1 -r my-multi-replacements.json .\r\n```\r\n\r\n## Recipe file structure\r\nRecipe files contain all added files, all changes made and the contents of changed files. \r\n\r\nBelow you see a modified (removed some details) example for the ASP.NET core web project described in Motivation. This recipe was \r\ngenerated by implementing everything for Entity1, committing the changes and then running git-repeat recipe.\r\n```\r\nuser@host:~/some-git-repository$ git-repeat recipe\r\n# git-repeat recipe\r\n#\r\n# syntax:\r\n#\t# <COMMENT>\tcomments must start with # and are not treated as such inside |...|\r\n#\tVERSION<TAB><VERSION>\tfile syntax version used, should appear only once at the top\r\n#\tKEY<TAB>|<KEY>|\tkey that can be used for replacements with this recipe, supports multi line\r\n#\tCOPY<TAB><RELATIVE PATH>\tfiles that are added newly will be copied and texts replaced\r\n#\tUPDATE<TAB><RELATIVE PATH>\tupdates made to files will be replicated with text replacing, followed by lines with <TAB> seperated:\r\n#\t\t<OPERATION><TAB><POSITION><TAB>|<CONTENTS>|\r\n#\r\n#\t\toperation: + or -, if any plus + and minus - share the same line number it will replaced, otherwise it will be inserted at this position\r\n#\t\tposition:  eg. 42, these are not line numbers but indices after splitting by whitespaces.. yeah.\r\n#\t\tcontents:  text including newlines with the following conditions:\r\n#\t\t           * text must be between |..|\r\n#\t\t           * can be omitted if operation is minus -\r\n#\t\t           * |..| may contain other pipes |\r\n#\t\t           * all whitespaces between |..| are conserved\r\n#\r\n#\t\there an example:\r\n#\t\t-  42  |// test|\r\n#\t\t+  42  |/*\r\n#\t\t\ttest\r\n#\t\t*/|\r\n#\r\n#\t\twhere this could be simplified to:\r\n#\t\t-  42\r\n#\t\t+  42  |/*\r\n#\t\t\ttest\r\n#\t\t*/|\r\n#\r\n#\tFILE<TAB><RELATIVE PATH><TAB>|<CONTENTS>|\tfiles that are part of updates are stored alongside this recipe\r\n#\t                                         \tthis allows for tracking of changes made after this recipe was created\r\n#\r\n# feel free to edit this recipe, have fun :)\r\n#\r\n# this file was created at \"2022-06-12 12:30:00+0000\" from:\r\n# - repository:\r\n#\t\"/home/user/some-git-repository\"\r\n# - from commit: \r\n#\t\"Initial commit\" by \"user\" at \"2022-06-11 14:00:00+0200\"\r\n# - to commit: \r\n#\t\"Added Services and UI for Entity1\" by \"user\" at \"2022-06-11 15:00:00+0200\"\r\n# - files: ([A]dded, [M]odified, [D]eleted, e[X]cluded-by-[E]xclude, e[X]cluded-by-[I]nclude)\r\n#\tM XE\tsrc/README.md\r\n#\tM XE\tsrc/web/logs/Logs.txt\r\n#\tA\tsrc/application/Services/IEntity1AppService.cs\r\n#\tA\tsrc/application/Services/Entity1AppService.cs\r\n#\tA\tsrc/application/Services/Dto/ListEntity1Dto.cs\r\n#\tA\tsrc/application/Services/Dto/Entity1Dto.cs\r\n#\tA\tsrc/application/Services/Dto/CreateEntity1Dto.cs\r\n#\tA\tsrc/application/Services/Dto/EditEntity1Dto.cs\r\n#\tA\tsrc/application/Services/Dto/Entity1Mapper.cs\r\n#\tA\tsrc/web/wwwroot/views/Entity1/Index.js\r\n#\tA\tsrc/web/wwwroot/views/Entity1/_CreateModal.js\r\n#\tA\tsrc/web/wwwroot/views/Entity1/_EditModal.js\r\n#\tA\tsrc/web/Controllers/Entity1Controller.cs\r\n#\tA\tsrc/web/Models/Entity1/Entity1ListViewModel.cs\r\n#\tA\tsrc/web/Models/Entity1/EditEntity1ModalViewModel.cs\r\n#\tA\tsrc/web/Views/Entity1/Index.cshtml\r\n#\tA\tsrc/web/Views/Entity1/_CreateModal.cshtml\r\n#\tA\tsrc/web/Views/Entity1/_EditModal.cshtml\r\n#\tM\tsrc/web/Consts/PageNames.cs\r\n#\tM\tsrc/core/i18n/en.xml\r\n#\t\r\nVERSION\t1.0\r\nCOPY\tsrc/application/Services/IEntity1AppService.cs\r\nCOPY\tsrc/application/Services/Entity1AppService.cs\r\nCOPY\tsrc/application/Services/Dto/ListEntity1Dto.cs\r\nCOPY\tsrc/application/Services/Dto/Entity1Dto.cs\r\nCOPY\tsrc/application/Services/Dto/CreateEntity1Dto.cs\r\nCOPY\tsrc/application/Services/Dto/EditEntity1Dto.cs\r\nCOPY\tsrc/application/Services/Dto/Entity1Mapper.cs\r\nCOPY\tsrc/web/wwwroot/views/Entity1/Index.js\r\nCOPY\tsrc/web/wwwroot/views/Entity1/_CreateModal.js\r\nCOPY\tsrc/web/wwwroot/views/Entity1/_EditModal.js\r\nCOPY\tsrc/web/Controllers/Entity1Controller.cs\r\nCOPY\tsrc/web/Models/Entity1/Entity1ListViewModel.cs\r\nCOPY\tsrc/web/Models/Entity1/EditEntity1ModalViewModel.cs\r\nCOPY\tsrc/web/Views/Entity1/Index.cshtml\r\nCOPY\tsrc/web/Views/Entity1/_CreateModal.cshtml\r\nCOPY\tsrc/web/Views/Entity1/_EditModal.cshtml\r\nUPDATE\tsrc/web/Consts/PageNames.cs\r\n+\t41\t|\r\n        public const string Entity1 = \"Entity1\";|\r\nUPDATE\tsrc/core/i18n/en.xml\r\n+\t9\t|\r\n\t\t<text name=\"Entity1\">Entity1</text>\r\n\t\t<text name=\"CreateNewEntity1\">Create new entity1</text>\r\n\t\t<text name=\"EditEntity1\">Edit entity1</text>\r\n|\r\nFILE\tsrc/web/PageNames.cs\t|namespace Some.Web.Consts\r\n{\r\n    public class PageNames\r\n    {\r\n        public const string Home = \"Home\";\r\n        public const string Entity1 = \"Entity1\";\r\n    }\r\n}\r\n|\r\nFILE\tsrc/core/i18n/en.xml\t|<?xml version=\"1.0\" encoding=\"utf-8\" ?>\r\n<texts>\r\n\t\t<text name=\"Entity1\">Entity1</text>\r\n\t\t<text name=\"CreateNewEntity1\">Create new entity1</text>\r\n\t\t<text name=\"EditEntity1\">Edit entity1</text>\r\n\r\n\t\t<text name=\"HomePage\" value=\"Home page\" />\r\n</texts>\r\n|\r\n```\r\n\r\n## License\r\ngit-repeat is licensed under the GPLv3. See LICENSE\r\n\r\n## Repository\r\nYou find the [git repository](https://github.com/p0intR/git-repeat) at GitHub.\r\n\r\n\r\n",
    "description_content_type": "text/markdown",
    "docs_url": null,
    "download_url": "",
    "downloads": {
      "last_day": -1,
      "last_month": -1,
      "last_week": -1
    },
    "home_page": "https://github.com/p0intR/git-repeat",
    "keywords": "git-repeat,python",
    "license": "GPLv3",
    "maintainer": "",
    "maintainer_email": "",
    "name": "git-repeat",
    "package_url": "https://pypi.org/project/git-repeat/",
    "platform": null,
    "project_url": "https://pypi.org/project/git-repeat/",
    "project_urls": {
      "Homepage": "https://github.com/p0intR/git-repeat",
      "Source": "https://github.com/p0intR/git-repeat"
    },
    "release_url": "https://pypi.org/project/git-repeat/0.1.4/",
    "requires_dist": null,
    "requires_python": ">=3.7",
    "summary": "Remove repetitive tasks from your development workflow by using git diffs to replicate work already done",
    "version": "0.1.4",
    "yanked": false,
    "yanked_reason": null
  },
  "last_serial": 14107987,
  "releases": {
    "0.1.4": [
      {
        "comment_text": "",
        "digests": {
          "blake2b_256": "0526b2b806908145526e6234b530473125c5595d0eec77a07dea607af2c264ce",
          "md5": "6edf70e500e1d46ce4abff7aafb0bdf4",
          "sha256": "0be7653d280e29a3616cea804a48277c7ad13839fc902c9faad39f1a1b1750a0"
        },
        "downloads": -1,
        "filename": "git-repeat-0.1.4.tar.gz",
        "has_sig": false,
        "md5_digest": "6edf70e500e1d46ce4abff7aafb0bdf4",
        "packagetype": "sdist",
        "python_version": "source",
        "requires_python": ">=3.7",
        "size": 34026,
        "upload_time": "2022-06-12T17:34:24",
        "upload_time_iso_8601": "2022-06-12T17:34:24.807859Z",
        "url": "https://files.pythonhosted.org/packages/05/26/b2b806908145526e6234b530473125c5595d0eec77a07dea607af2c264ce/git-repeat-0.1.4.tar.gz",
        "yanked": false,
        "yanked_reason": null
      }
    ]
  },
  "urls": [
    {
      "comment_text": "",
      "digests": {
        "blake2b_256": "0526b2b806908145526e6234b530473125c5595d0eec77a07dea607af2c264ce",
        "md5": "6edf70e500e1d46ce4abff7aafb0bdf4",
        "sha256": "0be7653d280e29a3616cea804a48277c7ad13839fc902c9faad39f1a1b1750a0"
      },
      "downloads": -1,
      "filename": "git-repeat-0.1.4.tar.gz",
      "has_sig": false,
      "md5_digest": "6edf70e500e1d46ce4abff7aafb0bdf4",
      "packagetype": "sdist",
      "python_version": "source",
      "requires_python": ">=3.7",
      "size": 34026,
      "upload_time": "2022-06-12T17:34:24",
      "upload_time_iso_8601": "2022-06-12T17:34:24.807859Z",
      "url": "https://files.pythonhosted.org/packages/05/26/b2b806908145526e6234b530473125c5595d0eec77a07dea607af2c264ce/git-repeat-0.1.4.tar.gz",
      "yanked": false,
      "yanked_reason": null
    }
  ],
  "vulnerabilities": []
}